<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1><MadCap:concept term="Software;Appliance"/>Monitoring Using Syslog</h1>
    <p>The event broker generates Syslog messages, as defined in RFC 3164, to record events related to system health and resource utilization as well as event broker operations. Syslog messages are written to log files on the local system, and can be forwarded over the network to a remote host .</p>
    <h2 class="with-rule"><a name="Logging"/>Logging Categories</h2>
    <p>There are three logging categories:</p>
    <ul>
      <li>Command logs (command.log) - Stores all commands,  both CLI and SEMP, sent to the event broker</li>
      <li>Event logs (event.log) - Stores all system, VPN, and client level events generated by the event broker</li>
      <li>System logs (system.log) - Stores important system level events generated by the event broker</li>
      <li MadCap:conditions="Default.HideFromAllOutput">Debug logs (debug.log): Stores internal software debugging information (used only by Solace)</li>
    </ul>
    <p>There are two more logging categories which don't have associated log files, but are viewable on CLI:</p>
    <ul>
      <li>ACL logs - Tracks the last 1000 ACL related logs</li>
      <li>No Subscription match logs - Tracks the last 1000 no subscription matches for a particular topic</li>
    </ul>
    <p>The following commands can be used to view logs via CLI:</p>
    <ul>
      <li>
        <code>show log event</code>
      </li>
      <li>
        <code>show log event lines 10</code>
      </li>
      <li>
        <code>show log event find &lt;MyClientName&gt;</code>
      </li>
    </ul>
    <p>The event broker can be configured to propagate command, event, and system logs to a remote Syslog server.  For more details, please refer to <MadCap:xref href="Monitoring-Events-Using-Syslog.htm">Monitoring Events Using Syslog</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="Syslog"/>Syslog Message Severity Levels</h2>
    <p>Syslogs include actions performed, or errors encountered, by event broker processes. For example, there are events related to publishers and subscribers, physical links/LAGs, the routing protocols CSPF and CSMP, and  physical hardware.</p>
    <p>Each event broker Syslog message is also preassigned a severity level, which indicates how seriously the triggering event affects event broker functions. These message event severity levels are defined as an ordered list. The following table defines the message event severity levels from highest to lowest.  The associated facility and severity level of a Syslog message are together referred to as its priority.</p>
    <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../Resources/TableStyles/Table_Num.css');" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption">Syslog Message Severity Levels</p>
      </caption>
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 25%;"/>
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 37.5%;"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Severity Level</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>crit</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>Failures causing many or all services in the system to go down.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>err</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>A service has gone down. An unexpected service outage affecting a small number or single service.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">warning</td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">A service has been degraded or is exceeding expected operating thresholds.</td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">notice</td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">Normal but significant conditions; for example, service affecting configuration changes.</td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">info</td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">Clearing previous raised conditions where no action needs to be taken.</td>
        </tr>
      </tbody>
    </table>
    <h2 class="with-rule"><a name="system-log-format"/>Syslog Message Format and Components</h2>
    <p>Every event broker Syslog message is created and logged as a plain text ASCII string. Messages are then written to log (ordinary) files, sent to any configured remote Syslog hosts, and displayed to users using standard ASCII string handling operations.</p>
    <p>An event broker Syslog message ASCII string consists of:</p>
    <ul>
      <li>a header (timestamp and host)</li>
      <li>a message priority (facility and severity)</li>
      <li>the message string</li>
    </ul>
    <p>Event broker Syslog messages belong to a facility, which is a group of messages that are either generated by the same software process, or concern a similar event broker subsystem condition or activity (such as debugging attempts). These are shown in following sections for each of the three Solace event types.</p>
    <ul>
      <li>
        <MadCap:xref href="#System">System Events</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Message-">Message-VPN Events</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Client">Client Events</MadCap:xref>
      </li>
    </ul>
    <h3><a name="System"/>System Events</h3>
    <p>These events can be detected using the event type "SYSTEM"</p>
    <h4>Format</h4>
    <p>
      <code>&lt;timestamp&gt; &lt;facility.severity&gt; &lt;hostname&gt; &lt;event-tag+severity&gt;: &lt;event type&gt;: &lt;event name&gt;: - - &lt;message text&gt;</code>
    </p>
    <h4>Example</h4>
    <p>
      <code>2016-03-22T13:01:29+0800 &lt;local4.notice&gt; solace-u1 SOLACNOTI: SYSTEM: SYSTEM_AD_MSG_SPOOL_CHG: - - Message spool on Primary Virtual Router operational state change from AD-Activating to AD-Active</code>
    </p>
    <p>
      <img src="../Resources/Images/Broker-Monitoring/Example-43-SystemEvents.PNG" style="max-width: 100%;" alt=""/>
    </p>
    <p class="Note">In the example the system log tag is set to "SOLAC".</p>
    <h3><a name="Message-"/>Message-VPN Events</h3>
    <p>These events can be detected using the event type "VPN". The field <code>&lt;vpn-name&gt;</code> can be used to correlate all Message VPN Syslog messages generated for a particular Message VPN.</p>
    <h4>Format</h4>
    <p>
      <code>&lt;timestamp&gt; &lt;facility.severity&gt; &lt;hostname&gt; &lt;event-tag+severity&gt;: &lt;event type&gt;: &lt;event name&gt;: &lt;vpn-name&gt; - &lt;message text&gt;</code>
    </p>
    <h4>Example</h4>
    <p>
      <code>2016-03-21T10:47:00+0800 &lt;local3.warning&gt; solace-u1 SOLTSTWARN : VPN: VPN_AD_MSG_SPOOL_HIGH: testVpn - Message VPN (10) Queue testQueue message spool threshold 819200 kB (80%) reached: 1024022 kB</code>
    </p>
    <p>
      <img src="../Resources/Images/Broker-Monitoring/Example-43-MessageEvents.PNG" style="max-width: 100%;" alt=""/>
    </p>
    <p class="Note">In the example the message-vpn event log tag is set to "SOLTST".</p>
    <h3><a name="Client"/>Client Events</h3>
    <p>These events can be detected using the event type "CLIENT". The fields <code>&lt;vpn-name&gt;</code> and <code>&lt;client-name&gt;</code> can be used to correlate all client-level Syslog messages generated for a particular Message VPN.</p>
    <h4>Format</h4>
    <p>
      <code>&lt;timestamp&gt; &lt;facility.severity&gt; &lt;hostname&gt; &lt;event-tag+severity&gt;: &lt;event type&gt;: &lt;event name&gt;: &lt;vpn-name&gt; &lt;client-name&gt; &lt;message text&gt;</code>
    </p>
    <h4>Example</h4>
    <p>
      <code>2016-03-22T14:54:02+0800 &lt;local3.info&gt; solace-u2 SOLTSTWARN: CLIENT: CLIENT_CLIENT_OPEN_FLOW: testVpn LSGRHO412K1Z/8080/#00000008 Client (616) LSGRHO412K1Z/8080/#00000008 username testUser Pub flow session flow name 2488b4056c49467fbc931ffe3d78f4b1 (487), publisher id 281, last message id 0, window size 50</code>
    </p>
    <p>
      <img src="../Resources/Images/Broker-Monitoring/Example-43-ClientEvents.PNG" style="max-width: 100%;" alt=""/>
    </p>
    <p class="Note">In the example the Message VPN event log tag is set to "SOLTST".</p>
    <h2 class="with-rule"><a name="Syslog3"/>Syslog Timestamp Format</h2>
    <p>By default, event broker Syslog events are recorded with the following timestamp format:</p>
    <p>
      <code>YYYY-MM-DDTHH:MM:SS+/-HHMM</code>
    </p>
    <p><u>Where</u>:</p>
    <p><code>&lt;+/-HHMM&gt;</code> is the format of the timezone offset.</p>
    <p><u>Example</u>:</p>
    <p>
      <code>2018-02-09T15:47:52+0500</code>
    </p>
    <h2 class="with-rule"><a name="Sample"/>Sample Syslog Event Entries</h2>
    <p>Four sample Syslog entries are shown below; the first three are system alerts while the fourth is a client level alert.</p>
    <ul>
      <li>
        <code>2013-02-28T09:32:34-0600 &lt;local3.warning&gt; SOLACELAB1 event: <b>SYSTEM: SYSTEM_NAB_NONCRITICAL_HARDWARE_NOTIFICATION</b>: - - Slot 1/1 Non-critical hardware notification: component NPU-PIP type invalid-frame info 0x0000000000000002</code>
      </li>
      <li>
        <code>2013-03-04T11:24:56-0600 &lt;local3.err&gt; SOLACELAB1 event: <b>SYSTEM: SYSTEM_CHASSIS_HARDWARE_SOFT_ERROR</b>: - - Slot 1/3 Hardware soft error detected on TRB FPGA 1 info CRC error is detected in the FPGA configuration</code>
      </li>
      <li>
        <code>2015-08-20T16:28:42+0800 &lt;local3.info&gt; solsg1 event: CLIENT: CLIENT_CLIENT_OPEN_FLOW: TEST_VPN nagiosServer.solacesystems.com/30068/#00000001 Client(2705) username TEST_BRIDGE Pub flow session flow name 71701d48391045209526b4f77f132419 (4352), publisher id 2257, last message id 49063099, window size 50</code>
      </li>
      <li>
        <code>13-03-11T16:47:39-0600 &lt;local3.info&gt; SOLACELAB1 event: <b>CLIENT: CLIENT_CLIENT_DISCONNECT</b>: SOLACEAPP_UAT svc_testbridge_1 Client (385) svc_testbridge_1 username TEST_BRIDGE WebSessionId (N/A) reason(Peer TCP Closed) final statistics - dp(9, 9, 0, 0, 9, 9, 520, 475, 0, 0, 520, 475, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) conn(0, 0, 10.63.4.161:50203, CLSWT, 0, 0, 0) zip(0, 0, 0, 0, 0.00, 0.00, 0, 0, 0, 0, 0, 0, 0, 0) web(0, 0, 0, 0, 0, 0, 0), SslVersion(), SslCipher()</code>
      </li>
    </ul>
  </body>
</html>

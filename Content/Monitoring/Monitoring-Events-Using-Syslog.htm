<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1><MadCap:concept term="Software;Appliance"/>Monitoring Events Using Syslog</h1>
    <p>You can use the syslog logging mechanism to monitor Solace PubSub+ event broker events.</p>
    <p>Solace PubSub+ software generates syslog messages, as defined in RFC 3164, to record events  that occur on the event broker, such as:</p>
    <ul>
      <li><u>Routine operations</u>: such as clients connecting and disconnecting, change of command modes</li>
      <li><u>Failure and error conditions</u>: such as redundant power supply failures</li>
      <li><u>Emergency or critical conditions</u>: such as a blade taken offline due to excessive temperature</li>
    </ul>
    <p>Each syslog message identifies the software process or event broker subsystem that generated the message, and briefly describes the operation or error that occurred.</p>
    <p>As shown in the figure <MadCap:xref href="#SolOS">SolOS syslog Message Flow</MadCap:xref> below, the syslog system offers both the logging of syslog event messages to local files on event brokers, as well as the forwarding of syslog event messages over the network through standard protocols to remote hosts.</p>
    <p>A description of syslog messages related to event broker events can be found at <MadCap:xref href="PubSub-Event-Reference.htm">Solace PubSub+ Event Reference</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="montoring_and_management_1462237600_256863"/>Syslog Message Format and Components</h2>
    <p>A syslog message ASCII string consists of:</p>
    <ul>
      <li>a message priority (facility and severity)</li>
      <li>a header (timestamp and host)</li>
      <li>the message string</li>
    </ul>
    <p>Each syslog message belongs to a facility, which is a group of messages that are either generated by the same software process, or concern a similar event broker subsystem condition or activity (such as debugging attempts).</p>
    <p>Four configurable facility destinations are defined and reserved on the event broker for grouping together related messages from a facility log file: command, debug, event, and system (refer to the table <MadCap:xref class="Num" href="#montoring_and_management_1462237600_256883">SolOS syslog Facilities</MadCap:xref> below). Syslog message files from the four nonâ€‘configurable destinations are all directed to a file on the local syslog message host.</p>
    <p>In addition, three configurable facility destinations are available for configuration by users for grouping together related messages from a facility to a log file for forwarding to a remote syslog host.</p>
    <p class="GraphicCaption"><a name="SolOS"/>Syslog Message Flow</p>
    <p>
      <img src="../Resources/Images/Broker-Monitoring/syslog_mesage_flow.jpg" alt=""/>
    </p>
    <table class="TableStyle-Table_Num" style="caption-side: top;width: 95%;mc-table-style: url('../Resources/TableStyles/Table_Num.css');" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption"><a name="montoring_and_management_1462237600_256883"/>Syslog Facilities</p>
      </caption>
      <col width="25%" class="TableStyle-Table_Num-Column-Column1"/>
      <col width="25%" class="TableStyle-Table_Num-Column-Column1"/>
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 50%;"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Local Syslog Facility</th>
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Associated Log</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Type of Event or Error</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">local0</p>
          </td>
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">debug</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">Actions performed or errors encountered by debug processes.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">local1</p>
          </td>
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">command</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">Actions performed or errors encountered by commands issued at the event broker Command Line Interface (CLI) prompt or by CLI script files, or by SEMP.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">local3</p>
          </td>
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">event</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">Actions performed or errors encountered by event broker processes, for example, event broker events related to publishers and subscribers, event broker events related to physical links/LAGs, event broker events related to routing protocols, event broker events related to physical hardware.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">local4</p>
          </td>
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">system</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p class="Tbl_Body">Actions performed or errors encountered by event broker processes that relate to the health of the event broker.</p>
            <p>The system log is a subset of the event log, where important logs for monitoring systems are duplicated. The majority of SYSTEM_* events are duplicated, along with many VPN_* events that are noteworthy (e.g. HIGH and _CLEAR events). Note that no CLIENT* events are duplicated.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p>Each syslog message is also preassigned a severity level, which indicates how seriously the triggering event affects event broker functions. These message event severity levels are defined as an ordered list. The <MadCap:xref class="Num" href="#montoring_and_management_1462237600_256933">SolOS syslog Message Severity Levels</MadCap:xref> listed below define the message event severity levels, from highest level to lowest.</p>
    <p>The associated facility and severity level of a syslog message are together referred to as its priority.</p>
    <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../Resources/TableStyles/Table_Num.css');width: 95%;" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption"><a name="montoring_and_management_1462237600_256933"/>Syslog Message Severity Levels</p>
      </caption>
      <col width="25%" class="TableStyle-Table_Num-Column-Column1"/>
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 75%;"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Severity Level</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">crit</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">Failures causing many or all services in the system to go down.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">err</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">A service has gone down. An unexpected service outage affecting a small number or single service.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">warning</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">A service has been degraded or is exceeding expected operating thresholds.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p class="Tbl_Body">notice</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p class="Tbl_Body">Normal but significant conditions; for example, service-affecting configuration changes.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">info</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p class="Tbl_Body">Clearing previous raised conditions where no action needs to be taken.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h3><a name="montoring_and_management_1462237600_256965"/>Events to Monitor to Determine the Health of Event Brokers</h3>
    <p>Solace recommends that an operations team monitor the events contained in the system syslog (<code>system.log</code> or system facility), as this syslog contains all events relevant to the health of the event broker. An operations team may also want to monitor some events in the <code>event.log</code> file depending on the how their messaging network is deployed. For a detailed listing of the possible events and descriptions of each event, refer to <MadCap:xref href="PubSub-Event-Reference.htm">SolOS Event Reference</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="montoring_and_management_1462237600_256968"/>Configuring Syslog to Forward Messages</h2>
    <p>You can use a syslog facility destination on an event broker to group together related messages from a facility to a log file so that it can be forwarded to a remote syslog message host. A maximum of three user-configured syslog destinations are permitted per event broker.</p>
    <p>Syslog message files from a user-configured destination are not received by remote syslog message hosts (that is, clients) until hosts are designated and configured. You can configure up to three syslog message hosts for each user-configured syslog destination.</p>
    <ul>
      <li>To create a new syslog facility destination, enter the following command:
                <pre>solace(configure)# create syslog &lt;name&gt;</pre><li>To edit the properties of an existing syslog facility destination, enter the following command:
				<pre>solace(configure)# syslog &lt;name&gt;</pre><p><u>Where</u>:</p><p><code>&lt;name&gt;</code> is the name of the user-configured syslog destination. The syslog name can contain up to 31 alphanumeric characters and must be unique among all created syslog destinations.</p><p class="Note">The no version of this command (<b>no syslog</b>) removes the given syslog destination from the event broker.</p></li></li>
    </ul>
    <p>For a syslog destination, you can configure the following parameters:</p>
    <ul>
      <li>
        <MadCap:xref href="#montoring_and_management_1462237600_256989">Facility</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#montoring_and_management_1462237600_256998">Host</MadCap:xref>
      </li>
    </ul>
    <h3><a name="montoring_and_management_1462237600_256989"/>Facility</h3>
    <p>To add the command, event, or system syslog facility to a user-configured syslog destination, enter the following commands:</p>
    <pre>solace(configure)# create syslog &lt;name&gt;<br/>solace(configure/syslog)# facility {command | event | system}</pre>
    <p><u>Where</u>:</p>
    <p><code>command</code> asks to add the command syslog facility to the user-configured destination</p>
    <p><code>event</code> asks to add the event syslog facility to the user-configured destination</p>
    <p><code>system</code> asks to add the system syslog facility to the user-configured destination</p>
    <p class="Note">The no version deletes the specified facility from the user-configured destination.</p>
    <h3><a name="montoring_and_management_1462237600_256998"/>Host</h3>
    <p>To designate a remote syslog message host as a recipient for syslog files, enter the following commands:</p>
    <pre>solace(configure)# create syslog &lt;name&gt;<br/>solace(configure/syslog)# host &lt;hostname-or-address&gt; [transport {tcp | udp | tls}]</pre>
    <p><u>Where</u>:</p>
    <p>&lt;<code>hostname-or-address</code>&gt; is either the name of the remote host, or the IP address with optional port number, specified in the dotted decimal notation form nnn.nnn.nnn.nnn[:nnn]. UDP port 514 is used as a default if the port number is not provided.</p>
    <p><code>transport {tcp | udp | tls}</code> sets the transport mode used for forwarding the syslog file to the remote host to either TCP, UDP, or TLS, respectively. UDP is used as a default if this parameter is not provided. If the transport mode is set to  TLS, the CA certificates to trust, the allowed protocol versions, and the cipher suites to accept across the remote rsyslogd TLS connection are specified using the global SSL CLIÂ commands. For more information, see <MadCap:xref href="../Security/TLS-SSL-Encryption.htm">TLS/SSL Encryption</MadCap:xref>.</p>
    <p class="Note">The no version of this command (<b>no host</b>) removes the specified host from the user-configured destination.</p>
    <MadCap:dropDown>
      <MadCap:dropDownHead>
        <MadCap:dropDownHotspot><a name="montoring_and_management_1462237600_257007"/>Syslog Configuration Example</MadCap:dropDownHotspot>
      </MadCap:dropDownHead>
      <MadCap:dropDownBody>
        <p>This CLI command sequence example configures the syslog facility destination named <code>bestlogspotever</code>, adds the command and event facilities to this user-configured syslog destination, and designates and configures two syslog message hosts for receipt of the forwarded syslog message file.</p>
        <pre>solace&gt; enable<br/>solace# configure terminal<br/>solace(configure)# create syslog bestlogspotever<br/>solace(configure/syslog)# facility command<br/>solace(configure/syslog)# facility event<br/>solace(configure/syslog)# host 192.168.1.12 transport tcp<br/>solace(configure/syslog)# host 192.168.1.13 transport tcp</pre>
        <p class="Tip">To remove the syslog destination named <code>bestlogspotever</code> once configured, enter:<br/><code>solace(configure)# no syslog bestlogspotever</code></p>
      </MadCap:dropDownBody>
    </MadCap:dropDown>
    <h2 class="with-rule"><a name="Configur"/>Configuring the Message Format for Syslog Facilities</h2>
    <p>To allow you to more easily understand the contents of log messages, the event broker allows event and system log messages to be emitted from the broker as JSON, with the message arguments in independent JSON properties.</p>
    <p>To configure the message format for the event and system syslog facilities, enter the following commands:</p>
    <pre xml:space="preserve">solace(configure)# logging
solace(configure/logging)# facility
solace(configure/logging/facility)# {event |Â system} message-format {text |Â json}  </pre>
    <p><u>Where</u>:</p>
    <p><code>event</code> specifies to configure the event syslog facility message format. </p>
    <p><code>system</code> specifies to configure the system syslog facility message format.</p>
    <p><code>text</code> specifies to log message as unstructured text. This is the default value. </p>
    <p><code>json</code> specifies to log message as JSON.</p>
    <p>The no form of this command <code>no {event |Â system} message-format</code>, returns the value to the default. </p>
    <p class="Note"> Log files are not rotated when the format is updated, so at the time of the switch the log file will contain a mix of formats.</p>
    <p>
      <u>JSON Format</u>
    </p>
    <p>When JSON format is enabled, the log message is formatted as JSON (all on a single line) and that JSON is passed to syslog().  The arguments to the log message in <MadCap:xref href="../Admin-Ref/Solace-PubSub-Event-Reference/event_ref_boiler.html">Solace PubSub+ Syslog Events</MadCap:xref> is the names of the properties.  In addition, the following metadata properties are added at the start of the object in this order:</p>
    <p><code>time</code> â€” the RFC 3339 timestamp.</p>
    <p><code>solFacility</code> â€” the Solace name for the syslog facility. Either <code>event</code> or <code>system</code>.</p>
    <p><code>severity</code> â€” the syslog severity.</p>
    <p><code>host</code> â€” the hostname.</p>
    <p><code>tag</code> â€” the event tag.  </p>
    <p><code>scope</code> â€” either <code>VPN</code>, <code>CLIENT</code>, or <code>SYSTEM</code>.</p>
    <p><code>event</code> â€” the event name, for example <code>CLIENT_CLIENT_DISCONNECT</code>.</p>
    <p><code>vpn</code> â€” the name of the VPN.  Only added if the scope is <code>VPN</code> or <code>CLIENT</code>.</p>
    <p><code>client</code> â€” the name of the client.  Only added if the scope is <code>CLIENT</code>.</p>
    <p><code>raise</code> â€” an identifier to allow correlation of raise and clear events; also serves to indicate that this event is a raise event.  Only added for raise events.</p>
    <p><code>clear</code> â€” an identifier to allow correlation of raise and clear events; also serves to indicate that this event is a clear event.  Only added for clear events.</p>
    <p>After the metadata, the arguments follow in the order they are defined.  A <code>msg</code> property is added at the end with the event text (with substitutions).</p>
    <h3><a name="Setting"/>Setting the Maximum Size of JSON Format Syslog Messages</h3>
    <p>You can set the maximum size of JSON format syslog messages. If the full JSON would exceed that size, properties are dropped or truncated from the end of the message until the value fits within the specified size with an additional property <code>logIncomplete</code> added with the value <code>1</code>.  Only the <code>msg</code> property is truncated, all other properties are dropped if the full value doesn't fit. </p>
    <p>Setting a maximum size is useful because the event broker will remove properties or truncate the value of the <code>msg</code> property, but will still produce valid JSON.  Downstream processes will generally just truncate the log line, resulting in invalid JSON.</p>
    <p>To set the maximum size of JSON format syslog messages, enter the following commands:</p>
    <pre xml:space="preserve">solace(configure)# logging
solace(configure/logging)# max-json-message-size &lt;max-size&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;max-size&gt;</code> is the maximum size in bytes of JSON format syslog messages. If a remote syslog destination is configured, the syslog header is included. The valid range of values is 1024 to 8192. The default value is 8192. </p>
    <p>The no version of this command, <code>no max-json-message-size</code>, returns the value to the default. </p>
    <h2 class="with-rule"><a name="montoring_and_management_1462237600_257019"/>Viewing Syslog Status</h2>
    <p>To view the configuration of syslog on your event broker, enter the following command:</p>
    <pre>solace&gt; show syslog [&lt;name&gt;]</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;name&gt;</code> is the name of the syslog facility destination. Entering no name displays all destinations. </p>
    <MadCap:dropDown>
      <MadCap:dropDownHead>
        <MadCap:dropDownHotspot>Example</MadCap:dropDownHotspot>
      </MadCap:dropDownHead>
      <MadCap:dropDownBody>
        <pre>solace&gt; show syslog bestlogspotever<br/>------------------------------------------------<br/>Name: bestlogspotever<br/>Facilities: event command<br/>Files<br/>HostsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Transport<br/>Â Â 192.168.1.12Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TCP<br/>Â Â 192.168.1.13Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TCP<br/>solace&gt; show syslog<br/>------------------------------------------------<br/>Name: command<br/>Facilities: command<br/>Files<br/>Â Â command.log<br/>HostsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Transport<br/>------------------------------------------------<br/>Name: debug<br/>Facilities: debug<br/>Files<br/>Â Â debug.log<br/>HostsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Transport<br/>------------------------------------------------<br/>Name: event<br/>Facilities: event<br/>Files<br/>Â Â event.log<br/>HostsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Transport<br/>------------------------------------------------<br/>Name: system<br/>Facilities: system<br/>Files<br/>Â Â system.log<br/>HostsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Transport<br/>------------------------------------------------<br/>Name: scott<br/>Facilities: event command<br/>Files<br/>HostsÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Transport<br/>Â Â 192.168.1.12Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TCP<br/>Â Â 192.168.1.13Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â TCP<br/></pre>
      </MadCap:dropDownBody>
    </MadCap:dropDown>
    <h2 class="with-rule"><a name="Managing"/>Managing Local Syslog Files</h2>
    <p>Syslog record files are uncompressed text files that have a  <code>&lt;filename&gt;.log.[x]</code> format, where &lt;filename&gt;Â can be named after a command, event, system, or debug, and x is an integer from 1 to 20 that identifies the archived file number. The active file is named <code>&lt;filename&gt;.log</code> with no numeric suffix.</p>
    <h3><a name="Retrievi"/>Retrieving Syslog Record Files</h3>
    <p>Syslog record files are stored locally as uncompressed text files in the <code>/logs</code> subdirectory on the event broker. To retrieve and view the command log record files, use these CLIÂ commands :</p>
    <ul>
      <li><b>copy</b> â€” transfers a text file from the <code>/logs</code> subdirectory to an external SFTP or SCPÂ server from the event broker.<br/>Example:<br/><pre>solace# copy /logs/command.log sftp://john@10.11.12.13/home/john/solacelogs/</pre></li>
      <li><b>more</b> â€” directly displays the contents of a text file from the <code>/logs</code> subdirectory on the event broker.<br/>Example:<br/><pre>solace&gt; more /logs/system.log</pre></li>
    </ul>
    <h3><a name="managing_cli_user_authentication_and_authorization_1602666776_190469"/>Logging Capacity</h3>
    <p>The active syslog record file closes once the file size exceeds 50 MB. Upon closing, a new file opens, and this cycle repeats. The syslog record text files are in the <code>/logs</code> directory and can be retrieved from event brokers. You can view up to 21 syslog record text files for every local syslog facility at any given time, including the active log file. To stay within the 21 file limit, when a new log file is created, the oldest log file is discarded to make space for the new log file. Retention of log files is subject to available disk space. The PubSub+ <MadCap:variable name="Product-Names.broker_sw_short"/> caps the space allocated to logs at 1GB.</p>
    <p class="Note">Syslog record files may contain personal information. To learn more about how to protect this data, see <MadCap:xref href="Configuring-Log-Retention-Policy.htm">Configuring the Log File Retention Policy</MadCap:xref>.</p>
    <h3><a name="managing_cli_user_authentication_and_authorization_1602666776_190503"/>Directory Maintenance</h3>
    <p>Because syslog record files are rotated, directory maintenance is not required.</p>
    <h2 class="with-rule"><a name="command_logging"/>Managing Command Logging</h2>
    <p>The command logging facility is used to capture information about all event broker commands issued by users through either the Solace CLI or the SEMP interface.</p>
    <p style="font-weight: bold;">Command Log Record Data Example:</p>
    <pre>2016-05-02T10:24:51.162-05:00 &lt;local1.info&gt; solace1 admin[12694]: CLI/2        192.168.1.217    admin             10:24:47  10:24:48  ok                              (configure/message-vpn)# max-connections 2000</pre>
    <p>The information contained in each command log record includes, in order:</p>
    <ul>
      <li>log date and time, for example, <code>2016-05-02T10:24:51.162-05:00</code></li>
      <li>syslog destination and level, for example, <code>&lt;local1.info&gt;</code></li>
      <li>hostname of the event broker, for example, <code>solace1</code></li>
      <li>local user name with local process identifier number or pid in square brackets, for example, <code>admin[12694]</code></li>
      <li>type of event broker interface making the command attempt, for example, <code>CLI</code> or <code>SEMP:Â CLI/2</code></li>
      <li>IP address of host of source of command attempt, for example, <code>192.168.1.217</code></li>
      <li>user name assigned to the CLI or SEMP user account</li>
      <li>time when command attempt was started, for example, <code>10:24:47</code></li>
      <li>time when command attempt finished, for example, <code>10:24:48</code></li>
      <li>description of result, that is: ok, command action status, or reason for failure</li>
      <li>command operation attempted:Â <code>(configure/message-vpn)# max-connections 2000</code></li>
    </ul>
    <h3><a name="managing_cli_user_authentication_and_authorization_1602666776_189833"/>Configuring Command Logging</h3>
    <p>To configure the command logging feature on an event broker, which logs user actions and commands to a viewable command log file, enter the following CLI commands:</p>
    <pre>solace(configure)# logging<br/>solace(configure/logging)# command {cli | semp-mgmt | semp-msgbus| all} mode {shutdown | config-cmds | all-cmds}</pre>
    <p><u>Where</u>:</p>
    <p><code>cli</code>, <code>semp-mgmt</code>, <code>semp-msgbus</code>, or <code>all</code> specify the event broker interface to be logged</p>
    <p><code>shutdown</code> turns off the command logging facility for the specified event broker interface</p>
    <p><code>config-cmds</code> specifies log only configuration commands (not show commands) for the specified event broker interface</p>
    <p><code>all-cmds</code> specifies log all commands except for help (help commands are never logged) for the specified event broker interface</p>
    <p class="Note">The no version of this command (<b>no command {cli | semp | all}</b>) reverts  command logging  back to the default mode of logging only configuration commands for the specified event broker interface (that is, <code>cli</code>, <code>semp-mgmt</code>, <code>semp-msgbus</code>, or <code>all</code>).</p>
    <h3><a name="managing_cli_user_authentication_and_authorization_1602666776_189993"/>Viewing Command Logging Configuration</h3>
    <p>To view the configuration of the command logging facility on the event broker, enter the following CLI command:</p>
    <pre>solace&gt; show logging command</pre>
    <MadCap:dropDown>
      <MadCap:dropDownHead>
        <MadCap:dropDownHotspot>Example</MadCap:dropDownHotspot>
      </MadCap:dropDownHead>
      <MadCap:dropDownBody>
        <pre>solace&gt; show logging command</pre>
        <pre>Â </pre>
        <pre>Cmd InterfaceÂ Â Â Â Â Â Â Logging Mode</pre>
        <pre>--------------------------------</pre>
        <pre>CLIÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â config</pre>
        <pre>SEMP/mgmtÂ Â Â Â Â Â Â Â Â Â Â config</pre>
        <pre>SEMP/msgbusÂ Â Â Â Â Â Â Â Â config</pre>
      </MadCap:dropDownBody>
    </MadCap:dropDown>
    <h2 class="with-rule"><a name="montoring_and_management_1462237600_257077"/>Interpreting Client Disconnect Event Logs</h2>
    <p>Whenever clients are disconnected from the event broker, the event broker reports the reason for the disconnect through a disconnect event log. This log reports the final statistic summary event for the connection.</p>
    <p style="font-weight: bold;">SMF Client Disconnect Event Log Example</p>
    <pre>2013-05-06T18:18:56-0400 &lt;local3.info&gt; solace1 event: CLIENT: CLIENT_CLIENT_DISCONNECT: testVpn testHost/17879/#00010001 Client (82) testHost/17879/#00010001 username testUser WebSessionId (N/A) reason(Peer TCP Closed) final statistics - dp(103, 103, 0, 0, 103, 103, 1557, 2373, 0, 0, 1557, 2373, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) conn(0, 0, 192.168.164.34:58214, CLSWT, 0, 0, 0) zip(0, 0, 0, 0, 0.00, 0.00, 0, 0, 0, 0, 0, 0, 0, 0) web(0, 0, 0, 0, 0, 0, 0), SslVersion(), SslCipher()</pre>
    <p style="font-weight: bold;">MQTT Client Disconnect Event Log Example</p>
    <pre>2017-07-03T15:59:23+0800 &lt;local3.info&gt; sgdemo1 event: CLIENT: CLIENT_CLIENT_DISCONNECT_MQTT: plant_monitor #mqtt/PLANT_MONITOR_192.168.42.250/71841 Client (1141) #mqtt/PLANT_MONITOR_192.168.42.250/71841 username default ClientId (PLANT_MONITOR_192.168.42.250) reason(Client Disconnect Received) final statistics - dp(2, 1, 1, 0, 3, 1, 80, 4, 238, 0, 318, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) conn(0, 0, 192.168.42.1:20362, ESTAB, 0, 0, 0) mqtt(1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1), SslVersion(), SslCipher(), WillSent(0)</pre>
    <p>The <code>reason</code> entry describes why the client was disconnected:</p>
    <ul>
      <li>(Client Disconnect Received)â€”Connection dropped because  a disconnect notification was received. </li>
      <li>(Document Too Large)â€”Connection dropped because  an incoming message is too large.</li>
      <li>(Forced Logout)â€”Administrative disconnect or shutdown action triggered either by a client disconnect, or by replacement of duplicate client connections during authentication.</li>
      <p class="Note">Replacement of duplicate client connections during authentication is by default enabled on the event broker. To disable, enter the following command: <code>solace(configure)# no authentication replace-duplicate-client-connections</code>.</p>
      <li>(Inactive Connection)â€”Connection dropped due to an inactive network connection.</li>
      <li>(Peer Draining Messages Too Slowly)â€”Connection dropped due to low throughput while the event broker is under stress. During stressful conditions, the event broker drops connections that are moving too slowly to free up system resources.</li>
      <li>(Peer Host Unreachable)â€”The event broker is unable to reach the remote host.</li>
      <li>(Peer Refused TCP Connection)â€”For a connection initiated by the event broker (for example, Message VPN bridging and event broker-to-event broker connections), the peer refused the TCP connection.</li>
      <li>(Peer TCP Closed)â€”The remote end has gracefully closed the TCP connection.</li>
      <li>(Peer TCP Reset)â€”The remote end has ungracefully closed the TCP connection.</li>
      <li>(SSL CTX has been expired)â€”The oldest TLS context (data derived from the server certificate) in the event broker expired. Clients using that TLS context are disconnected.</li>
      <li>(TCP Keep-Alive Failure)â€”Connection dropped due to a failure on the remote end to respond to a TCP Keepalive probe.</li>
      <li>(Too Many TCP Retransmissions)â€”Connection dropped due to bad throughput.</li>
    </ul>
    <p>The <code>dp</code> entry lists the following client dataplane statistics, in order:</p>
    <ul>
      <li>Control Messages Received</li>
      <li>Control Message Delivered</li>
      <li>Topic Messages Received</li>
      <li>Topic Messages Delivered</li>
      <li>Total Messages Received</li>
      <li>Total Message Delivered</li>
      <li>Control Bytes Received</li>
      <li>Control Bytes Delivered</li>
      <li>Topic Bytes Received</li>
      <li>Topic Bytes Delivered</li>
      <li>Total Bytes Received</li>
      <li>Total Bytes Delivered</li>
      <li>Current Message Rate at Ingress</li>
      <li>Current Message Rate at Egress</li>
      <li>Average Message Rate at Ingress</li>
      <li>Average Message Rate at Egress</li>
      <li>Denied Duplicate Clients</li>
    </ul>
    <p>(Messages Discarded at Ingress due to:)</p>
    <ul>
      <li>No Subscription Match</li>
      <li>Topic Parse Error</li>
      <li>Internal Parse Error</li>
      <li>Message Too Big</li>
    </ul>
    <p>(Queue Discards due to:)</p>
    <ul>
      <li>Transmit Congestion</li>
    </ul>
    <p>The <code>conn</code> entry lists the following client connection statistics information, in order:</p>
    <ul>
      <li>Received Queue Bytes</li>
      <li>Send Queue Bytes</li>
      <li>Client Address: Port</li>
      <li>State</li>
      <li>Received Out of Order</li>
      <li>Fast Retransmit</li>
      <li>Timed Retransmit</li>
    </ul>
    <p>The <code>zip</code> entry lists the following client compression statistics information, in order:</p>
    <ul>
      <li>Compressed Bytes Received</li>
      <li>Compressed Bytes Delivered</li>
      <li>Uncompressed Bytes Received</li>
      <li>Uncompressed Bytes Delivered</li>
      <li>Compression Ratio at Ingress</li>
      <li>Compression Ratio at Egress</li>
      <li>Current Compressed Byte Rate at Ingress</li>
      <li>Current Compressed Byte Rate at Egress</li>
      <li>Current Uncompressed Byte Rate at Ingress</li>
      <li>Current Uncompressed Byte Rate at Egress</li>
      <li>Average Compressed Byte Rate at Ingress</li>
      <li>Average Compressed Byte Rate at Egress</li>
      <li>Average Uncompressed Byte Rate at Ingress</li>
      <li>Average Uncompressed Byte Rate at Egress</li>
    </ul>
    <p>The <code>web</code> entry lists the following Web client dataplane statistics information, in order:</p>
    <ul>
      <li>Web Messages Receivedâ€”total number of HTTP requests received by the event broker for the client session.</li>
      <li>Web Messages Deliveredâ€”total number of HTTP responses sent by the event broker for the client session.</li>
      <li>Web Bytes Receivedâ€”total number of octets in the message bodies of all HTTP requests received by the event broker for the client session.</li>
      <li>Web Bytes Deliveredâ€”total number of octets in the message bodies of all HTTP responses sent by the event broker for the client session.</li>
      <li>Web Out Of Orderâ€”approximate number of TCP out-of-order reception events detected by the event broker, which occur while the TCP connection is in use by the client session.</li>
      <li>Web Fast Retransmitâ€”approximate number of TCP fast retransmission events initiated by the event broker after receiving duplicate TCP acknowledgments, which occur while the TCP connection is in use by the client session.</li>
      <li>Web Timed Retransmitâ€”approximate number of TCP timed retransmission events initiated by the event broker after not receiving TCP acknowledgments, which occur while the TCP connection is in use by the client session.</li>
    </ul>
    <p>The <code>mqtt</code> entry lists the following control packet statistics for MQTT clients, in order:</p>
    <ul>
      <li>CONNECT packets received</li>
      <li>CONNACK packets sent</li>
      <li>CONNACK Errors sent</li>
      <li>PUBRECâ€”Publish Received responses</li>
      <li>PUBLISHâ€”Publish Message packets sent</li>
      <li>PUBACKâ€”Publish Acknowledgements Received</li>
      <li>PUBACKâ€”Publish Acknowledgements sent</li>
      <li>PUBRECâ€”Publish Received packets sent</li>
      <li>PUBRELâ€”Publish Release responses received</li>
      <li>PUBCOMPâ€”Publish Complete responses sent</li>
      <li>SUBSCRIBEâ€”Subscribe to Topics packets received</li>
      <li>SUBACKâ€”Subscribe Acknowledgements sent</li>
      <li>SUBACKâ€”Subscribe Acknowledgement errors sent</li>
      <li>UNSUBSCRIBEâ€”Unsubscribe from Topic packets received</li>
      <li>UNSUBSCRIBEâ€”Unsubscribe from Topic packets sent</li>
      <li>PINGREQâ€”PING Requests received</li>
      <li>PINGRESPâ€”PING Responses sent</li>
      <li>DISCONNECTâ€”Disconnect notifications received<p class="Note">For information on the various MQTT control packets, see <MadCap:xref href="../API/MQTT-311-Prtl-Conformance-Spec/MQTT Control Packets.htm">3 MQTT Control Packets</MadCap:xref> in the MQTT Version 3.1.1 Protocol Conformance document.</p></li>
    </ul>
    <p>Where <code>SslVersion</code> lists the TLS/SSL protocol version used.</p>
    <p>Where <code>SslCipher</code> lists the cipher suite used.</p>
    <h2 class="with-rule"><a name="montoring_and_management_1462237600_257149"/>Interpreting Flow Event Logs</h2>
    <p>Whenever a flow is closed or unbound from an endpoint on the event broker, the event broker reports the reason for it through a flow event log. This log reports the final statistic summary event for the flow close or unbind, as applicable.</p>
    <p style="font-weight: bold;">Flow Close Event Log Example</p>
    <pre>2015-01-08T09:05:40+0000 &lt;local3.info&gt; lab-128-68 event: CLIENT: CLIENT_CLIENT_CLOSE_FLOW: solace dev214/9997/#00010001 Client (6119) dev214/9997/#00010001 username default Pub flow session flow name 99f5f4aa343a4e77bc45f6b3c4db2946 (8048), publisher id 5949, last message id 565, window size 50, final statistics - flow(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 565)</pre>
    <p>The <code>flow</code> entry lists the following flow close statistics, in order:</p>
    <ul>
      <li>Spooling Not Ready</li>
      <li>Out of Order Messages</li>
      <li>Duplicate Messages</li>
      <li>No Eligible Destinations</li>
      <li>Spool Over Quota</li>
      <li>Queue/Topic-Endpoint Over </li>
      <li>Replay Log Over Quota</li>
      <li>Maximum Message Usage Exceeded</li>
      <li>Maximum Message Size Exceeded</li>
      <li>Remote Router Spooling Not Supported</li>
      <li>Spool To ADB Fail</li>
      <li>Spool To Disk Fail</li>
      <li>Errored Message</li>
      <li>Queue Not Found</li>
      <li>Spool Shutdown Discard</li>
      <li>User Profile Deny Guaranteed</li>
      <li>No Local Delivery Discard</li>
      <li>SMF TTL Exceeded</li>
      <li>Publish ACL Denied</li>
      <li>Destination Group Error</li>
      <li>Not Compatible With Forwarding Mode</li>
      <li>Low-Priority-Msg Congestion Discard</li>
      <li>Spool File Limit Exceeded</li>
      <li>Replication Is Standby Discard</li>
      <li>Sync Replication Ineligible Discard</li>
      <li>Messages Received</li>
      <p class="Note">Descriptions for these flow close statistics can be found in <MadCap:xref href="../Messaging/Guaranteed-Msg/Monitoring-Guaranteed-Messaging.htm#Descript">Description of Detailed Spooled Message Statistics</MadCap:xref>.</p>
    </ul>
    <p style="font-weight: bold;">Flow Unbind Event Log Example</p>
    <pre>CLIENT: CLIENT_CLIENT_UNBIND: RP dev3-185/30296/00030001/349CSHv5cC Client (66) dev3-185/30296/00030001/349CSHv5cC username solclient_1 Unbind to Flow Id (11), ForwardingMode(StoreAndForward), final statistics - flow(255, 0, 0, 0, 0, 2, 0, 0, 2, 0), isActive(No), Reason(Client issued unbind)
</pre>
    <p>The <code>flow</code> entry lists the following flow unbind statistics, in order:</p>
    <ul>
      <li>Message Spool Window Size</li>
      <li>Used Window</li>
      <li>Unacked Messages</li>
      <li>Low Message ID AckPending</li>
      <li>High Message ID AckPending</li>
      <li>Window Closed</li>
      <li>Message Redelivered</li>
      <li>Message Transport Retransmits</li>
      <li>Message Confirmed Delivered Store and Forward</li>
      <li>Message Delivered Cut Through</li>
    </ul>
  </body>
</html>

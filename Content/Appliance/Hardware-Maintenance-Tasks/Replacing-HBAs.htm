<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1><MadCap:concept term="Appliance"/>HBA Replacement</h1>
    <p>This section describes how to replace Host Bus Adapters (HBAs) in a Solace PubSub+ appliance. The HBA that is replaced could be either the same model or another model that is compatible with an appliance of the same chassis type. The provided HBA replacement procedures will preserve any spooled messages.</p>
    <h2 class="with-rule"><a name="ESD/Safe"/>ESD/Safety Precautions</h2>
    <p>Before replacing an HBA, review the following safety warning.</p>
    <div class="Caution">
      <p class="Tbl_Body"> To prevent equipment damage from ESD, always ensure that the appliance chassis is electrically connected to earth ground. Always follow ESD prevention procedures when removing and replacing power supplies. Use an anti-static wrist strap, or another anti-static device. If no wrist strap or mat is available, ground yourself by touching the metal part of the chassis.</p>
    </div>
    <h2 class="with-rule"><a name="Tool"/>Tool and Equipment Requirements</h2>
    <p>The following tools and equipment are required to replace an HBA in an appliance:</p>
    <ul>
      <li>Electrostatic discharge wrist strap</li>
      <li>Anti-static mat</li>
      <li>Anti-static packaging for HBA</li>
      <li>No. 1 Phillips head screwdriver (Solace PubSub+ 3260s)</li>
      <li>No. 2 Phillips head screwdriver (Solace PubSub+3530s and Solace PubSub+ 3560s)</li>
      <li>No. 1 slotted screwdriver (Solace PubSub+ 3560s)</li>
      <li>a compatible replacement HBA (ordered from Solace)</li>
    </ul>
    <h2 class="with-rule"><a name="hardware_maintenance_tasks_3613430003_430124"/>Procedure for Standalone Appliances</h2>
    <p>Perform the following steps to replace an HBA in a standalone Solace PubSub+ appliance:</p>
    <ol>
      <li>Register the Worldwide Name (WWN) used by the HBA with the external disk storage array that is used.
        <MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Example: </MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><p class="Code">   HBA-0208FC-01-A s/n: FC23016580<br/> <br/>WWN1 = 20:00:00:90:fa:07:09:e2:10:00:00:90:fa:07:09:e2<br/>WWN2 = 20:00:00:90:fa:07:09:e3:10:00:00:90:fa:07:09:e3</p></MadCap:dropDownBody></MadCap:dropDown></li>
      <li>Enter the following User EXEC command to determine the current version of Solace PubSub+ software that the appliance is running:
        <p class="Code">solace&gt; show version</p></li>
      <li>As a protective measure, enter the following command to make a copy of the current software configuration in the <code>/configs</code> subdirectory:
        <pre xml:space="preserve">solace&gt; enable
solace# copy current-config
/configs/&lt;version&gt;_preBladeReplacementCfg</pre><p>Where: </p><p><code>&lt;version&gt;</code> is the version number of current software as seen in the output of the <code>show version</code> User EXEC command.</p></li>
      <li>Ensure that the internal disks are in a redundant state:
        <p>Enter the following command:</p><pre>solace# show disk</pre><MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Example:</MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><p class="Code">   Reload required:               No<br/> <br/>Attribute                        Disk 1               Disk 2<br/>------------------ -------------------- --------------------<br/>Device Model                ST3250310NS          ST3250310NS<br/>Capacity (MB)                    238475                38475<br/>Admin State                     enabled              enabled<br/>Operational State                failed                   up<br/> <br/>RAID in fully redundant state: Yes</p></MadCap:dropDownBody></MadCap:dropDown><div class="Caution"><p class="Tbl_Body"> If the displayed output shows the RAID disk drives to be in a non-redundant state, <a href="../../get-support.htm" class="link-internal">contact Solace</a>, and stop this hardware replacement procedure immediately to prevent software corruption on the appliance.</p></div></li>
      <li>Enter the following command to turn off power to the appliance:
        <p class="Code">solace# power-down</p></li>
      <li>Physically remove the existing HBA and install the replacement HBA in its place.  Refer to one of the following:</li>
      <ul>
        <li>For PubSub+ 3260 HBA replacements: <MadCap:xref href="Physically-Replacing-Bla.htm">Physically Replacing Blades in 3260s</MadCap:xref></li>
        <li>For PubSub+ 3530 HBA replacements: <MadCap:xref href="Physically-Replacing-Bla-1.htm">Physically Replacing Blades in 3530/3560s</MadCap:xref></li>
        <li>For PubSub+ 3560 HBA replacements: <MadCap:xref href="Physically-Replacing-HBAs-in-3560s.htm">Physically Replacing HBAs in 3560s</MadCap:xref></li>
      </ul>
      <li>After the new HBA has been properly installed in the chassis, power up the appliance:
        <ul><li>For a PubSub+ 3230s or PubSub+ 3260, use a paper clip to press the (<img src="Images/standby_button.png" style="margin-left: 1.86264px;margin-top: 1.70568px;margin-right: 2.394px;margin-bottom: 0.200159px;vertical-align: text-bottom;" alt=""/>) on/standby button on the front panel of the replacement appliance to turn power back on to the appliance.</li><li>For a PubSub+ 3530 or PubSub+ 3560, press the (<img src="Images/standby_button.png" style="margin-left: 1.86264px;margin-top: 1.70568px;margin-right: 2.394px;margin-bottom: 0.200159px;vertical-align: text-bottom;" alt=""/>) on/standby button at the rear panel of the appliance.</li></ul><p>Alternately, use WOL to turn power back on to the appliance through a WOL magic packet (refer to <MadCap:xref MadCap:unresolvedLink="import-link:general_router_admin_tasks_2612439345_91392">Turning On Power to Routers Using Wake On LAN</MadCap:xref> for details).</p></li>
    </ol>
    <h2 class="with-rule"><a name="hardware_maintenance_tasks_3613430003_430187"/>Procedure for Redundant Appliances</h2>
    <p>Perform the following steps to replace an HBA used by an appliance that belongs to an HA redundant pair of Solace PubSub+ appliances:</p>
    <ol>
      <li>Register the Worldwide Name (WWN) for the replacement HBA with the external disk storage array that is used.
        <MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Example: </MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><p class="Code">   HBA-0208FC-01-A s/n: FC23016580<br/> <br/>WWN1 = 20:00:00:90:fa:07:09:e2:10:00:00:90:fa:07:09:e2<br/>WWN2 = 20:00:00:90:fa:07:09:e3:10:00:00:90:fa:07:09:e3</p></MadCap:dropDownBody></MadCap:dropDown></li>
      <li>Determine the current version of Solace PubSub+ software that the appliance is running.
        <p>Enter the following commands:</p><p class="Code">solace2&gt; show version</p></li>
      <li>As a protective measure, enter the following command to make a copy of the current software configuration in the <code>/configs</code> subdirectory:
        <pre xml:space="preserve">solace2&gt; enable
solace2# copy current-config
/configs/&lt;version&gt;_preBladeReplacementCfg</pre><p>Where: </p><p><code>&lt;version&gt;</code> is the version number of current software as seen in the output of the <code>show version</code> User EXEC command.</p></li>
      <li>Ensure that the internal disks are in a redundant state.
        <p>Enter the following command:</p><p class="Code">solace2# show disk</p><MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Example:</MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><p class="Code">   Reload required:               No<br/>Attribute                        Disk 1               Disk 2<br/>------------------ -------------------- --------------------<br/>Device Model                ST3250310NS          ST3250310NS<br/>Capacity (MB)                    238475                38475<br/>Admin State                     enabled              enabled<br/>Operational State                failed                   up<br/>RAID in fully redundant state: Yes</p></MadCap:dropDownBody></MadCap:dropDown><div class="Caution"><p class="Tbl_Body">If the displayed output shows the RAID disk drives to be in a non‑redundant state, <a href="../../get-support.htm" class="link-internal">contact Solace</a>, and stop this hardware replacement procedure immediately to prevent software corruption on the appliance.</p></div></li>
      <li>Enter the following command to turn off power to the appliance:
        <p class="Code">solace2# power-down</p></li>
      <li>Physically remove the existing HBA and install the replacement HBA in its place. Refer to one of the following:</li>
      <li>
        <ul>
          <li>For PubSub+ 3230 HBA replacements: <MadCap:xref href="Physically-Replacing-Bla.htm">Physically Replacing Blades in 3260s</MadCap:xref></li>
          <li>For PubSub+ 3530 HBA replacements: <MadCap:xref href="Physically-Replacing-Bla-1.htm">Physically Replacing Blades in 3530/3560s</MadCap:xref></li>
          <li>For PubSub+ 3560 HBA replacements: <MadCap:xref href="Physically-Replacing-HBAs-in-3560s.htm">Physically Replacing HBAs in 3560s</MadCap:xref></li>
        </ul>
      </li>
      <li>After the new HBA has been properly installed in the chassis, power up the appliance:
        <ul><li>For a PubSub+ 3230 or PubSub+ 3260, use a paper clip to press the (<img src="Images/standby_button.png" style="width: 13.29216px;height: 15.50688px;margin-left: 1.86264px;margin-top: 1.70568px;margin-right: 2.394px;margin-bottom: 0.200159px;vertical-align: text-bottom;" alt=""/>) on/standby button on the front panel of the replacement appliance to turn power back on to the appliance.</li><li>For a PubSub+ 3530 or PubSub+ 3560, press the (<img src="Images/standby_button.png" style="width: 13.29216px;height: 15.50688px;margin-left: 1.86264px;margin-top: 1.70568px;margin-right: 2.394px;margin-bottom: 0.200159px;vertical-align: text-bottom;" alt=""/>) on/standby button at the rear panel of the appliance.</li></ul><p>Alternately, use WOL to turn power back on to the appliance through a WOL magic packet (refer to <MadCap:xref MadCap:unresolvedLink="import-link:general_router_admin_tasks_2612439345_91392">Turning On Power to Routers Using Wake On LAN</MadCap:xref> for details).</p></li>
      <li>If the appliance is the backup appliance in the redundant pair, to ensure that the appliance can properly access the external disk storage array, perform a failover so that it takes activity. You can then switch activity back to its mate appliance again.</li>
      <li>Enter the <code>release-activity</code> Redundancy CONFIG CLI command on the primary appliance to surrender activity to the backup appliance.
        <pre xml:space="preserve">solace1(configure)# redundancy
solace1(configure/redundancy)# release-activity
solace1(configure/redundancy)# exit
solace1(configure)# </pre></li>
      <li>To verify the appliance has taken activity  from the mate appliance, enter the following command:        <p class="Code">solace2(configure)# show redundancy</p><p class="SWSubstep">Once it is confirmed that the backup appliance has taken activity, enter the <code>no release-activity</code> Redundancy CONFIG CLI command on the primary appliance to enable it to take activity again.</p><pre xml:space="preserve">solace1(configure)# redundancy
solace1(configure-redundancy)# no release-activity
solace1(configure-redundancy)# end
solace1#</pre></li>
      <li>If auto-revert is disabled, enter the <code>revert-activity</code> Redundancy ADMIN CLI command on the backup appliance to revert activity back to the primary appliance.</li>
    </ol>
  </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    </head>
  <body>
    <h1>Connecting to Google Cloud Functions Using REST</h1>
    <p>The Click-to-Connect Wizard in <MadCap:variable name="Product-Names.pubsubmanager_long"/> can create REST connectors to Google Cloud services like Cloud Functions.</p>
    <p>These connectors use REST Delivery Points (RDPs) to trigger Cloud Functions to handle events from a PubSub+ event broker, making it easy for you to event enable your serverless architecture as part of your event-driven architecture (EDA) journey.</p>
    <h3 class="with-rule">Goals</h3>
    <p>The goal of this tutorial is to demonstrate how to set up a REST connector in a PubSub+ event broker to send messages from a remote connection on the broker to Google Cloud Functions. This tutorial will show you how to:</p>
    <ul>
      <li>Configure the event broker to set up RDPs with a REST connector</li>
      <li>Send messages to Cloud Functions using the <b>Try Me!</b> functionality built into the <MadCap:variable name="Product-Names.pubsubmanager_long"/></li>
      <li>Review the messages in Google Cloud Functions logs</li>
    </ul>
    <h3 class="with-rule">Prerequisites</h3>
    <ul>
      <li>PubSub+ Event Broker version 9.9.0 or higher</li>
      <li>Access to <MadCap:xref href="../Admin/Broker-Manager/PubSub-Manager-Overview.htm">[%=Product-Names.pubsubmanager_long%]</MadCap:xref></li>
    </ul>
    <h2 class="with-rule">Connecting to Cloud Functions</h2>
    <p>This example shows how to integrate the PubSub+ event broker with Google Cloud Functions.</p>
    <p class="Note">Before you can integrate the PubSub+ event broker, you must set up a Cloud Function service that will handle messages being sent from the connector.</p>
    <ol>
      <li>Log into the <MadCap:variable name="Product-Names.pubsubmanager_long"/>.</li>
      <li>Launch the connector <b>Click-to-Connect Wizard</b> (refer to <MadCap:xref href="../Admin/Broker-Manager/Cloud-Connector-Click-to-Connect.htm">Creating a REST Connector with Click-to-Connect</MadCap:xref>).</li>
      <li>Click <b>Google Cloud Platform</b>.<div class="thumbnail-container"><img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_New_Connector.png" alt=""/><img src="../Resources/Images/expand-icon.png" class="img-expand" alt=""/></div></li>
      <li>
        <p>Click <b>Cloud Functions</b>, then click <b>Authenticate</b>. </p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example2.png" alt=""/>
        </div>
      </li>
      <li>
        <p>Provide a name for this connector and, in the <b>Google Function URL</b> field, enter the trigger URL for the Cloud Function  app that will handle the messages.</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example3.png" alt=""/>
        </div>
        <p class="Tip">You can get the trigger URL for the Cloud Function app from your Google Cloud Platform portal.</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example4.png" alt=""/>
        </div>
      </li>
      <li>
        <p>Decide whether you want this RDP connection to allow unauthenticated access.</p>
        <p>
          <img src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example5.png" alt=""/>
        </p>
        <p class="Tip">If you choose not to allow unauthenticated access, you must provide a Google Key File, which must be in JSON format. You can get this key from your Google Cloud administrator, or, if you have permission to create a service account, you can generate a key for yourself.</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example6.png" alt=""/>
        </div>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example7.png" alt=""/>
        </div>
      </li>
      <li>
        <p>Click <b>Connector Setup</b> and review the settings (they are auto-populated based on the <b>Google Function URL</b> that you provided in the previous step).</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example8.png" alt=""/>
        </div>
      </li>
      <li>
        <p>Click <b>Subscription Setup</b> and enter the name of the topic to which the messages will be published.</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example9.png" alt=""/>
        </div>
      </li>
      <li>
        <p>Click <b>Create and Enable Connector</b> to finalize the connector creation.</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example10.png" alt=""/>
        </div>
      </li>
      <li>
        <p>In the <MadCap:variable name="Product-Names.pubsubmanager_long"/> <b>Try Me!</b> application, send a message to the topic you configured for the connector:</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example11.png" alt=""/>
        </div>
      </li>
      <li>
        <p>View the message in the Cloud Functions logs.</p>
        <div class="thumbnail-container">
          <img class="solacethumbnail" src="../Resources/Images/C2C-Examples/RDP_to_Google_Functions_example12.png" alt=""/>
        </div>
      </li>
    </ol>
  </body>
</html>

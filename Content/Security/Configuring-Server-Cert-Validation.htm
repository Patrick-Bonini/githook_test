<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Configuring Server Certificate Validation Settings</h1>
    <p>You can configure server certificate validation settings to make certificate validation more secure or less secure. These settings are used for validating the server certificate that is passed from a remote event broker to the local event broker during a TLS/SSL handshake.</p>
    <p>Certificate validation settings can be specified for Message VPN bridges and replication Config-Sync bridges.</p>
    <p> You can make the following certificate validation configurations:</p>
    <ul>
      <li>
        <MadCap:xref href="#Server-Name-Validation">Validate Server Names</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#VPN-Bridges-Max-Chain">Maximum Certificate Chain Depth</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#VPN-Bridges-Cert-Dates">Validate Certificate Date</MadCap:xref>
      </li>
    </ul>
    <div class="Caution">
      <p>When you make a change to the server certificate validation settings for Message VPN bridges, the PubSub+ broker automatically disconnects and then reconnects all TLS-enabled bridges in the Message VPN to enable the change. </p>
    </div>
    <p class="Note">For information on setting a client certificate for Message VPN bridges, refer to <MadCap:xref href="../Features/VPN/Configuring-VPN-Bridges.htm#Config-Client-Cert">Configuring Client Certificate Authentication</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="Server-Name-Validation"/>Enabling Server Name Validation</h2>
    <p>You can enable or disable the TLS authentication mechanism to verify the name used to connect to the remote broker. If enabled, the Server Name Indication (SNI) extension is sent on outgoing TLS connections and the server name used for that connection is verified against the server names in the Subject Alternative Name (SAN) extension in the certificate returned from the remote broker.</p>
    <p>This parameter is  enabled by default.</p>
    <ul>
      <li>
        <p style="font-weight: bold;">Message VPN Bridges</p>
        <p>To enable  the validation of server names for Message VPN bridges, enter the following commands:</p>
        <p class="Code">solace(configure)# message-vpn &lt;vpn-name&gt;<br/>solace(configure/message-vpn)# bridging ssl server-certificate-validation<br/>solace(...ing/ssl/server-certificate-validation)# validate-server-name</p>
      </li>
      <li>
        <p style="font-weight: bold;">Replication Config-Sync Bridges</p>
        <p>To enable  the validation of server names for replication Config-Sync bridges, enter the following commands:</p>
        <p class="Code">solace(configure)# replication<br/>solace(configure/replication)# config-sync bridge ssl-server-certificate-validation<br/>solace(...dge/ssl-server-certificate-validation)# validate-server-name</p>
      </li>
    </ul>
    <p>The no version of these commands, <code>no validate-server-name</code>, disables the validation of server names.</p>
    <h2 class="with-rule"><a name="VPN-Bridges-Max-Chain"/>Configuring Maximum Certificate Chain Depths</h2>
    <p>The depth of a certificate chain is the number of signing CA certificates that are present in the chain back to a trusted self-signed root CA certificate. Setting a maximum certificate chain depth means that bridge connections will reject any certificates whose depth is higher than the maximum limit.</p>
    <ul>
      <li>
        <p style="font-weight: bold;">Message VPN Bridges</p>
        <p>To configure the maximum certificate chain depth for Message VPN bridges, enter the following  commands:</p>
        <p class="Code">solace(configure)# message-vpn &lt;vpn-name&gt;<br/>solace(configure/message-vpn)# bridging ssl server-certificate-validation<br/>solace(...ing/ssl/server-certificate-validation)# max-certificate-chain-depth &lt;max-depth&gt;</p>
        <p><u>Where</u>:</p>
        <p><code>&lt;max-depth&gt;</code> is a number from 0 to 8 specifying the maximum number of signing CA certificates that may be present in the certificate chain. The default value is 3.</p>
      </li>
      <li>
        <p style="font-weight: bold;">Replication Config-Sync Bridges</p>
        <p>To configure the maximum certificate chain depth for replication Config-Sync bridges, enter the following commands:</p>
        <p class="Code">solace(configure)# replication<br/>solace(configure/replication)# config-sync bridge ssl-server-certificate-validation<br/>solace(...dge/ssl-server-certificate-validation)# max-certificate-chain-depth &lt;max-depth&gt;</p>
        <p><u>Where</u>:</p>
        <p><code>&lt;max-depth&gt;</code> is a number from 0 to 8 specifying the maximum number of signing CA certificates that may be present in the certificate chain. The default value is 3.</p>
      </li>
    </ul>
    <p>The no version of these commands, <code>no max-certificate-chain-depth</code>, resets this parameter to its default value.</p>
    <h2 class="with-rule"><a name="VPN-Bridges-Cert-Dates"/><a name="Rep-Config-Sync-Cert-Date"/>Enabling Certificate Date Validation</h2>
    <p>Certificates may specify "not before" and "not after" dates to provide a time range for which they will be valid. This setting will enable or disable the validation of these dates. If this check is disabled, the bridge will accept a certificate even if the valid date range provided in the certificate is not fulfilled.</p>
    <p>By default, validation of certificate dates is enabled.</p>
    <ul>
      <li>
        <p style="font-weight: bold;">Message VPN Bridges</p>
        <p>To enable validation of certificate dates for Message VPN bridges, enter the following commands:</p>
        <p class="Code">solace(configure)# message-vpn &lt;vpn-name&gt;<br/>solace(configure/message-vpn)# bridging ssl server-certificate-validation<br/>solace(...ing/ssl/server-certificate-validation)# validate-certificate-date</p>
      </li>
      <li>
        <p style="font-weight: bold;">Replication Config-Sync Bridges</p>
        <p>To enable validation of certificate dates for replication Config-Sync bridges, enter the following commands:</p>
        <p class="Code">solace(configure)# replication<br/>solace(configure/replication)# config-sync bridge ssl-server-certificate-validation<br/>solace(...dge/ssl-server-certificate-validation)# validate-certificate-date</p>
      </li>
    </ul>
    <p>The no version of these commands, <code>no validate-certificate-date</code>, disables validation of the  certificate dates.</p>
  </body>
</html>

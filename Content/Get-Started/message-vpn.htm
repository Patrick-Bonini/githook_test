<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1><MadCap:concept term="Cloud;Appliance;Software"/>Message VPNs</h1>
    <p>A Message VPN is a managed object on a <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker that allows for the segregation of topic space and clients. Message VPNs also group clients connecting to a network of event brokers, such that messages published within a particular group are only visible to that group's clients.</p>
    <p><MadCap:variable name="Product-Names.cloud_product_short"/><MadCap:variable name="Product-Names.broker_cloud_short"/>s have only a single message VPN. Because <MadCap:variable name="Product-Names.cloud_product_short"/> allows you to quickly create multiple <MadCap:variable name="Product-Names.broker_cloud_short"/>s, you can use separate services to segregate topics and clients instead of using multiple message VPNs on the same <MadCap:variable name="Product-Names.broker_sw_short"/> or <MadCap:variable name="Product-Names.broker_appliance_short"/>.</p>
    <h2>Publishing and Subscribing Via Message VPNs</h2>
    <p>Message VPNs can define which clients can receive messages from which publishers.</p>
    <p>Clients in different Message VPNs can subscribe to identical topics, and clients in different Message VPNs can publish messages to topics that match those client subscriptions. However, based on Message VPN membership, only clients connected to the same Message VPN as a particular publisher receive  messages from that publisher.</p>
    <p style="text-align: left;">
      <img src="../Resources/Images/Getting-Started/message-vpn.png" alt="Illustration depicting the concepts described in the surrounding text."/>
    </p>
    <p>In this example, all of the subscriber clients subscribe to the topic <code>quotes/equities/NA</code>. Publisher A, Subscriber 1, and Subscriber 2 are all connected to the same message VPN. Publisher B, Subscriber 3, and Subscriber 4 are connected to a separate Message VPN on the same event broker. Because the clients are connected to separate Message VPNs, when Publisher A publishes a message to topic <code>quotes/equities/NA</code>, the message is delivered only to Subscriber 1 and Subscriber 2. Similarly, if Publisher B publishes a message to the topic <code>quotes/equities/NA</code>, the message is delivered only to Subscriber 3 and Subscriber 4.</p>
    <h2>Message VPN Bridges</h2>
    <p>If you need to allow published messages to cross Message VPN boundaries, you can configure a Message VPN bridge  to link two Message VPNs so that messages published to one Message VPN that match the topic subscriptions set for the bridge are also delivered to the linked Message VPN. A bridge can be uni-directional (messages pass over the bridge in only one direction) or bi-directional (messages pass over the bridge in both directions). Message VPN bridges can be are useful in the following circumstances:</p>
    <ul>
      <li>Linking two Message VPNs with different names to enable Direct or Guaranteed messages published to one Message VPN to be delivered to the other Message VPN. The linked Message VPNs can be on the same event broker or two separate event brokers.</li>
      <li>Linking two Message VPNs with the same names on two separate event brokers to enable Direct or Guaranteed messages published to one Message VPN to be delivered to the other Message VPN.</li>
    </ul>
    <p>
      <img src="../Resources/Images/Getting-Started/message-vpn-bridge.png" alt="Illustration depicting the concepts described in the surrounding text."/>
    </p>
    <p>For more information, see <MadCap:xref href="../Features/VPN/Message-VPN-Bridges-Overview.htm">Message VPN Bridges</MadCap:xref>.</p>
    <h2>Connecting to Message VPNs</h2>
    <p>Each client connection is associated with a single Message VPN. When a client sends its initial login connection request to an event broker, the client typically includes a Message VPN name parameter. The event broker then verifies that for the specified Message VPN the client username has been configured and  is authorized to connect. A global, per-Message-VPN and per-client statistic is incremented for every denied connection attempt.</p>
    <p>A client connection can't change its assigned Message VPN once it has been established by the initial login request without first disconnecting from the event broker.</p>
    <h4><a name="default-msg-vpn"/>Default Message VPN</h4>
    <p>Each <MadCap:variable name="Product-Names.broker_sw_short"/> event broker and <MadCap:variable name="Product-Names.broker_appliance_short"/> has a Message VPN named <code>default</code>. It can't be deleted, but it can be configured like any other Message VPN object on the event broker. If a client doesn't provide the name of a Message VPN name to connect to, the default is automatically assigned to the client.</p>
    <p><MadCap:variable name="Product-Names.cloud_product_titlecase"/><MadCap:variable name="Product-Names.broker_cloud_short"/>s also have a single default Message VPN, which is named based on the <MadCap:variable name="Product-Names.broker_cloud_short"/> name, using all lowercase letters and replacing spaces with hyphens. For example, an <MadCap:variable name="Product-Names.broker_cloud_short"/> named "My Service" would have a message VPN named "my-service". You can rename the Message VPN for an event broker service.</p>
    <p>To learn more, see <MadCap:xref href="../Features/VPN/Managing-Message-VPNs.htm" target="_blank">Message VPNs</MadCap:xref>.</p>
    <p class="with-rule">Now that we've covered the basics of how event brokers get event data from the publishing application to the clients that want to know about it, learn more about how an event mesh can expand this functionality for enterprises in <MadCap:xref href="understanding-event-meshes.htm">Understanding Event Meshes</MadCap:xref>.</p>
  </body>
</html>

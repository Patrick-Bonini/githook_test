<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1>Completing Transactions</h1>
    <p>Messages that are published and received on a Transaction are staged on the Solace PubSub+ event broker. A Transaction can either be:</p>
    <ul>
      <li>Completed through a commit operation: <MadCap:xref href="#Committing_trans">Committing Transactions</MadCap:xref></li>
      <li>Canceled through a rollback operation: <MadCap:xref href="#Rolling_back">Rolling Back Transactions</MadCap:xref></li>
    </ul>
    <h2 class="with-rule"><a name="Committing_trans"/>Committing Transactions</h2>
    <p>When a commit is successfully invoked for a Transaction, the following occurs:</p>
    <ul>
      <li>for publish operations, the staged messages are sent to their destinations</li>
      <li>for receive operations, the received messages are acknowledged by the consumers and then removed from the endpoints they were spooled to</li>
    </ul>
    <p>Commits are blocking operations. After these actions, the Transaction is completed, and the next Transaction automatically begins.</p>
    <p>If a commit fails for any reason (for example, due to failures of previous send and/or receive operations), a rollback of the entire Transaction will occur. A rollback exception or error and a specific subcode will be generated. The failure cause can be determined from the subcode.</p>
    <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');width: 95%;" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption">To Commit Transactions</p>
      </caption>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1"><MadCap:variable name="Product-Names.pubsub_brand_only"/>Â Messaging API</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Call</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">JCSMP</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_BodyCode">TransactedSession.commit()</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">Java RTO</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_BodyCode">TransactedSessionHandle.commit()</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">C</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_BodyCode">solClient_transactedSession_commit()</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">.NET</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p class="Tbl_BodyCode">TransactedSession.commit()</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 class="with-rule"><a name="Rolling_back"/>Rolling Back Transactions</h2>
    <p>Instead of completing an active Transaction through a commit, a client can rollback the Transaction. When a rollback is performed, the following occurs:</p>
    <ul>
      <li>staging information for the active transaction is removed, so that:<ul><li>for publish operations, the published messages are deleted</li><li>for consume operations, messages remain on the endpoints they were spooled to</li></ul></li>
      <li>a new transaction is automatically generated</li>
    </ul>
    <p>Rollbacks are blocking operations.</p>
    <p class="Note">If a Transacted Session fails due to a network failure or an event broker reset, the client can immediately reconnect (this is automatic if the number of reconnect retries for the client connection is greater than zero), and, if possible, the API reestablishes the Transaction that was in progress. If the Session and Transaction are not reestablished within three minutes, the event broker automatically rolls back the Transaction that was in progress. (For information on setting client reconnect properties, refer to <MadCap:xref href="Configuring-Connection-T.htm">Configuring Connection Time-Outs and Retries</MadCap:xref>.)</p>
    <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');width: 95%;" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption">To Rollback Transactions</p>
      </caption>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1"><MadCap:variable name="Product-Names.pubsub_brand_only"/> Message API</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Call</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">JCSMP</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_BodyCode">TransactedSession.rollback()</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">Java RTO</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_BodyCode">TransactedSessionHandle.rollback()</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">C</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_BodyCode">solClient_transactedSession_rollback(...)</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">.NET</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p class="Tbl_BodyCode">TransactedSession.rollback(...)</p>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

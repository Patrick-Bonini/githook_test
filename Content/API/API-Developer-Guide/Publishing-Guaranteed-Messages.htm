<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1><a name="publishing_guaranteed_messages_3926332939_605417"/>Publishing Guaranteed Messages</h1>
    <p>A client application can publish Guaranteed messages, that is, messages that the client application assigns a Persistent or Non‑Persistent delivery mode to Queue or Topic destinations.</p>
    <p>For a client to publish Guaranteed messages in a Session, a producer flow to the host event broker is required. For JCSMP, a producer flow is created when an XMLMessageProducer is acquired. For the Java RTO, C, and .NET APIs, a producer flow is automatically established when a client begins to send persistent messages in the Session.</p>
    <p class="Note">If a client disconnects, its publisher Flow will automatically expire if the client does not reconnect within three minutes.</p>
    <p>The published Guaranteed messages have persistence because they are spooled (that is, they are written to persistent storage) to one of the following types of endpoints provisioned on the event broker:</p>
    <ul>
      <li>A Queue that matches the messages’ Queue destination.</li>
      <li>A Queue that is assigned a Topic subscription that matches the message’s Topic destination.</li>
      <li>A Topic Endpoint that is assigned a topic subscription that matches the message’s Topic destination.</li>
    </ul>
    <p>For more information on endpoints and how to create them, refer to <MadCap:xref href="Receiving-Guaranteed-Messages.htm">Receiving Guaranteed Messages</MadCap:xref>.</p>
    <p class="Note">It is also possible for messages published with a Direct delivery mode to be spooled to an endpoint when there is a match between the message’s Topic destination and the Topic subscription set for the endpoint. In this case, when the message is spooled to the endpoint, it is given a non‑persistent delivery mode so that a client can consume the message over its established Guaranteed message Flow.</p>
    <p>Consuming clients can receive Guaranteed messages when they bind to an endpoint by creating a Guaranteed messaging Flow to that endpoint. For information, refer to <MadCap:xref href="Receiving-Guaranteed-Messages.htm">Receiving Guaranteed Messages</MadCap:xref>.</p>
    <p>The figure below shows the process of publishing and receiving Guaranteed messages.</p>
    <p class="GraphicCaption"><a name="publishing_guaranteed_messages_3926332939_612041"/>Publishing Guaranteed Messages</p>
    <p class="GraphicCaption">
      <img src="Images/pub_guaranteed_msg_overview.jpg" alt=""/>
    </p>
    <h4>Related Event Broker Provisioning and Configuration Information</h4>
    <p>For clients to publish messages to a Message VPN, the event broker must have Guaranteed Messaging and message spooling enabled. In addition, the clients must be assigned appropriately configured client profiles and/or Access Control List (ACL) profiles:</p>
    <ul>
      <li>To publish Guaranteed messages, clients must be assigned client profiles that have the <code>allow‑guaranteed‑message‑send</code> parameter enabled. </li>
      <li>To allow clients to publish messages to topics (or to only a specific set of topics) clients must be assigned ACLs with the appropriate access controls.</li>
    </ul>
  </body>
</html>

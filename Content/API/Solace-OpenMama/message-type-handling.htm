<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
    <title>Terminology</title>
  </head>
  <body>
    <h1>OpenMAMA Message Type Handling</h1>
    <p>The SolOpenMAMA Plug-In receives the following standard market data-oriented OpenMAMA message types, it converts them into one of the following  Plug-In message types:</p>
    <ul>
      <li>
        <MadCap:xref href="#Initial">SOLCACHE_MSG_TYPE_INITIAL</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#BOOK-Initial">SOLCACHE_MSG_TYPE_BOOK_INITIAL</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#BOOK-UPDATE">SOLCACHE_MSG_TYPE_BOOK_UPDATE</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#DELETE">SOLCACHE_MSG_TYPE_DELETE</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
      </li>
    </ul>
    <p>The Plug-In will discard any messages that cannot be categorized as one of the types listed above. Also it will generate a PubSub+ Cache NOTICE level (the default PubSub+ Cache log level) log entry about this message.</p>
    <p>The following table summarizes how OpenMAMA message types are converted into Plug-In message types.</p>
    <table style="width: 95%;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" class="TableStyle-Table_Num" cellspacing="0">
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">OpenMAMA Message Type</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Plug-In Message Type</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_INITIAL</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#Initial">SOLCACHE_MSG_TYPE_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_SNAPSHOT</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#Initial">SOLCACHE_MSG_TYPE_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_RECAP</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#Initial">SOLCACHE_MSG_TYPE_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_DDICT_SNAPSHOT</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#Initial">SOLCACHE_MSG_TYPE_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_UPDATE</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_CANCEL</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_ERROR</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_CORRECTION</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_CLOSING</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_PREOPENING</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_QUOTE</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_TRADE</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_ORDER</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#update">SOLCACHE_MSG_TYPE_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_BOOK_INITIAL</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#BOOK-Initial">SOLCACHE_MSG_TYPE_BOOK_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_BOOK_SNAPSHOT</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#BOOK-Initial">SOLCACHE_MSG_TYPE_BOOK_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_BOOK_RECAP</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#BOOK-Initial">SOLCACHE_MSG_TYPE_BOOK_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_BOOK_CLEAR</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#BOOK-Initial">SOLCACHE_MSG_TYPE_BOOK_INITIAL</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_BOOK_UPDATE</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#BOOK-UPDATE">SOLCACHE_MSG_TYPE_BOOK_UPDATE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_DELETE</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DELETE">SOLCACHE_MSG_TYPE_DELETE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_EXPIRE</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#DELETE">SOLCACHE_MSG_TYPE_DELETE</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_NOT_PERMISSIONED</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_NOT_FOUND</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_END_OF_INITIALS</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_WOMBAT_REQUEST</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_WOMBAT_CALC</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_SEC_STATUS</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_MISC</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_TIBRV</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_FEATURE_SET</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_SYNC_REQUEST</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_REFRESH</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p>MAMA_MSG_TYPE_WORLD_VIEW</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_NEWS_QUERY</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_NULL</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p>MAMA_MSG_TYPE_ENTITLEMENTS_REFRESH</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p>MAMA_MSG_TYPE_UNKNOWN</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p>
              <MadCap:xref href="#DISCARD">SOLCACHE_MSG_TYPE_DISCARD</MadCap:xref>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 class="with-rule"><a name="Initial"/>SOLCACHE_MSG_TYPE_INITIAL</h2>
    <p>Initial messages are minimally validated to ensure that it they have proper Solace payloads. This allows any basic message format errors to be detected and reported when the initial value is cached instead of later during cache update operations.</p>
    <p>Initial messages are already in the format that a subscriber expects when it makes a PubSub+ Cache Instance request. Therefore, the Plug-In does not perform any additional processing on an initial message, and the message is cached unmodified.</p>
    <p class="Note">Multi-part initial value messages are not supported.</p>
    <h2 class="with-rule"><a name="update"/>SOLCACHE_MSG_TYPE_UPDATE</h2>
    <p>When an update message is received, the Plug-In merges any updates from the new message with the cached message for the same topic by iterating over the fields of the received message’s payload and updating the corresponding fields in the cached message’s payload. When the information is merged the following occurs:</p>
    <ul>
      <li>if the field does not exist in the cached message, it is added</li>
      <li>if the field exists in the cached message, its value is replaced with that from the received update message</li>
    </ul>
    <p>If the PubSub+ Cache Instance does not have an Initial message for the update’s topic, the update message is either discarded or written to the PubSub+ Cache Instance. The action to take is determined by the <code>update_before_initial</code> property of the Plug-In configuration file (for information, refer to <MadCap:xref href="Configuring-Message-Caching.htm#Configur">Configuring the SolOpenMAMA Plug-In</MadCap:xref>).</p>
    <p>Note:</p>
    <ul>
      <li>The message type field of the cached message is not changed from initial to update. This allows the message provided to a requesting client through a cache response to emulate a response provided to a subscriber that requests an initial value from a publisher.</li>
      <li>If the update message contains OpenMAMA’s <code>SubMsg </code>fields, those fields will either replace the corresponding fields in the cached message, or be merged with the corresponding fields in the cached message. The action that is taken is determined by the value defined for the <code>mama.solace.cacheplugin.submsg_field_alg</code> property of the <code>mama.properties</code> configuration file. For more information, refer to <MadCap:xref href="Configuring-Message-Caching.htm#Configur">Configuring the SolOpenMAMA Plug-In</MadCap:xref>.</li>
    </ul>
    <h2 class="with-rule"><a name="BOOK-Initial"/>SOLCACHE_MSG_TYPE_BOOK_INITIAL</h2>
    <p>When an initial book message is received, the Plug-In does the following:</p>
    <ol>
      <li>Validates that the received message has a proper message format. This allows any basic message format errors to be detected and reported when the initial value of a topic is cached rather than later during cache update operations.</li>
      <li>Uses OpenMAMDA functions to modify the message’s format to one that a subscriber expects when it makes an order book request.</li>
      <li>If the initial book message is received after a previous initial book message has already been cached, the Plug-In may update cached values with those provided by latest received initial book message. For example, the <code>MamaFieldMsgStatus</code>, <code>MamaFieldSeqNum</code>, <code>MamaFieldSenderId</code> fields may be updated.</li>
      <li>If the received message was a recap book message, the current state of the order book is added to the message to be cached.</li>
      <li>Instructs the PubSub+ Cache Instance to cache the initial book message.</li>
    </ol>
    <p class="Note">When the Plug-In receives a <code>MAMA_MSG_TYPE_BOOK_CLEAR</code> message type, the cached book message is retained, but all the entries in the book message are cleared.</p>
    <h2 class="with-rule"><a name="BOOK-UPDATE"/>SOLCACHE_MSG_TYPE_BOOK_UPDATE</h2>
    <p>When an update book message is received, the Plug-In does the following:</p>
    <ol>
      <li>Retrieves the cached book value message to be modified from the PubSub+ Cache Instance.</li>
      <li>Uses OpenMAMDA functions to add the new values provided by the received book update message to the cached book value.</li>
      <li>Instructs the PubSub+ Cache Instance to cache the modified book value message.</li>
    </ol>
    <p class="Note">When a book update is received for a topic for which there is no cached initial message, the update message is discarded and an error is logged.</p>
    <h2 class="with-rule"><a name="DELETE"/>SOLCACHE_MSG_TYPE_DELETE</h2>
    <p>When a delete message is received, the Plug-In instructs the PubSub+ Cache Instance to delete the cache entry for the given topic and discards the message.</p>
    <p>Delete messages are typically received for non-book data, but they can also be received for book or dictionary data.</p>
    <h2 class="with-rule"><a name="DISCARD"/>SOLCACHE_MSG_TYPE_DISCARD</h2>
    <p>If an OpenMAMA message is converted to the <code>SOLCACHE_MSG_TYPE_DISCARD</code> type, then this message is explicitly not applicable to Solace PubSub+ or it is identified an OpenMAMA internal message.</p>
    <p>The Plug-In will instruct the PubSub+ Cache Instance to discard this type of message, and it will generate a PubSub+ Cache DEBUG level log entry for it.</p>
  </body>
</html>

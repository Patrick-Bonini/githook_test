<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Creating Durable Topic Subscribers</h1>
    <p><code>TopicSubscriber</code>, a subinterface of <code>MessageConsumer</code>, is a publish and subscribe form of a message consumer.</p>
    <p>A client can use a durable <code>TopicSubscriber</code> object to receive messages that have been published to a Topic destination. Even if that client is not connected, the durable topic subscriber ensures that the messages are maintained by the JMS broker until they are acknowledged by the consuming durable topic subscriber or until they expire.</p>
    <p class="Note" MadCap:autonum="&lt;b&gt;Note: Â &lt;/b&gt;">To create a durable topic subscription and a durable topic subscriber on an event broker it must have Guaranteed Messaging and message spooling enabled, and, if using an appliance, an ADB must be installed.</p>
    <p>To create a durable topic subscriber, call the following method from a Session:</p>
    <p class="Code">
      <code>session.createDurableSubscriber(Topic topic, java.lang.String name, java.lang.String messageSelector, boolean noLocal)</code>
    </p>
    <p><u>Where</u>:</p>
    <p><code>topic</code> is the topic to subscribe to. For information on the supported Topic syntax rules, refer to <MadCap:xref MadCap:unresolvedLink="import-link:a_topic_support_and_syntax_819845554_56063" href="../../Messaging/Topic-Support-and-Syntax.htm">Topic Support and Syntax</MadCap:xref>.</p>
    <p><code>name</code> is a name to identify the durable topic subscriber. The name can be up to 200 characters (the only invalid characters are '&lt;&gt;*?&amp;;). Each durable topic subscriber in a MessageVPN must be unique. Durable  topic subscriber names used by the JNDI provider are the equivalent of durable topic endpoints that can also be created through SolAdmin or the Solace CLI (refer to <MadCap:xref MadCap:unresolvedLink="import-link:managing_solace_jndi_objects_75995180_92633" href="Managing-Solace-JNDI-Objects.htm">Managing Solace JNDI Objects</MadCap:xref>).</p>
    <p><code>messageSelector</code> is a message selector expression. Only messages with matching header fields and properties are delivered. A value of <code>null</code> or an empty string means that there is no message selector.</p>
    <p><code>noLocal</code> is an attribute that specifies whether the subscriber can receive messages that match its subscription if they were published on the same connection. (In other words, whether a client is allowed to consume messages it has published itself when they match its Topic subscription.) To prevent the delivery of messages on the same connection that they are published on, enable the <code>NoLocal</code> attribute for the subscriber (the default value is <code>false</code>).</p>
    <p>To create a durable topic subscriber, a topic subscription (that is, a durable topic endpoint) must be provisioned on the event broker. This durable topic subscription serves to attract messages published to the topic. Only one Session at a time can use a topic subscriber for a particular durable subscription. </p>
    <p>If the topic subscription has already been provisioned on the event broker (through SolAdmin or the CLI), when you call the <code>createDurableSubscriber(...)</code> method and pass in the name of the physical subscription, an instance of that subscription (that is, an in-memory representation of the subscription in the API) is created.</p>
    <p>If a durable topic subscription is not already provisioned on the event broker, when you call the <code>createDurableSubscriber(...)</code> method and pass in a subscription name, a durable topic subscription is created on the event broker if the creation of dynamic durable endpoints is permitted. (If the creation of dynamic durable endpoints is not permitted, a <code>JMSException</code> is thrown.)</p>
    <p>To allow the creation of dynamic durable endpoints, you can set the <code>InitialContext</code> environment property <code>SupportedProperty.SOLACE_JMS_DYNAMIC_DURABLES</code> to <code>true</code>. You can also use SolAdmin or the CLI to enable the equivalent Connection Factory property in the JNDI.</p>
  </body>
</html>

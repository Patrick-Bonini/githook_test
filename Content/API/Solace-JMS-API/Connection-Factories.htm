<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1>Connection Factories</h1>
    <p>A client must use a <code>SolConnectionFactory</code> object to create a JMS connection to the Solace PubSub+ event broker that acts as the JMS broker. A JMS connection establishes a data channel between the event broker and the JMS application. A Connection Factory provides a number of configuration parameters to customize the connection between the JMS client and the event broker.</p>
    <p>A <code>SolXAConnectionFactory</code> object can also be used to create a JMS connection to the event broker that acts as the JMS broker. A <code>SolXAConnectionFactory</code> is a specialized Connection Factory that allows the JMS application to create XA transactions that can be included in distributed transactions. A <code>SolXAConnectionFactory</code> inherits attributes from <code>SolConnectionFactory</code>. However, <code>SolXAConnectionFactory</code> differs in that the <code>xa</code> messaging property is enabled to allow JMS connections created by the XA Connection Factory to support XA Sessions and the <code>direct‑transport</code> transport property is disabled to allow only Guaranteed messages (that is, non-persistent and persistent messages) to be published or received, which is required for local or XA transactions.</p>
    <p class="Note">Throughout this section, the information provided for a Connection Factory also pertains to an XA Connection Factory. However, for information on how to work with XA transactions once an XA connection to the event broker is connected, refer to <MadCap:xref href="Using-XA-Transactions.htm">Using XA Transactions</MadCap:xref>.</p>
    <p>Before creating a connection with a Connection Factory object, the Connection Factory properties should be modified, as required, because the data channel is established according to the Connection Factory’s configuration parameters. Any Connection Factory property that is not explicitly set will use the default values.</p>
    <p>Once a <code>SolConnectionFactory</code> object has been successfully created or looked up (refer to <MadCap:xref href="Obtaining-Connection-Fac.htm">Obtaining Connection Factories</MadCap:xref>), and the Connection Factory properties are modified, as necessary, a client can use it to create a JMS connection (refer to <MadCap:xref href="Creating-JMS-Connections.htm">Creating JMS Connections</MadCap:xref>).</p>
    <h2 class="with-rule"><a name="establishing_connections_577400906_333932"/>Property Prioritizing and Inheritance</h2>
    <p>JMS properties can often be set through a number of sources (for example, the Initial Context, System, JNDI properties file, JNDI Connection Factory), and the property values are prioritized depending on their source. For example, <code>Username</code> can be set as a system property (highest priority), through the JNDI properties file (lesser priority), or within the provided URL (least priority).</p>
    <p>This prioritizing means that the values used for some of the JMS properties at a high level, such as the Initial Context or Java System level, are inherited at a lower level, such as the Connection Factory level.</p>
    <p>However, it is also possible, in some cases, to override those inherited properties. For example, when using Basic client authentication, the username and password set for the Initial Context and used for the JNDI connection are inherited from the JMS data connection. However, these properties can be overridden by a username and password provided in the Connection Factory.</p>
    <p>For information on where each property can be specified, and the priority that is given to a property according to where it is specified, refer to <MadCap:xref href="JMS-Properties-Reference.htm">JMS Properties Reference</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="establishing_connections_577400906_333806"/>Important Connection Properties</h2>
    <p>For a JMS client to establish a JNDI connection to the JNDI store (either on an event broker or an LDAP server) and a JMS connection to an event broker, the following properties must be set before the Connection Factory is obtained.</p>
    <ul>
      <li>
        <u>URL</u>
        <p>This provides the IP address or hostname of the event broker or LDAP server that contains the JNDI store clients must use to perform JNDI lookups. Up to four potential hosts in order of preference can be specified in a comma‑separated list. Listing more than one host allows a client to attempt to connect or reconnect to alternate hosts if some are unavailable. The listed hosts may be in separate geographic locations. </p>
        <p class="Note">If you are programmatically creating Connection Factories or looking up Connection Factories for LDAP JNDI stores, the values that would typically be set for the URL property must be set in the <code><MadCap:xref href="Data-Connection-Properti.htm#Host">Host</MadCap:xref></code> Connection Factory property. In these cases, the values set for the <code>Host</code> property will override the values that implicitly set through the <code>URL</code> property used for the JNDI connection.</p>
        <p><code>URL</code> can also provide a port number to use to establish the connection. A specific port number is only required when the client needs to use a port other than the automatically‑assigned default port. The default port number for plain-text transport is 55555. Port 55003 for plain-text compressed transport. The default port number for transport Layer Security (TLS)/ Secure Sockets Layer (SSL)‑encrypted connections is 55443 (note that compression is not available when TLS/SSL is used).</p>
        <p>Optionally, a username and password can also be specified in the <code>URL</code> property.</p>
        <p>In the case where both the JNDI connection and the JMS connection are made to a single event broker that acts as the JNDI store and JMS broker, the value provided for the <code>URL</code> property is used for both connections. However, when the JNDI store resides on an LDAP server, and the event broker is only to be used as the JMS broker, the IP address and port for the event broker must be set through the Host property in the Connection Factory that is used. The Host property must also include the JMS uniform resource identifier (URI) scheme, which indicates whether the JMS connection should use plain-text over SMF or TLS/ SSL protocols over SMF for secure communications between the application and the event broker.</p>
        <div class="Note">
          <p>When using a Kerberos authentication scheme, you should consider the following:</p>
          <ul>
            <li>When using a Kerberos authentication scheme in a Windows environment, a fully‑qualified domain name (FQDN) should be used for the host parameter, and it must match the Kerberos Service Principal Name (SPN)   the event broker uses.</li>
            <li>When a SPN is generated for the client, the following format is used: <code>service_name/&lt;customer-provided_host&gt;@REALM</code>. The service name portion is configured through the <code>SupportedProperty.<br/>SOLACE_JMS_KRB_SERVICE_NAME</code> JNDI or data connection property (by default, it is <code>solace</code>), and the realm portion is determined by the configuration files used by the KRB library. An example of a resulting service principle name is <code>solace/dev212@SIMPLESPNEXAMPLE.COM</code>. For more information, refer to <MadCap:xref href="JNDI-Connection-Properti.htm">Initial Context Property</MadCap:xref> or <MadCap:xref href="Data-Connection-Properti.htm">Data Connection Properties</MadCap:xref>.</li>
            <li>When using multiple hosts, the SPN is generated from the host being used for the current connection.</li>
          </ul>
        </div>
      </li>
      <li>
        <u>Authentication Scheme</u>
        <p>The authentication scheme specifies the credentials that a client will use to authenticate its connection to the event broker. The authentication scheme can be one of the following:</p>
        <ul>
          <li>basic authentication—The default client authentication scheme. This scheme allows a client to authenticate with an event broker using a valid client username and password. Refer to <MadCap:xref href="#establishing_connections_577400906_338667">Basic Authentication</MadCap:xref>.</li>
          <li>client certificate authentication—This scheme that allows a client to authenticate with an event broker through a client certificate. This authentication scheme also requires the client to use a secure connection. Refer to <MadCap:xref href="#establishing_connections_577400906_338010">Client Certificate Authentication</MadCap:xref>.</li>
          <li>Kerberos authentication—This scheme allows a client to authenticate with an event broker through Kerberos ticket. Refer to <MadCap:xref href="#establishing_connections_577400906_343102">Kerberos Authentication</MadCap:xref>.</li>
          <li>OAuth authentication - This scheme allows a client to authenticate with an event broker though access tokens issued by an authorization server. Refer to <MadCap:xref href="#oauth-authentication">OAuth Authentication</MadCap:xref>. </li>
        </ul>
        <p>All of these client authentication schemes require specific input to successfully authenticate a client. For more information, refer to <MadCap:xref href="#establishing_connections_577400906_337925">Defining Client Authentication Information</MadCap:xref>. </p>
        <p>When an event broker initially accepts a JNDI and/or JMS connection from a client, the resulting connection is in an unauthenticated state. Consequently, the event broker cannot process any requests from the client until the connection is authenticated.</p>
      </li>
    </ul>
    <ul>
      <li>
        <u>Message VPN</u>
        <p>The Message VPN to assign the connecting client to. Event brokers use Message VPNs to isolate the messaging space that clients can access. For example, messages that are published and received by clients in one Message VPN are isolated from those published and received by clients using different Message VPNs, and the messaging capabilities offered to the clients in on Message VPN may differ from those provided in another Message VPNs. Message VPNs are provisioned on the event broker through the CLI or SolAdmin. For information on configuring Message VPNs, refer to <MadCap:xref MadCap:unresolvedLink="import-link:managing_message_vpns_2096211297_92633" href="../../Features/VPN/Managing-Message-VPNs.htm">Message VPNs</MadCap:xref>.</p>
        <p>When the Message VPN is provided through the Java command line, environment properties, or JNDI properties file, the password is set as the <code>SOLACE_JMS_VPN</code> property. If no Message VPN is specified, the Message VPN named <code>default</code> is used. The <code>default</code> Message VPN is always present on an event broker. Although a network administrator can change the configuration settings for <code>default</code>, it cannot be deleted.</p>
        <div class="Note">
          <p> On a multi-homed client machine, it is strongly recommended that you provide the IP address of the interface to use on the machine hosting the client application through the <code>JMS_Solace_localhost</code> Java system variable. When running Java, you can provide the IP address through the command line (for example, <code>-DJMS_Solace_localhost="192.168.1.1"</code>).<br/>If you do not provide the IP address of the interface you intend to use, the API could select an interface that cannot provide a route to the event broker.</p>
        </div>
      </li>
      <li>
        <a name="secure-connections"/>
        <u>Secure Connections</u>
        <p>By default, the data exchanged between a JMS client and the Solace JNDI store through the JNDI connection, as well as the data exchanged between a JMS client and the JMS broker (the event broker) through the JMS connection is transmitted as plain text. However, it is also possible to establish secure connections that use TLS/SSL protocols to encrypt the data.</p>
        <p>To use secure JNDI and JMS connections, you must configure the following TLS/SSL‑specific connection properties:</p>
        <ul>
          <li>SSL Cipher Suite</li>
          <li>SSL Certificate Date Validation</li>
          <li>SSL Certificate Validation</li>
          <li>SSL Protocol</li>
          <li>SSL Trust Store</li>
          <li>SSL Trust Store Format</li>
          <li>SSL Trust Store Password</li>
          <li>SSL Trusted Common Name List
                </li>
        </ul>
        <p>For details on these properties, refer to <MadCap:xref href="JNDI-Connection-Properti.htm">JNDI Connection Properties</MadCap:xref> and <MadCap:xref href="Data-Connection-Properti.htm">Data Connection Properties</MadCap:xref>. 
                </p>
        <p>In addition, the event broker that you want to create a secure connection to must be properly configured for TLS/ SSL service, and the appropriate server certificate must be in place. For information on configuring an event broker to allow for secure connections, refer to <MadCap:xref MadCap:unresolvedLink="import-link:managing_tls_ssl_service_796577956_15157" href="../../Security/Managing-TLS-SSL-Service.htm">TLS/SSL Service</MadCap:xref>.</p>
        <h4>Related Samples</h4>
        <p>For an example of how to create and connect secure Sessions, refer to the <code>SolJMSSecureSession.java</code> sample. </p>
      </li>
    </ul>
    <h2 class="with-rule"><a name="establishing_connections_577400906_337925"/>Defining Client Authentication Information</h2>
    <p>The authentication scheme property specifies the type of credentials required to authenticate a client connection to the event broker.</p>
    <p>One of the following types of client authentication can be used to authenticate a client connection:</p>
    <ul>
      <li>
        <MadCap:xref href="#establishing_connections_577400906_338667">Basic Authentication</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#establishing_connections_577400906_338010">Client Certificate Authentication</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#establishing_connections_577400906_343102">Kerberos Authentication</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#oauth-authentication">OAuth Authentication</MadCap:xref>
      </li>
    </ul>
    <p>To set the authentication scheme to use for both the JNDI and JMS connections specify <code>SupportedProperty.AUTHENTICATION_SCHEME_BASIC</code>, <code>SupportedProperty.AUTHENTICATION_SCHEME_CLIENT_CERTIFICATE</code>, or <code>SupportedProperty.AUTHENTICATION_SCHEME_KRB</code> as an environment property provided for the Initial Context constructor. By default, basic client authentication is used for both the JNDI and JMS connections.</p>
    <p class="Note">It is also possible for a client application to set the authentication scheme for a data connection when the Connection Factory is programmatically-created (refer to <MadCap:xref href="Obtaining-Connection-Fac.htm#establishing_connections_577400906_326490">Programmatically Creating Connection Factories</MadCap:xref>).</p>
    <h3><a name="establishing_connections_577400906_338667"/>Basic Authentication</h3>
    <p>Basic authentication is the default client authentication scheme; it allows a client to authenticate with an event broker in an unsecured method. When this scheme is used, the client must provide the following properties for the event broker to authenticate the client (these properties are not encrypted):</p>
    <ul>
      <li>
        <MadCap:xref href="#establishing_connections_577400906_337983">Client ID</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#establishing_connections_577400906_337994">Username</MadCap:xref>
      </li>
      <li><MadCap:xref href="#establishing_connections_577400906_338005">Password</MadCap:xref> (this is optional)</li>
    </ul>
    <h4><a name="establishing_connections_577400906_337983"/>Client ID</h4>
    <p>To establish a JNDI and/or JMS data connection to an event broker, a unique client ID is required during client login to register that client with the event broker. If no client ID is entered, the API automatically generates a unique client ID. By default, this parameter is not specified.</p>
    <p class="Note">The client ID property is the same as the <code>client</code> property that can be shown through the Solace CLI or SolAdmin.</p>
    <p>For information on how to set a specific client ID, refer to <MadCap:xref href="JMS-Properties-Reference.htm">JMS Properties Reference</MadCap:xref>.</p>
    <h4><a name="establishing_connections_577400906_337994"/>Username</h4>
    <p>A username is required for a Session to authenticate a client connecting to an event broker. The username that the JMS client provides must match with a client username account provisioned on the event broker through the Solace CLI (refer to <MadCap:xref href="../../Security/Configuring-Client-Authentication.htm">Managing Client Authentication and Authorization</MadCap:xref>) or through SolAdmin.</p>
    <p class="Note">The username property is the same as the <code>client-username</code> property that can be shown through the Solace CLI or SolAdmin.</p>
    <p>When a username is provided through the Java command line, environment properties, or JNDI properties file, the username is set as the <code>SECURITY_PRINCIPAL</code> property. A username can also be provided specifically for the JMS connection through the Connection Factory or the <code>createConnection(...)</code> method.</p>
    <h4><a name="establishing_connections_577400906_338005"/>Password</h4>
    <p>When password authentication is enabled on the event broker, a valid username/password pair must be provided. By default, no password is required.</p>
    <p>When provided through the Java command line, environment properties, or JNDI properties file, the username is set as <code>SECURITY_CREDENTIALS</code> property. </p>
    <p>The provided password must match the password provisioned for the client username on the event broker.</p>
    <h3><a name="establishing_connections_577400906_338010"/>Client Certificate Authentication</h3>
    <p>Client certificate authentication is a secure client authentication scheme that allows a client to prove its identity to the event broker through a valid X509v3 client certificate obtained from a trusted Certification Authority (CA).</p>
    <p>Client certificate authentication depends on the TLS/SSL facility on the event broker, so it can only be used for secure Sessions (refer to <a class="link-internal" href="#secure-connections">Secure Connections</a>).</p>
    <p>When a client certificate authentication is used for a connection, the client must provide a keystore file. The keystore is a single file that contains the client’s certificate, private key, and the CA certificate chain.</p>
    <p>A password for the keystore is required. A private key password must also be specified when the private key is encrypted, and the password is not the same as the keystore password. If a private key password is not specified, it is assumed that the private key has the same password as the keystore.</p>
    <table class="TableStyle-Table_Num" style="mc-table-style: url('../../Resources/TableStyles/Table_Num.css');width: 95%;margin-left: 0;margin-right: auto;caption-side: top;" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption"> Client Certificate Authentication Properties</p>
      </caption>
      <col width="25%" class="TableStyle-Table_Num-Column-Column1"/>
      <col width="75%" class="TableStyle-Table_Num-Column-Column1"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Property </th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">SSL Key Store</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">The keystore file to use in URL or path format. </p>
            <p class="Tbl_Body">This property is set through Initial Context environment or as a system property.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">SSL Key Store Password</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">The password required to verify the integrity of the contents of the keystore. This property is required when the private key is encrypted with a different key than the password used to encrypt the keystore. </p>
            <p class="Tbl_Body">This property is set through Initial Context environment or as a system property.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">SSL Key Store Format</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">The format of the keystore (either JKS or PKCS12). The default value is JKS.</p>
            <p class="Tbl_Body">This property is set through Initial Context environment or as a system property.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p class="Tbl_Body">SSL Private Key Alias</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p class="Tbl_Body">The alias of the private key to use for client authentication. If there is only one private key entry in the given keystore then this property does not have to be set. </p>
            <p class="Tbl_Body">This property is set through Initial Context environment.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">SSL Private Key Password</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p class="Tbl_Body">The password that decrypts the private key. For the JMS API, the private key is in the keystore, and this property is required when the private key is encrypted with a different key than the password used to encrypt the keystore.</p>
            <p class="Tbl_Body">This property is set through Initial Context environment.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p>If a specified keystore cannot be loaded (for example, an incorrect file format is used), the connection is not attempted, and an error is reported to the application.</p>
    <p>
      <b>Required Event Broker Configurations</b>
    </p>
    <p>For a client to use a client certificate authentication scheme, the host event broker must be properly configured for TLS/SSL connections, and client certificate authentication must be enabled for the Message VPN that the client is connecting to. The Message VPN to which the client connects can be configured to use the common name, subject alternative name, user identifier, or certificate thumbprint from the client certificate as the client username,  or a client username that the client provides (refer to <MadCap:xref href="#establishing_connections_577400906_337994">Username</MadCap:xref>). Assigning the client username based on the common name in the client certificate is the default behavior.</p>
    <p>
      <b>Related Samples</b>
    </p>
    <p>For an example of how to use client certificate authentication, refer to the <code>SolJMSSecureSession.java</code> sample.</p>
    <h3><a name="establishing_connections_577400906_343102"/>Kerberos Authentication</h3>
    <p>The Kerberos authentication scheme allows a client to use the GSSAPI Kerberos mechanism to authenticate its connection with the event broker. Kerberos authentication requires the client to present a valid ticket obtained through an approved Ticket Granting Service (TGS).</p>
    <p>Kerberos authentication can be used to authenticate clients for either secured or unsecured Sessions to the event broker. Unlike client certificate authentication, Kerberos authentication does not depend on the TLS/SSL facility on the event broker.</p>
    <p>To use the Kerberos authentication scheme, the following configurations are required for the JMS API:</p>
    <ol>
      <li>Java distribution <MadCap:variable name="Minimum-Supported-Component-Versions.Java Distribution"/> or greater must be used. By default, the Kerberos libraries provided by the JVM are used. However, you can also configure other Kerberos libraries to be used if these are required (for example, if they are mandated by corporate policies). For more information on configuring other Kerberos libraries, refer to <MadCap:xref href="Code-and-Compile-Guideli.htm#quick_start_1575591813_209149">Secure Connections and Authentication</MadCap:xref>.</li>
      <li>Set Kerberos as the authentication scheme to use for the Session (refer to <MadCap:xref href="#establishing_connections_577400906_337925">Defining Client Authentication Information</MadCap:xref>).</li>
      <li>Enable Kerberos authentication for the JMS API. To do so, use the following system property to specify a valid Java Authentication and Authorization Service (JAAS) configuration file:
           <p class="Code">-Djava.security.auth.login.config=jaas.conf</p><p>Sample contents of <code>jaas.conf</code>:</p><p class="Code">SolaceGSS {<br/>   com.sun.security.auth.module.Krb5LoginModule required<br/>   useTicketCache=true<br/>   isInitiator=true<br/>   doNotPrompt=true<br/>   debug=false;<br/>};</p></li>
    </ol>
    <h4>Required Event Broker Configurations</h4>
    <p>For a client to use a Kerberos authentication scheme, a Kerberos key tab file must be configured for the host event broker and Kerberos authentication must be configured and enabled for any Message VPNs that a client will connect to. Refer to <MadCap:xref MadCap:unresolvedLink="import-link:managing_cli_user_authentication_and_authorization_1105770511_49686" href="../../Security/Configuring-Client-Authentication.htm#Config-Kerberos">Kerberos Authentication</MadCap:xref>.</p>
    <h3><a name="oauth-authentication"/>OAuth 2.0</h3>
    <p>OAuth 2.0  is commonly used as a way for users to grant websites or applications access to their information on other websites without giving them access to sensitive credentials. The OAuth 2.0 authentication scheme allows access through the use of tokens issued to third-party clients by an authorization server which provides access to Message VPNs on <MadCap:variable name="Product-Names.pubsub_brand_only"/> event brokers. For more information, see <MadCap:xref href="../../Security/Configuring-Client-Authentication.htm#OAuth">OAuth Authentication</MadCap:xref>.</p>
    <p>The Solace JMS API supports the following fields that can be sent to the broker using these extensions:</p>
    <ul>
      <li>
        <p>
          <code>SOLACE_JMS_OAUTH2_ACCESS_TOKEN</code>
        </p>
        <p>
          <b>and/or</b>
          <code>SOLACE_JMS_OIDC_ID_TOKEN</code>
        </p>
      </li>
      <li>
        <p>
          <code>SOLACE_JMS_OAUTH2_ISSUER_IDENTIFIER</code>
        </p>
      </li>
    </ul>
    <p>For more information about the JMS API extensions, see <MadCap:xref href="Extensions-to-Standard-JMS.htm">Extensions to Standard JMS API</MadCap:xref>.</p>
    <p>OAuth 2.0 authentication in the JMS API requires a <code>SOLACE_JMS_OAUTH2_ACCESS_TOKEN</code>, a <code>SOLACE_JMS_OIDC_ID_TOKEN</code>, or both. Here's an example:</p>
    <pre xml:space="preserve">
/* Configure service access to use a Open ID connect authentication with an access token, an ID token and an optional issuer identifier. */
Hashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;(); 
env.put(InitialContext.INITIAL_CONTEXT_FACTORY, SOLJMS_INITIAL_CONTEXT_FACTORY);
env.put(InitialContext.PROVIDER_URL, jndiProviderURL);
env.put(SupportedProperty.SOLACE_JMS_AUTHENTICATION_SCHEME, SupportedProperty.AUTHENTICATION_SCHEME_OAUTH2);
env.put(SupportedProperty.SOLACE_JMS_OAUTH2_ACCESS_TOKEN, myAccessToken);             
env.put(SupportedProperty.SOLACE_JMS_OIDC_ID_TOKEN, myOIDCToken);                     
env.put(SupportedProperty.SOLACE_JMS_OAUTH2_ISSUER_IDENTIFIER, issuerIdentifierURL);  
					
final InitialContext  initialContext = new InitialContext(env); // Create InitialContext.					
final ConnectionFactory cf = (ConnectionFactory)initialContext.lookup(CONNECTION_FACTORY_JNDI_NAME); // Lookup ConnectionFactory.					
return cf.createConnection(); // Create and return connection.	</pre>
    <h2 class="with-rule"><a name="establishing_connections_577400906_368626"/>Authorizing Clients</h2>
    <p>After a connecting client is authenticated with an event broker, access to event broker resources and messaging capabilities must be authorized for the client.</p>
    <p>For a client to be authorized, it must provide the host event broker with a client username that matches one that is provisioned on the Message VPN to which the connection has been made. If there is a match, the client’s connection is authorized, and the Access Control List (ACL) profile and client profile that are assigned to the provisioned client username are then used to provide the client with its access permissions and messaging capabilities.</p>
    <p>ACLs define whether the client is permitted to connect to the Message VPN, and, if it is, permissions are assigned to the client that set whether it can publish messages to topics, whether it can subscribe to topics, and whether those publish and subscribe rights are limited to a specific topics.</p>
    <p>Client profiles contain a set of common configuration parameters that can be applied to groups of clients, which allows consistent configurations to be readily defined for many clients. Some of the configurations covered by client profiles includes the maximum number of subscriptions client may use and whether clients may use message eliding, publish and/or receive messages using Guaranteed transport, create endpoints, and so on.</p>
    <p>
      <b>Required Event Broker Configurations</b>
    </p>
    <p>For more information on the client configuration parameters that are controlled by ACL profiles and client profiles that are provisioned on event brokers, refer to <MadCap:xref href="../../Security/Configuring-Client-Authorization.htm">Configuring Client Authorization</MadCap:xref>.</p>
  </body>
</html>

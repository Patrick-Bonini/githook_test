<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Configuring Message VPNs</h1>
    <p>To create a Message VPN, enter the following CONFIG command:</p>
    <pre>solace(configure)# create message-vpn &lt;vpn-name&gt;</pre>
    <p>To edit the properties of an existing Message VPN, enter the following CONFIG command:</p>
    <pre>solace(configure)# message-vpn &lt;vpn-name&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;vpn-name&gt;</code> is the name of the Message VPN to be created or edited. The Message VPN name must be unique among all created Message VPNs on the event broker. Message VPN names can contain any characters, except the asterisk (*) or question mark (?). </p>
    <p>The no version of this command, <code>no message-vpn &lt;vpn-name&gt;</code>, deletes the specified Message VPN from the event broker (the Message VPN named <code>default</code>, however, cannot be deleted). Before deleting a Message VPN:</p>
    <ul>
      <li>It must be disabled through the <code>shutdown</code> VPN CONFIG command.</li>
      <li>No other configured objects can refer to it.</li>
    </ul>
    <div class="Note">
      <ul>
        <li>When a Message VPN is created, it is not automatically enabled. For information, see <MadCap:xref href="#Stop-VPNs">Stopping/Starting Message VPNs</MadCap:xref>.</li>
        <li>
                    The maximum number of Message VPNs that can be configured depends on the type of Solace PubSub+ event broker used. For example, the number of Message VPNs you can provision on a software event broker differs from the number that you can provision on an appliance. Additionally, a Solace PubSub+ 3560 with high-performance NABs and ADBs may support even more Message VPNs. </li>
      </ul>
    </div>
    <p>You can perform the following tasks for a configured Message VPN:</p>
    <ul>
      <li>
        <MadCap:xref href="#Config-Accepted-Auth-Schemes">Configuring Accepted Client Authentication Schemes</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Config-Bridge-Serv-Cert">Configuring Bridging Server Certification Validation</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Designate-Mgmt-VPNs">Designating Management Message VPNs</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Max-Connections">Configuring Maximum Connections</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Config-Event-Gen">Configuring Message VPN Event Generation</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Config-Replication">Configuring Replication</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#SEMP-MBus">Configuring SEMP Over Message Bus</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Config-Services">Configuring Services</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Configur">Configuring Message VPN Overrides</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Enable-Sub-Export">Enabling Subscription Exporting</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Configur2">Configuring Message VPN Aliasing</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Configur4">Configuring a Forward Proxy</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Stop-VPNs">Stopping/Starting Message VPNs</MadCap:xref>
      </li>
    </ul>
    <h2 class="with-rule"><a name="Config-Accepted-Auth-Schemes"/>Configuring Accepted Client Authentication Schemes</h2>
    <p>See <MadCap:xref href="../../Security/Configuring-Client-Authentication.htm">Managing Client Authentication</MadCap:xref> for details on how to configure client authentication schemes for the given Message VPN.</p>
    <h2 class="with-rule"><a name="Config-Bridge-Serv-Cert"/>Configuring Bridging Server Certification Validation</h2>
    <p>See <MadCap:xref href="../../Security/Configuring-Server-Cert-Validation.htm">Configuring Server Certificate Validation Settings</MadCap:xref> for details on configuring the actions to take on validating server certificates for Message VPN bridges when using Transport Layer Security (TLS)/ Secure Sockets Layer (SSL) authentication.</p>
    <h2 class="with-rule"><a name="Designate-Mgmt-VPNs"/>Designating Management Message VPNs</h2>
    <p>System-level syslog events (as opposed to Message VPN scope events) are always published in a Message VPN that has been designated as the Management Message VPN for the event broker. A Solace PubSub+ event broker can only have one of its enabled Message VPNs configured as the Management Message VPN. (If no Management Message VPN is configured, then system-level syslog events are not published on the event broker.)</p>
    <p>To designate a Message VPN as the Management Message VPN to use for publishing message bus system-level syslog requests and events, enter the following CONFIG command:</p>
    <pre>solace(configure)# management-message-vpn &lt;vpn-name&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;vpn-name&gt;</code> is the name of the Message VPN to be designated as  the Management Message VPN.</p>
    <p>The no version of this command, <code>no management-message-vpn</code>, deletes the management configuration for the Message VPN. </p>
    <div class="Note">
      <ul>
        <li>Message VPN-level events (including client and subscription events) are always published to the message bus in the Message VPN on which the events occurred.</li>
        <li>The Config-Sync facility does not automatically propagate this setting across replication bridges. Therefore, if you are using the event broker in a replicated site, you must manually designate the Management Message VPN on each mate event broker.</li>
      </ul>
    </div>
    <h3>Enabling Logging Events on Management Message VPNs</h3>
    <p>To turn system-level publishing of syslog events to the message bus on or off on the Management Message VPN, enter the following Global CONFIG level command:</p>
    <pre>solace(configure)# logging event</pre>
    <p>The CLI moves to a Logging Event CONFIG level, from which you can do the following:</p>
    <ul>
      <li>To enable system-level publishing of syslog events to the message bus on the Management Message VPN, enter the following CONFIG command:
            <pre>solace(configure/logging/event)# publish-system</pre></li>
      <li>To disable system-level publishing of syslog events to the message bus on the Management Message VPN, enter the following CONFIG command:
            <pre>solace(configure/logging/event)# no publish-system</pre></li>
      <li>To configure a custom identification tag as a prefix for system-level syslog events, enter the <code>system-tag</code> Logging Event CONFIG command:
            <pre>solace(configure/logging/event)# system-tag &lt;tag-string&gt;</pre><p><u>Where</u>:</p><p><code>&lt;tag-string&gt;</code> is the custom identification tag with no spaces, asterisks (*), question marks (?), or single (') or double (") quotes. It can contain up to 32 alphanumeric characters, and must be unique among all system-level identification tags. The default is empty, that is, no custom identification tag.</p><p>The no version of this command, <code>no system-tag</code>, deletes the custom identification tag from system-level syslog events, and sets the tag string back to default.</p></li>
    </ul>
    <h3>Showing Management Message VPN Logging Events</h3>
    <p>To view the current configuration of system-level publishing of syslog events to the message bus on the Management Message VPN, enter the following User EXEC command. </p>
    <pre>solace&gt; show logging event</pre>
    <h2 class="with-rule"><a name="Max-Connections"/>Configuring Maximum Connections</h2>
    <p>To configure the maximum number of clients that are permitted to simultaneously connect to a given Message VPN through all supported services, enter the following CONFIG command:</p>
    <pre>solace(configure/message-vpn)# max-connections &lt;value&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;value&gt;</code> is the integer value specifying the maximum total number of client connections permitted for the Message VPN. This maximum value includes client connections for all supported services. The valid range is from 0 to the maximum total number of clients that can be supported by the type of Solace PubSub+ event broker used.</p>
    <p>The no version of this command, <code>no max-connections</code>, resets the maximum number of client connections that are permitted to simultaneously connect with the given Message VPN back to the default value which is the maximum total number of client connections for all services that the event broker can support.</p>
    <div class="Note">
      <ul>
        <li>To view the maximum total number of client connections that the Solace PubSub+ event broker can support, enter the <code>show service</code> User EXEC command.</li>
        <li>The maximum number of client connections can also be limited on a client profile-basis, see <MadCap:xref href="../../Security/Configuring-Client-Profiles.htm#Config-Max-Connects-Username">Configuring the Max Connections Per Username</MadCap:xref>.</li>
        <li>If you are using the replication facility, and the type of Solace PubSub+ event brokers used at each replication site do not match, you must ensure that the combined maximum number of client connections for all Message VPNs at one replication site does not exceed the combined maximum number of client connections for all Message VPNs at its mate replication site. Consider, for example, a scenario where a Solace PubSub+ 3260 is used at replication Site A and a Solace PubSub+3230 that supports a maximum of 6,000 clients is used as its mate at replication Site B. If the Solace PubSub+ 3260 at Site A uses more than 6,000 client connections, it is possible that the Solace PubSub+ 3230 at Site B will be sent more configuration updates than it can handle. Therefore, when Config‑Sync is enabled for replication sites that used mismatched event brokers, the configured <code>max-connections</code> value for Replicated Message VPNs and the <code>max-connections-per-client-username</code> values for the client profiles used by each event broker at the replication sites must not exceed the maximum value for the event broker with the lowest range.</li>
      </ul>
    </div>
    <h2 class="with-rule"><a name="Max-Subs"/>Configuring Maximum Subscriptions</h2>
    <p>You can configure a limit for the maximum number of unique local subscriptions (across both primary and backup VRIDs) that clients can add to a Message VPN.</p>
    <p>This limit only applies to unique subscriptions. For example, two clients subscribing to the topic "a/b" will only count as one against this limit. Also note that this limit is not affected by remote subscriptions. Therefore, the total number of unique subscriptions could exceed the maximum permitted number of subscriptions if some of them are remote subscriptions, as shown in the following example:</p>
    <pre>solace1&gt; show message-vpn default
Message VPN:                         default
Configuration Status:                Enabled
Local Status:                        Up
Total Local Unique Subscriptions:    6
Total Remote Unique Subscriptions:   5
Total Unique Subscriptions:          11
Maximum Subscriptions:               10</pre>
    <p>To configure the maximum number of local client subscriptions (across both primary and backup VRIDs) that can be added to the specified Message VPN, enter the following VPN CONFIG command:</p>
    <pre>solace(configure/message-vpn)# max-subscriptions &lt;value&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;value&gt;</code> is the integer value specifying the maximum number of local client subscriptions. The valid range is 0 to 4294967295. The default value is 5000000. </p>
    <p>The no version of this command, <code>no max-subscriptions</code>, resets the maximum number of local client subscriptions that can be added to the specified Message VPN back to the default value.</p>
    <h2 class="with-rule"><a name="Config-Event-Gen"/>Configuring Message VPN Event Generation</h2>
    <p>To configure the conditions that cause Message VPN-related events be generated, and control whether some types of events get published onto the message bus, enter the following CONFIG command:</p>
    <pre>solace(configure/message-vpn)# event</pre>
    <p>The CLI is now at the Message VPN Event CONFIG level, from which you can use the CLI to configure the high and low thresholds at which events are generated for the given Message VPN, and enable the publishing of events to the message bus for Message VPNs. For more information, see <MadCap:xref MadCap:unresolvedLink="import-link:configuring_event_output_and_thresholds_3996511907_56763" href="../../Monitoring/Configuring-Client-Event-Output-and-Thresholds.htm">Configuring Event Outputs and Thresholds</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="Config-Replication"/>Configuring Replication</h2>
    <p>By default, the use of the replication feature is not enabled for a Message VPN. To use the replication feature, a replication mate and interface must first be set at the system level, and then replication settings can be configured at the Message VPN level.</p>
    <p>For information on how to configure Solace PubSub+ for replication, see <MadCap:xref href="../DR-Replication/Configuring-Data-Center-Replication.htm">Configuring Replication</MadCap:xref>. For information on the Message VPN-specific replication parameters, see <MadCap:xref href="../DR-Replication/Replication-VPN-Level-Settings.htm">Configuring VPN-Level Replication Settings</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="SEMP-MBus"/>Configuring SEMP Over Message Bus</h2>
    <p>The legacy Solace Element Management Protocol (SEMP) Request Over Message Bus feature can be enabled for a Message VPN so that clients have access to a limited subset of the event broker management commands for that Message VPN.</p>
    <p>For information on using the event broker SEMP Request Over Message Bus service, see <MadCap:xref MadCap:unresolvedLink="import-link:using_semp_to_manage_and_monitor_routers_4217350357_79761" href="../../Admin/SEMP/Using-Legacy-SEMP.htm#Configur">Configuring SEMP Over Message Bus Services</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="Config-Services"/>Configuring Services</h2>
    <p>You can configure the following the following types of service for a Message VPN:</p>
    <ul>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_418337">Configuring SMF Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_438202">Configuring MQTT Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Configur3">Configuring AMQP Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_418998">Configuring REST Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_410465">Configuring Web Transport Service</MadCap:xref>
      </li>
    </ul>
    <h3><a name="managing_message_vpns_884140110_418337"/>Configuring SMF Service</h3>
    <p>To configure the Solace Message Format (SMF) service settings for the given Message VPN, enter the following CONFIG command:</p>
    <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# smf</pre>
    <p>The CLI is now at a configuration mode for SMF service from which you can configure the following SMF service parameters  for the given Message VPN:</p>
    <ul>
      <li>
        <MadCap:xref href="#Max-SMF-Connections">Configuring Max SMF Connections</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Plain-Text">Enabling  Plain Text Over SMF Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#TLS">Enabling TLS/SSL Over SMF Service</MadCap:xref>
      </li>
    </ul>
    <h4><a name="Max-SMF-Connections"/>Configuring Max SMF Connections</h4>
    <p>To configure the maximum number of SMF clients that can be simultaneously connected to the given Message VPN on this event broker, enter the following CONFIG command:</p>
    <pre>solace(configure/message-vpn/service/smf)# max-connections &lt;value&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;value&gt;</code> is the maximum number of simultaneous SMF client connections permitted. The valid range depends on the type of Solace PubSub+ event broker (for example, Solace PubSub+ 3530 or 3560) used. </p>
    <p>The no version of the command, <code>no max-connections</code>, resets the value to the highest value supported by the event broker.</p>
    <p class="Note">To view the maximum total number of Web client connections that the given event broker can support, enter the <code>show service</code> User EXEC command.
        </p>
    <h4><a name="Plain-Text"/>Enabling  Plain Text Over SMF Service</h4>
    <ul>
      <li>To enable plain-text over SMF service for the Message VPN, enter the following CONFIG command:
                <pre>solace(configure/message-vpn/service/smf)# plain-text
solace(...re/message-vpn/service/smf/plaint-text)# no shutdown</pre><p>By default, plain-text over SMF service is enabled for a Message VPN.</p></li>
      <li>To disable plain-text over SMF service for the Message VPN, enter the following CONFIG command:
                <pre>solace(configure/message-vpn/service/smf)# plain-text
solace(...re/message-vpn/service/smf/plain-text)# shutdown</pre></li>
    </ul>
    <h4><a name="TLS"/>Enabling TLS/SSL Over SMF Service</h4>
    <ul>
      <li>To enable TLS/SSL over SMF service for the Message VPN, enter the following CONFIG command:
                <pre>solace(configure/message-vpn/service/smf)# ssl
solace(configure/message-vpn/service/smf/ssl)# no shutdown</pre><p>By default, TLS/SSL over SMF service is enabled for a Message VPN.</p></li>
      <li>To disable TLS/SSL over SMF service for the Message VPN, enter the following command:
                <pre>solace(configure/message-vpn/service/smf)# ssl
solace(configure/message-vpn/service/smf/ssl)# shutdown</pre></li>
    </ul>
    <h3><a name="managing_message_vpns_884140110_438202"/>Configuring MQTT Service</h3>
    <p>To configure the Message Queuing Telemetry Transport (MQTT) service settings for the given Message VPN, enter the following CONFIG commands:</p>
    <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# mqtt</pre>
    <p>The CLI is now at a configuration mode at which you can configure MQTT service parameters. For information, see <MadCap:xref href="../../Services/Managing-MQTT-Messaging.htm#managing_mqtt_messaging_1203392003_440559">Managing MQTT Service</MadCap:xref>.</p>
    <h3><a name="Configur3"/>Configuring AMQP Service</h3>
    <p>To configure the Advanced Message Queuing Protocol (AMQP) service settings for the given Message VPN, enter the following CONFIG commands:</p>
    <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# amqp</pre>
    <p>The CLI is now at a configuration mode at which you can configure AMQP service parameters. For more information, see <MadCap:xref href="../../Services/AMQP-on-VPN-Management.htm">Managing AMQP Service on VPNs</MadCap:xref>. </p>
    <h3><a name="managing_message_vpns_884140110_418998"/>Configuring REST Service</h3>
    <p>To configure the REST service settings for the given Message VPN, enter the following CONFIG command:</p>
    <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# rest</pre>
    <p>The CLI is now at a configuration mode for REST service for the given Message VPN, from which you can configure REST service parameters. For information, see <MadCap:xref href="../../Services/Managing-REST-Service.htm">Managing REST Service</MadCap:xref>.</p>
    <h3><a name="managing_message_vpns_884140110_410465"/>Configuring Web Transport Service</h3>
    <p> You can configure the following Web transport service parameters  for a given Message VPN:</p>
    <ul>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_411272">Configuring Max Web Client Connections</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Enabling">Enabling  Plain Text Over Web Transport Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Enabling2">Enabling SSL Over Web Transport Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Request-Client-Cert">Configuring When to Request a Client Certificate from a Web Client</MadCap:xref>
      </li>
    </ul>
    <h4><a name="managing_message_vpns_884140110_411272"/>Configuring Max Web Client Connections</h4>
    <p>To configure the maximum number of Web clients that can be simultaneously connected to the given Message VPN, enter the following CONFIG commands:</p>
    <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# web-transport
solace(configure/message-vpn/service/web-transport)# max-connections &lt;value&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;value&gt;</code> is the maximum number of simultaneous Web client connections permitted. The valid range depends on the type of Solace PubSub+ event broker used. </p>
    <p>The no version of the command, <code>no max-connections</code>, resets the value to the highest value supported by the event broker.</p>
    <p class="Note">To view the maximum total number of Web client connections that the given event broker can support, enter the <code>show service </code>User EXEC command.
        </p>
    <h4><a name="Enabling"/>Enabling  Plain Text Over Web Transport Service</h4>
    <ul>
      <li>To enable plain-text over Web transport service for the Message VPN, enter the following CONFIG commands:
                <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# web-transport
solace(...ure/message-vpn/service/web-transport)# plain-text
solace(...-vpn/service/web-transport/plain-text)# no shutdown</pre><p>By default, plain-text over Web transport service is enabled for a Message VPN.</p></li>
    </ul>
    <ul>
      <li>To disable plain-text over SMF service for the Message VPN, enter the following commands:
                <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# web-transport
solace(...ure/message-vpn/service/web-transport# plain-text
solace(...-vpn/service/web-transport/plain-text)# shutdown</pre></li>
    </ul>
    <h4><a name="Enabling2"/>Enabling SSL Over Web Transport Service</h4>
    <ul>
      <li>To enable TLS/SSL over Web service for the Message VPN, enter the following CONFIG commands:
                <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# web-transport
solace(...ure/message-vpn/service/web-transport)# ssl
solace(...message-vpn/service/web-transport/ssl)# no shutdown</pre><p>By default, TLS/SSL over SMF service is enabled for a Message VPN.</p></li>
      <li>To disable TLS/SSL over SMF service for the Message VPN, enter the following commands:
                <pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# service
solace(configure/message-vpn/service)# web-transport
solace(...ure/message-vpn/service/web-transport)# ssl
solace(...message-vpn/service/web-transport/ssl)# shutdown</pre></li>
    </ul>
    <h4><a name="Request-Client-Cert"/>Configuring When to Request a Client Certificate from a Web Client</h4>
    <p>By default, PubSub+ event brokers  request client certificates from web clients connecting via a TLS port if client certificate authentication is enabled in a given Message VPN. Because many popular web browsers handle the request for a client certificate poorly, this can result in  clients running in web browsers being unable to connect over the WebSockets secure (WSS) protocol. If you have clients connecting from a web browser using WSS and other clients in the same Message VPN that need to authenticate using client certificates, you may want to prevent the broker from requesting a client certificate from incoming web clients. </p>
    <p>To configure when the broker requests a client certificate from incoming Web clients connecting via a TLS port, enter the following CONFIG commands:</p>
    <pre>solace(configure)# message-vpn &lt;vpn-name&gt;<br/>solace(configure/message-vpn)# service<br/>solace(configure/message-vpn/service)# web-transport<br/>solace(...ure/message-vpn/service/web-transport)# authentication<br/>solace(.../service/web-transport/authentication)# client-certificate<br/>solace(...ort/authentication/client-certificate)# request-client-certificate {always | never | when-enabled-in-message-vpn}<br/></pre>
    <p><u>Where</u>:</p>
    <p><code>always</code> configures the broker to always request a client certificate regardless of whether client certificate authentication is enabled in the Message VPN. For more information, see <MadCap:xref href="../../Security/Configuring-Client-Authentication.htm#managing_client_authentication_and_authorization_21734666_340052">Enabling Client Certificate Authentication For Clients</MadCap:xref>.</p>
    <p><code>never</code> configures the broker to never request a client certificate regardless of whether client certificate authentication is enabled in the Message VPN. This setting is useful if you don't want the broker to request a client certificate from your WebSocket secure clients, but you still want to use client certificate authentication for other types of clients (such as bridges).</p>
    <p><code>when-enabled-in-message-vpn</code> configures the broker to request  a client certificate only if client certificate authentication is enabled in the Message VPN. This is the default setting. </p>
    <p>The no version of command, <code>no request-client-certificate</code>, resets the value to the default. </p>
    <h2 class="with-rule"><a name="Configur"/>Configuring Message VPN Overrides</h2>
    <p>If you are using certificate revocation checking to authenticate clients attempting to connect to a Solace PubSub+ appliance, then you can set overrides for specific Message VPNs. To configure certificate revocation checking, see <MadCap:xref href="../../Security/Managing-Certificate-Authorities.htm">Managing Certificate Authorities</MadCap:xref>.</p>
    <p>To configure the Message VPN overrides, enter the following commands:</p>
    <pre>solace(configure)# message-vpn &lt;name&gt;
solace(configure/message-vpn)# authentication user-class client
solace(...message-vpn/authentication/user-class)# client-certificate
solace(...ication/user-class/client-certificate)# revocation-check-mode [allow-all | allow-unknown | allow-valid]</pre>
    <p><u>Where</u>:</p>
    <p><code>allow-all</code> (default)—Ignore client certificate revocation check results. The revocation checks are still done—all clients attempting to authenticate using certificates are revocation checked—and the results are ignored.
</p>
    <p><code>allow-unknown</code>—Authenticate clients even if the revocation status of their certificates cannot be determined. Note that there are a number of possible conditions that may lead to the revocation status of a certificate to be unknown, see <MadCap:xref href="../../Security/TLS-SSL-Message-Encryption-Overview.htm#Certific2">Certificate Revocation Checking</MadCap:xref>.
</p>
    <p><code>allow-valid</code>—Authenticate clients if the revocation checks return an explicit positive response.
Only clients that present certificates that return a valid response to the revocation check will be authenticated. 
</p>
    <p class="Caution"> Revocation checks are ignored if the default <code>allow-all</code> is not changed; even if all revocation check parameters are correctly configured. The default <code>allow-all</code> mode must be changed to successfully enable revocation checks. </p>
    <h2 class="with-rule"><a name="Enable-Sub-Export"/>Enabling Subscription Export</h2>
    <p>By default, the export policy in a Message VPN is set not to export subscriptions to other Solace PubSub+ event brokers in the network. For messages to be received from other  event brokers, the subscription export policy in Message VPNs must be set to export subscriptions. This causes subscriptions added locally to the Message VPN to be exported to other physical event brokers in the network.</p>
    <p>To enable the export of subscriptions in a Message VPN to other event brokers in the network, on a per-Message VPN basis, enter the following CONFIG command:</p>
    <pre>solace(configure/message-vpn)# export-policy export-subscriptions</pre>
    <p>The no version of this command, <code>no export-subscriptions</code>, disables export of subscriptions in the Message VPN to other event brokers in the network.</p>
    <p class="Note">Set the subscription export policy for a given Message VPN the same for all event brokers in the network.
        </p>
    <h2 class="with-rule"><a name="Configur2"/>Configuring Message VPN Aliasing</h2>
    <p>You can configure a Message VPN to be an alias of another Message VPN. The intent of this  is to help  you to collapse multiple Message VPNs into a single Message VPN without needing to change your existing application code (or at least not requiring all application instances to change at the same time).</p>
    <p class="Caution">Message VPN Aliasing is a Controlled Availability (CA) feature and should only be used under the supervision of Solace support.</p>
    <p>When a Message VPN is configured as an alias of another Message VPN, for example, Message VPN <code>blue</code> is configured as an alias of Message VPN <code>red</code>, the following rules apply:</p>
    <ul>
      <li>Message VPN <code>red</code> has no effect on <code>blue</code> while <code>blue</code> is enabled.</li>
      <li>When <code>blue</code> is disabled, and it is an alias of <code>red</code>:<ul><li>all existing connections to <code>blue</code> are terminated.</li><li>all per-Message VPN  ports of <code>blue</code> are closed.</li><li>all new client connections to <code>blue</code> are treated as if they were connected to <code>red</code> rather than <code>blue</code>, and obey all the configuration settings of <code>red</code>. </li><li>all new bridging and routing connections to <code>blue</code> are treated as if <code>blue</code> were shut down.</li><li>all statistics, events, and behaviors of connected clients occur within <code>red</code> rather than <code>blue</code>.</li></ul></li>
    </ul>
    <p class="Note">Message VPN Aliasing is supported only for SMF client connections. </p>
    <p>Before setting a Message VPN to be an alias, you must ensure that the aliased Message VPN has all appropriate configuration added to it (client usernames, client profiles, authentication settings, bridges, etc.) </p>
    <p>To configure a Message VPN to be an alias of another Message VPN, enter the following commands:</p>
    <pre>solace(configure)# message-vpn &lt;name&gt;
solace(configure/message-vpn)# alias &lt;other-vpn-name&gt;</pre>
    <p>
      <u>Where:</u>
    </p>
    <p><code>&lt;other-vpn-name&gt;</code> is the name of the other Message VPN that this Message VPN is an alias of. </p>
    <h2 class="with-rule"><a name="Configur4"/>Configuring a Forward Proxy</h2>
    <p>Depending on your deployment, you may require that communication between Solace event brokers and endpoint servers (such as external websites) goes through a forward proxy. This is often the case if the event broker sits behind a firewall and REST delivery point (RDP) egress traffic needs to connect to a proxy server to go outside the firewall.</p>
    <p>In this scenario, you can create a forward proxy configuration object on the event broker to direct traffic to the proxy server before it is forwarded to the endpoint server.</p>
    <p>To create a forward proxy  for a Message VPN, enter the following commands:</p>
    <pre xml:space="preserve">solace(configure)# message-vpn &lt;name&gt;
solace(configure/message-vpn)# create proxy &lt;proxy-name&gt;</pre>
    <p>To enable a forward proxy once it has been configured, enter the following command:</p>
    <pre xml:space="preserve">
solace(configure/message-vpn/proxy)# no shutdown</pre>
    <p>
      <u>Where:</u>
    </p>
    <p><code>&lt;proxy-name&gt;</code> specifies the name of the forward proxy configuration object. This name is used in the configuration of other broker objects (for example <a href="../../Services/Managing-RDPs.htm#Proxy">RDPs</a>) to refer to the forward proxy. </p>
    <p class="Note">Forward proxy configuration objects are only synchronized in high-availability (HA) deployments, and not disaster recover (DR) deployments as different sites may need different proxy configurations.  The proxy reference (the reference in the RDP for example) is both HA and replication synchronized, so that once the appropriate proxies are set up on each site, each referencing object doesn’t need any special handling on replicated sites.</p>
    <p>You can configure the following parameters for a forward proxy:</p>
    <ul>
      <li>
        <p>
          <MadCap:xref href="#Authenti">Configuring the Forward Proxy Authentication Scheme</MadCap:xref>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#IP Addre">Configuring the Forward Proxy IP Address or Hostname</MadCap:xref>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#Port">Configuring the Forward Proxy Port</MadCap:xref>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#Proxy">Configuring the Forward Proxy Type</MadCap:xref>
        </p>
      </li>
    </ul>
    <h3><a name="Authenti"/>Configuring the Forward Proxy Authentication Scheme</h3>
    <p>To configure the authentication scheme that the event broker will use to establish a connection to the proxy server, enter the following commands:</p>
    <pre xml:space="preserve">
solace(configure/message-vpn/proxy)# authentication
solace(configure/message-vpn/proxy/authentication)# auth-scheme {none | basic}</pre>
    <p>
      <u>Where:</u>
    </p>
    <p><code>none</code> specifies to login with no authentication. For more information, see <MadCap:xref href="#None">None</MadCap:xref>.</p>
    <p><code>basic</code> specifies to login with a username and password. For more information, see <MadCap:xref href="#Basic">Basic Authentication</MadCap:xref>.</p>
    <h4><a name="None"/>None</h4>
    <p>If no authentication scheme  is configured, the event broker will not use an authentication scheme when connecting to the proxy server. This may be useful for anonymous connections or when a proxy server does not require authentication.</p>
    <h4><a name="Basic"/>Basic Authentication</h4>
    <p>If you configure a basic authentication scheme, the event broker authenticates to the proxy server with a username and password combination.</p>
    <p>To configure settings for an basic authentication scheme, enter the following  commands:</p>
    <pre xml:space="preserve">
solace(configure/message-vpn/proxy)# authentication
solace(configure/message-vpn/proxy/authentication)# basic
solace(configure/message-vpn/proxy/authentication/basic)# username &lt;value&gt;
solace(configure/message-vpn/proxy/authentication/basic)# password &lt;value&gt;</pre>
    <p>
      <u>Where:</u>
    </p>
    <p><code>username &lt;value&gt;</code> is the client username to use for authentication to the proxy server.</p>
    <p><code>password &lt;value&gt;</code> is the password to use with the specified username.</p>
    <h3><a name="IP Addre"/>Configuring the Forward Proxy IP Address or Hostname</h3>
    <p>To configure the IP address or hostname of the proxy server, enter the following commands:</p>
    <pre xml:space="preserve">
solace(configure/message-vpn/proxy)# host &lt;value&gt;
</pre>
    <p>
      <u>Where:</u>
    </p>
    <p><code>&lt;value&gt;</code> specifies the IP address or DNS name to which the event broker will connect. It can contain up to 253 characters.</p>
    <p>The no version of this command, <code>no host</code>, removes any configured value.</p>
    <h3><a name="Port"/>Configuring the Forward Proxy Port</h3>
    <p>To configure the port to connect to on the proxy server, enter the following commands:</p>
    <pre xml:space="preserve">
solace(configure/message-vpn/proxy)# port &lt;value&gt;
</pre>
    <p>
      <u>Where:</u>
    </p>
    <p><code>&lt;value&gt;</code> specifies the port number. The valid range of values is 0 to 65535. The default is 0.</p>
    <p>The no version of this command, <code>no port</code>, resets the value to the default. </p>
    <h3><a name="Proxy"/>Configuring the Forward Proxy Type</h3>
    <p>To configure the forward proxy type, enter the following commands:</p>
    <pre xml:space="preserve">
solace(configure/message-vpn/proxy)# proxy-type {direct | http}
</pre>
    <p>
      <u>Where:</u>
    </p>
    <p><code>direct</code> specifies a direct connection to the endpoint server, in other words no proxy is used. If you configure this proxy type, the only other configuration that has effect is whether the proxy is enabled or not. This is useful when one replication site might need a proxy and another might not, so for the second site you would set the proxy  type to direct. This is the default.</p>
    <p><code>http</code> specifies that the connection from the event broker to the proxy server is HTTP. You can enable TLS/SSL  for event broker objects using the forward proxy (for example RDPs) so that clients can exchange data with the event broker using TLS/SSL over single TCP connections instead of HTTP over TCP. For more information, see <MadCap:xref href="../../Security/Managing-TLS-SSL-Service.htm">TLS/SSL Service</MadCap:xref>. </p>
    <p>The no version of this command, <code>no proxy-type</code>, resets the value to the default. </p>
    <h2 class="with-rule"><a name="Stop-VPNs"/>Stopping/Starting Message VPNs</h2>
    <p> Message VPNs are disabled by default (that is, not running) on Solace PubSub+ event brokers.</p>
    <p class="Caution">The <code>shutdown</code> VPN CONFIG command will disconnect all clients connected to the specified Message VPN, and any new connection requests to that Message VPN are rejected until it's enabled again through the <code>no shutdown</code> VPN CONFIG command.</p>
    <ul>
      <li>To stop a given Message VPN, enter the following CONFIG command:
                <pre>solace(configure/message-vpn)# shutdown</pre></li>
      <li>To start a given Message VPN, enter the following CONFIG command:
                <pre>solace(configure/message-vpn)# no shutdown</pre></li>
    </ul>
  </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>CLI Steps to Set Up VPNs With Client Profiles</h1>
    <p>This example builds on the one provided in <MadCap:xref href="../../Security/Configuring-Client-Usernames.htm#Config-Usernames-Example">Example: Configuring Client Username Accounts</MadCap:xref>.</p>
    <p>Using the two previously created client username accounts <code>pascal blue</code> and <code>pascal red</code> assigned to client profile <code>Sales_Access</code>, this example:</p>
    <ul>
      <li>designates Message VPN <code>blue</code> as the Management Message VPN </li>
      <li>enables the publishing of syslog events to the message bus on both Message VPNs</li>
      <li>configures a custom log identification tag as a prefix for syslog events generated against Message VPN <code>red</code></li>
      <li>activates the Message VPNs <code>blue</code>, <code>red</code>, and <code>default</code> for service</li>
    </ul>
    <ol>
      <li>Designate Message VPN <code>blue</code> as the Management Message VPN through the <code>management-message-vpn</code> CONFIG command, then enable the publishing of some syslog events to the message bus:
        <p class="Code">solace&gt; enable<br/>solace# configure<br/>solace(configure)# management-message-vpn blue<br/>solace(configure)# message-vpn blue<br/>solace(configure/message-vpn)# event<br/>solace(configure/message-vpn/event)# publish-client<br/>solace(configure/message-vpn/event)# publish-message-vpn<br/>solace(configure/message-vpn/event)# publish-subscription<br/>WARNING: Enabling subscription event message publishing can significantly impact subscription add/remove rates.<br/>Do you want to continue (y/n)? y<br/>solace(configure/message-vpn/event)# exit<br/>solace(configure/message-vpn)# exit</p></li>
      <li>Configure and enable syslog event messages on Message VPN <code>red</code>:
        <p class="Code">solace(configure)# message-vpn red<br/>solace(configure/message-vpn)# event<br/>solace(configure/message-vpn/event)# subscriptions thresholds set-value 25000 clear-value 15000<br/>solace(configure/message-vpn/event)# publish-message-vpn</p></li>
      <li>Configure the custom log identification tag “red_apps1” as a prefix for syslog events generated against Message VPN <code>red</code>: 
        <p class="Code">solace(configure/message-vpn/event)# log-tag red_apps1<br/>solace(configure/message-vpn/event)# exit<br/>solace(configure/message-vpn)# exit<br/>solace(configure)#</p></li>
      <li>Enter the show commands for the Message VPNs <code>blue</code> and <code>red</code> to confirm their creation and configuration: 
        <p class="Code">solace(configure)# show message-vpn blue<br/><br/>Message VPN:                       blue [Management Message VPN]<br/>Local Status:                      Down<br/>Distributed Cache Management:      Enabled<br/>Total Local Unique Subscriptions:  0<br/>Total Remote Unique Subscriptions: 0<br/>Total Unique Subscriptions:        0<br/>Maximum Subscriptions:             5000000<br/>Local Connections:                 0<br/>Max Connections:                   9000<br/>  Service SMF:                     9000<br/>  Service Web-Transport:           9000<br/><br/>Basic Authentication:                Enabled<br/>    Auth Type:                       no authentication<br/>    Auth Profile:<br/>    Radius Domain:<br/>Client Certificate Authentication:   Disabled<br/>    Maximum Chain Depth:             3<br/>    Validate Certificate Dates:      Enabled<br/>    Allow API Provided Username:     Disabled<br/>Kerberos Authentication :            Disabled<br/>Allow API Provided Username:         Disabled<br/><br/>SEMP over Message Bus:               Enabled<br/>  Admin commands:                    Enabled<br/>    Client commands:                 Disabled<br/>    Distributed Cache commands:      Disabled<br/>  Show commands:                     Enabled<br/>  Legacy Show Clear commands:        Enabled<br/><br/>Large Message Threshold:             1024 (KB)<br/>Event Log Tag:<br/>Publish Client Event Messages:       Enabled<br/>Publish Message VPN Event Messages:  Enabled<br/>Publish Subscription Event Messages: Enabled<br/>  No unsubscribes on disconnect:     Disabled<br/>  Event topic format:                v1<br/><br/>Event Threshold                           Set Value      Clear Value<br/>---------------------------------- ---------------- ----------------<br/>Connections (#conn)                       80%(7200)        60%(5400)<br/>Service SMF                               80%(7200)        60%(5400)<br/>Service Web-Transport                     80%(7200)        60%(5400)<br/>Ingress Message Rate (msg/sec)              4000000          3000000<br/>Egress Message Rate (msg/sec)               4000000          3000000<br/>Subscriptions (#subs)                   80%(4000000)    60%(3000000)<br/><br/>solace(configure)# show message-vpn red<br/><br/>Message VPN:                       red<br/>Local Status:                      Down<br/>Distributed Cache Management:      Enabled<br/>Total Local Unique Subscriptions:  0<br/>Total Remote Unique Subscriptions: 0<br/>Total Unique Subscriptions:        0<br/>Maximum Subscriptions:             5000000<br/>Local Connections:                 0<br/>Max Connections:                   9000<br/>  Service SMF:                     9000<br/>  Service Web-Transport:           9000<br/>Export Subscriptions:              Yes (100% complete)<br/><br/>Basic Authentication:              Enabled<br/>    Auth Type:                     no authentication<br/>    Auth Profile:<br/>    Radius Domain:<br/>Client Certificate Authentication:   Disabled<br/>    Maximum Chain Depth:             3<br/>    Validate Certificate Dates:      Enabled<br/>    Allow API Provided Username:     Disabled<br/>Kerberos Authentication :            Disabled<br/>  Allow API Provided Username:       Disabled<br/><br/>Large Message Threshold:             1024 (KB)<br/>Event Log Tag:                       red_apps1<br/>Publish Client Event Messages:       Disabled<br/>Publish Message VPN Event Messages:  Enabled<br/>Publish Subscription Event Messages: Disabled<br/>  No unsubscribes on disconnect:     Disabled<br/>  Event topic format:                N/A<br/><br/>Event Threshold                           Set Value      Clear Value<br/>---------------------------------- ---------------- ----------------<br/>Connections (#conn)                       80%(7200)        60%(5400)<br/>    Service SMF                               80%(7200)        60%(5400)<br/>    Service Web-Transport                     80%(7200)        60%(5400)<br/><br/>Ingress Message Rate (msg/sec)                  4000000          3000000<br/>Egress Message Rate (msg/sec)                   4000000          3000000<br/>Subscriptions (#subs)                             25000            15000</p></li>
      <li>Activate the Message VPNs <code>blue</code>, <code>red</code>, and <code>default</code> for service, then use a show command to confirm their activation:
        <p class="Code">solace(configure)# message-vpn blue<br/>solace(configure/message-vpn)# no shutdown<br/>solace(configure/message-vpn)# exit<br/>solace(configure)# message-vpn red<br/>solace(configure/message-vpn)# no shutdown<br/>solace(configure/message-vpn)# exit<br/>solace(configure)# message-vpn default<br/>solace(configure/message-vpn)# no shutdown<br/>solace(configure/message-vpn)# exit<br/>solace(configure)# exit<br/>solace# exit<br/>solace&gt; show message-vpn *<br/><br/>Management Message VPN: blue<br/>Message-VPN                      Local      # Unique Subscriptions  # Local<br/>                                 Status      Local   Remote    Total  Conns<br/>-------------------------------- -------- -------- -------- -------- ------<br/>blue                             Up              2        0        2      1<br/>default                          Up              2        0        2      1<br/>red                              Up              2        0        2      1</p></li>
      <li>Use a show command for client usernames <code>pascal blue</code> and <code>pascal red</code> to confirm the Message VPNs they belong to are enabled:
        <p class="Code">solace&gt; show client-username pascal message-vpn *<br/>   <br/>   Username                        Message VPN               Enabled # Clients<br/>   ------------------------------- ------------------------- ------- ---------<br/>   pascal                          blue                          Yes         0<br/>   pascal                          red                           Yes         0</p></li>
    </ol>
  </body>
</html>

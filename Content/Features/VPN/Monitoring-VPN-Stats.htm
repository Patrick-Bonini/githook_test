<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Monitoring VPN Configurations and Stats</h1>
    <p>To show the configuration and membership of a Message VPN on the event broker, as well as statistics, enter the following command:</p>
    <p class="Code">solace&gt; show message-vpn &lt;vpn-name&gt; {[[detail | stats [detail] | service [stats]] | [subscriptions [primary] [backup] [static]] | proxy &lt;proxy-name&gt; [detail] | replication [stats | detail | client-certificate] | rest [{restdelivery-point &lt;rdp-name&gt; [stats | queue-binding &lt;queue-binding-name&gt;] [count &lt;num-elements&gt;] [detail] | rest-consumer &lt;rest-consumer-name&gt; [rest-delivery-point &lt;rdp-name&gt;] [stats | outgoing-connections [tcp [wide]] | authentication | client-certificate | ssl | detail] [count &lt;num-elements&gt;]}] | authorization [authorization-group &lt;name&gt; [detail]] [count &lt;num-elements&gt;] | mqtt mqtt-session &lt;client-id-pattern&gt; [owner &lt;owner-pattern&gt;] [auto] [primary] [backup] [detail | subscriptions [qos &lt;qos-value&gt;] | stats | client | queue] | bridging}</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;vpn-name&gt;</code> is the full name of the Message VPN, or part of the Message VPN name with the wildcard character ? used to represent one character of the name, or the wildcard character * used to represent zero or more characters of the name, where entering only the wildcard character * for the name displays all Message VPNs.</p>
    <p><code>detail</code> asks to show detailed information on the Message VPN</p>
    <p><code>stats</code> asks to show Message VPN statistics</p>
    <div class="indent"><code>detail</code> asks to show detailed Message VPN statistics</div>
    <p><code>service</code> asks to show SEMP, SMF, MQTT, AMQP, and/or Web Transport services information</p>
    <div class="indent"><code>stats</code> asks to show statistics information on services</div>
    <div class="indent"><code>subscriptions</code> asks to show Message VPN subscription information</div>
    <div class="indent"><code>primary</code> asks to show subscriptions for the primary virtual router, and is the default if no parameter is entered</div>
    <div class="indent"><code>backup</code> asks to show subscriptions for the backup virtual router</div>
    <div class="indent"><code>static</code> asks to show subscriptions for the static virtual router        <p class="Note">In addition to SMF topic subscriptions, the <code>show message-vpn</code> command may also display Message Queuing Telemetry Transport (MQTT) topic subscriptions. Because this command must be able to represent both SMF and MQTT topic syntax, if a topic subscription uses characters with special meaning for the topic syntax it uses (for example, wildcards), those characters may be displayed in the output as escaped characters.</p></div>
    <p><code>proxy &lt;proxy-name&gt;</code> asks to show information  for the given forward proxy</p>
    <div class="indent"><code>detail</code> asks to show detailed information about the forward proxy </div>
    <p><code>replication</code> asks to show replication information for the Message VPN</p>
    <div class="indent"><code>client-certificate</code> asks to show the certificate configured for Message VPN replication</div>
    <div class="indent"><code>stats</code> asks to show statistics information on Message VPN replication</div>
    <div class="indent"><code>detail</code> asks to show detailed information on Message VPN replication</div>
    <p><code>rest</code> asks to show information about Message VPN REST settings</p>
    <div class="indent"><code>rest-delivery-point</code> asks to show information on a specified REST Delivery Point</div>
    <div class="indent"><code>rest-consumer</code> asks to show information on a specified REST consumer</div>
    <div class="indent">
      <div class="indent"><code>detail</code> asks to show display detailed information about the REST Consumer</div>
    </div>
    <p><code>authorization</code> asks to client authorization information</p>
    <div class="indent"><code>authorization-group &lt;name&gt;</code> asks to show information for the given authorization group</div>
    <div class="indent">
      <div class="indent"><code>detail</code> asks to show display detailed information about the given authorization group</div>
    </div>
    <div class="indent"><code>count &lt;num-elements&gt;</code> sets a limit for the maximum number of authorization groups to display information for</div>
    <p><code>mqtt mqtt-session</code> asks to show MQTT session information</p>
    <div class="indent"><code>&lt;client-id-pattern&gt;</code> asks to filter the outputted MQTT session information by the given client ID (a string value)</div>
    <div class="indent"><code>owner</code> &lt;owner-pattern&gt; [string] asks to filter the outputted MQTT session information by an owner of the MQTT session (a string, by default * is used)</div>
    <div class="indent"><code>auto</code>asks to filter the outputted MQTT session information for the auto virtual router</div>
    <div class="indent"><code>primary</code> asks to filter the outputted MQTT session information for the primary virtual router </div>
    <div class="indent"><code>backup</code> asks to filter the outputted MQTT session information for the backup virtual router</div>
    <div class="indent"><code>detail</code> asks to show detailed information on for each MQTT session</div>
    <div class="indent"><code>subscriptions</code> asks to show subscriptions for each MQTT session</div>
    <div class="indent"><code>qos &lt;qos-value&gt;</code> asks to show topic subscriptions that have the given QoS level</div>
    <div class="indent"><code>stats</code> asks to show statistics for each MQTT session</div>
    <div class="indent"><code>client</code> asks to show the client of each MQTT session</div>
    <div class="indent"><code>queue</code> asks to show the queue that belongs to each MQTT session</div>
    <p><code>bridging</code> asks to show information on Message VPN bridge configuration</p>
    <p>The following examples display the <code>show message-vpn</code> command usage for a Solace PubSub+ appliance:</p>
    <ul>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_299122">Example 1—Message VPN Config Info</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_284652">Example 2—Basic VPN Stats</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#managing_message_vpns_884140110_373289">Example 3—Message VPN Replication Stats</MadCap:xref>
      </li>
    </ul>
    <h2 class="with-rule"><a name="managing_message_vpns_884140110_299122"/>Example 1: Message VPN Config Info</h2>
    <div class="Note">
      <p>The possible Message VPN states shown for <code>Local Status</code> are <code>Disabled</code>, <code>Down</code>, <code>Up</code>, or <code>Unconfigured</code>:</p>
      <ul>
        <li><code>Disabled</code> means the Message VPN is not administratively enabled.</li>
        <li><code>Down</code> means the Message VPN is administratively enabled, but external clients are not yet allowed to connect because the internal client of the Message VPN (that is, <code>#client</code>) has not yet connected and loaded the required subscriptions.</li>
        <li><code>Up</code> means the Message VPN is administratively enabled and external clients are allowed to connect.</li>
        <li><code>Unconfigured</code> means the Message VPN has only been learned through multiple-node routing protocols and has not actually been configured on the event broker. Local clients cannot connect to unconfigured Message VPNs, and no per-Message VPN statistics are maintained for them.</li>
      </ul>
    </div>
    <p class="Code">solace&gt; show message-vpn default</p>
    <pre class="Code" xml:space="preserve">
			Message VPN:                         default
			Configuration Status:                Enabled
			Local Status:                        Up
			Distributed Cache Management:        Enabled
			SSL to plain text downgrade allowed: No
			REST mode:                           Messaging
			Total Local Unique Subscriptions:    6
			Total Remote Unique Subscriptions:   0
			Total Unique Subscriptions:          6
			Maximum Subscriptions:               500000
			Configured Maximum Subscriptions:    500000
			Export Subscriptions:                No (100% complete)
			Preferred Ip Version:                ipv6
			Active Incoming Connections:         1
			  Service SMF:                       1
			  Service Web-Transport:             0
			  Service REST:                      0
			  Service MQTT:                      0
			  Service AMQP:                      0
			Active Outgoing Connections:
			  Service REST:                      0
			Max Incoming Connections:            1000
			  Service SMF:                       1000
			  Service Web-Transport:             1000
			  Service REST:                      1000
			  Service MQTT:                      1000
			  Service AMQP:                      1000
			Max Outgoing Connections:
			  Service REST:                      1000
			Basic Authentication :               Enabled
			  Auth Type:                         no authentication
			  Auth Profile:
			  Radius Domain:
			Client Certificate Authentication :  Disabled
			  Maximum Chain Depth:               3
			  Validate Certificate Dates:        Enabled
			  Allow API Provided Username:       Disabled
			  Username Source:                   common-name
			  Revocation Check Mode:             allow-valid
			  Certificate Matching Rules:        Disabled
			Kerberos Authentication :            Disabled
			  Allow API Provided Username:       Disabled
			OAuth Authentication Enabled :       No
			  Default Provider Name:

			SEMP over Message Bus:               Enabled
			  Admin commands:                    Enabled
			    Client commands:                 Enabled
			    Distributed Cache commands:      Enabled
			  Show commands:                     Enabled
			  Legacy Show Clear commands:        Disabled

			Large Message Threshold:             1024 (KB)
			Event Log Tag:
			Publish Topic Format:                SMF
			Publish Client Event Messages:       Disabled
			Publish Message VPN Event Messages:  Disabled
			Publish Subscription Event Messages: Disabled
			  No unsubscribes on disconnect:     Disabled
			  Event topic format:                N/A

			Event Threshold                           Set Value      Clear Value
			---------------------------------- ---------------- ----------------
			Incoming Connections                       80%(800)         60%(600)
			  Service SMF                              80%(800)         60%(600)
			  Service Web-Transport                    80%(800)         60%(600)
			  Service REST                             80%(800)         60%(600)
			  Service MQTT                             80%(800)         60%(600)
			  Service AMQP                             80%(800)         60%(600)
			Ingress Message Rate (msg/sec)              4000000          3000000
			Egress Message Rate (msg/sec)               4000000          3000000
			Subscriptions                           80%(400000)      60%(300000)
		</pre>
    <h2 class="with-rule"><a name="managing_message_vpns_884140110_284652"/>Example 2: Basic VPN Stats</h2>
    <MadCap:snippetBlock src="../../Resources/Snippets/Features/Message-VPN/basic-vpn-stats.flsnp"/>
    <p class="Code">solace&gt; show message-vpn default stats</p>
    <p> </p>
    <pre class="Code" xml:space="preserve">
			Message VPN:                         default
			Configuration Status:                Enabled
			Local Status:                        Up
			Distributed Cache Management:        Enabled
			SSL to plain text downgrade allowed: No
			REST mode:                           Messaging
			Total Local Unique Subscriptions:    6
			Total Remote Unique Subscriptions:   0
			Total Unique Subscriptions:          6
			Maximum Subscriptions:               500000
			Configured Maximum Subscriptions:    500000
			Export Subscriptions:                No (100% complete)
			Preferred Ip Version:                ipv6
			Active Incoming Connections:         1
			  Service SMF:                       1
			  Service Web-Transport:             0
			  Service REST:                      0
			  Service MQTT:                      0
			  Service AMQP:                      0
			Active Outgoing Connections:
			  Service REST:                      0
			Max Incoming Connections:            1000
			  Service SMF:                       1000
			  Service Web-Transport:             1000
			  Service REST:                      1000
			  Service MQTT:                      1000
			  Service AMQP:                      1000
			Max Outgoing Connections:
			  Service REST:                      1000

			Basic Authentication :               Enabled
			  Auth Type:                         no authentication
			  Auth Profile:
			  Radius Domain:
			Client Certificate Authentication :  Disabled
			  Maximum Chain Depth:               3
			  Validate Certificate Dates:        Enabled
			  Allow API Provided Username:       Disabled
			  Username Source:                   common-name
			  Revocation Check Mode:             allow-valid
			  Certificate Matching Rules:        Disabled
			Kerberos Authentication :            Disabled
			Allow API Provided Username:         Disabled
			OAuth Authentication Enabled :       No
			  Default Provider Name:
									Received                    Sent
							    --------------------    --------------------
			Total Client Messages                                 7                        4
			  Client Data Messages                                0                        0
			  Persistent                                          0                        0
			    Non-persistent                                    0                        0
			    Direct                                            0                        0
			    Large Messages                                    0
			    DTO Messages                                      0
			Client Control Messages                               7                        4
			  Login                                               1                        1
			    Certificate Revocation Check                                               0
			      Allowed Valid                                                            0
			      Allowed Revoked                                                          0
			      Allowed Unknown                                                          0
			      Denied Unknown                                                           0
			      Denied Revoked                                                           0
			      Denied Duplicate Clients                                                 0
			      Denied Authorization Failed                                              0
			      Denied Client Connect ACL                                                0
			Update                                               0                         0
			KeepAlive                                            0                         0
			Assured Control                                      0                         0
			Add Subscription Messages
			  Client Adds                                        6                         3
			  Subscription Manager Adds                          0                         0
			  Already Exists                                                               0
			  Not Enough Space                                                             0
			  Max Exceeded                                                                 0
			  Parse Error                                                                  0
			  Denied Subscribe Topic ACL                                                   0
			  Denied Subscribe Topic Reserved                                              0
			  Shared Subscription Permission Denied                                        0
			  Subscription Manager
			    No Permission                                                              0
			    Client Name Not Found                                                      0
			    Shared Subscription Permission Denied                                      0
			Remove Subscription Messages
			  Client Removes                                     0                         0
			  Subscription Manager Removes                       0                         0
			  Not Found                                                                    0
			  Parse Error                                                                  0
			  Denied Unsubscribe Topic ACL                                                 0
			  Subscription Manager
			    No Permission                                                              0
			    Client Name Not Found                                                      0

			Total Client Bytes                                  444                      423
			  Client Data Bytes                                   0                        0
			    Persistent                                        0                        0
			    Non-persistent                                    0                        0
			    Direct                                            0                        0
			Client Control Bytes                                444                      423

			Compressed Bytes                                      0                        0

								Ingress (msg/sec)      Egress (msg/sec)
								--------------------  --------------------
			Current Rate (1 sec sample)                           0                        0
			Avg. Rate (60 sec interval)                           0                        0

								Ingress (bytes/sec)    Egress (bytes/sec)
								--------------------  --------------------
			Current Rate (1 sec sample)                           0                        0
			Avg. Rate (60 sec interval)                           0                        0

			****************************** Ingress Discards *****************************

			Total Ingress Discards                                                        0
			  No Subscription Match                                                       0
			  Topic Parse Error                                                           0
			  Parse Error                                                                 0
			  Message Too Big                                                             0
			  Publish Topic ACL                                                           0
			  Message Spool Congestion                                                    0
			  Message Spool Ingress Discards                                              0

			****************************** Egress Discards ******************************

			Total Egress Discards                                                         0
			  Transmit Congestion                                                         0
			  Compression Congestion                                                      0
			  Elided                                                                      0
			  TTL Exceeded                                                                0
			  Client Not Connected                                                        0
			  Message Spool Egress Discards                                               0
		</pre>
    <h2 class="with-rule"><a name="managing_message_vpns_884140110_373289"/>Example 3: Message VPN Replication Stats</h2>
    <p>The following example shows the replication details for the Message VPN.</p>
    <p class="Code">solace&gt;show message-vpn vpn-1 replication stats</p>
    <pre class="Code" xml:space="preserve">
			Message VPN:                       default
			Admin Status:                      shutdown
			Config Status:                     standby
			Local Bridge:
			  State:                           n/a
			  Name:                            n/a
			  Queue State:                     n/a
			  Authentication:
			    Scheme:                        Basic
			    Basic:
			      Client Username:
			      Password Configured:         No
			    Client Certificate:
			      Certificate File:
			      Using Server Certificate:    No
			  Compressed:                      No
			  SSL:                             No
			  Message Spool:
			    Window Size:                   255
			  Unidirectional:
			    Client Profile:                #client-profile
			    Retry Delay:                     3
			Remote Bridge:
			  State:                           n/a
			  Name:                            n/a
			Queue:
			  State:                           n/a
			  Quota (MB):                      1500
			  Reject Msg to Sender on Discard: Yes
			Ack Propagation:
			  Interval in Messages:            20
			Sync Replication:
			  Eligible:                        n/a
			    Duration:                      n/a
			Mate Flow Congested:             n/a
			  Duration:                      n/a
			  Reject Msg When Sync Ineligible: No
			Transaction Replication Mode:      async

			Statistics While Active:
			  Message Processing:
			    Sync Messages Queued To Standby:                           0
			    Sync Messages Queued To Standby As Async:                  0
			    Async Messages Queued To Standby:                          0
			    Promoted Messages Queued To Standby:                       0
			    Pruned Locally Consumed Messages:                          0
			  Sync Replication:
			    Transitions To Ineligible:                                 0
			    Ineligible High Water Mark:                      0d 0h 0m 0s
			    Eligible High Water Mark:                        0d 0h 0m 0s
			    Mate Flow Congested High Water Mark:             0d 0h 0m 0s
			    Mate Flow Not Congested High Water Mark:         0d 0h 0m 0s
			  Ack Propagation:
			    Messages Sent To Standby:                                  0
			    Reconcile Request From Standby:                            0
			    Reconcile Scan in Progress:                                No
			Statistics While Standby:
			  Message Processing:
			    Messages Received From Active:                             0
			  Ack Propagation:
			    Messages Received from Active:                             0
			    Reconcile Request Sent to  Active:                         0
			    Out of Sequence Ack Received:                              0
			Transaction Replication:
			  Transactions Requests:                                       0
			    Success:                                                   0
			      Prepare:                                                 0
			      Commit:                                                  0
			      Rollback:                                                0
			    Fail:                                                      0
			      Prepare:                                                 0
			      Commit:                                                  0
			      Rollback:                                                0
</pre>
    <h2 class="with-rule"><a name="managing_message_vpns_884140110_373311"/>Clearing Message VPN Statistics</h2>
    <p>To clear the statistics for one or more Message VPNs, enter the following command:</p>
    <p class="Code">solace# clear message-vpn &lt;vpn-name&gt; stats</p>
    <p><u>Where</u>:</p>
    <ul>
      <li><code>&lt;vpn-name&gt;</code> is the full name of the Message VPN, or part of the Message VPN name with the wildcard character <code>?</code> used to represent one character of the name, or the wildcard character <code>*</code> used to represent zero or more characters of the name, where entering only the wildcard character <code>*</code> for the name clears the statistics for all Message VPNs.</li>
    </ul>
  </body>
</html>

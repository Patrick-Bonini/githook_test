<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>HA Configuration for Appliances</h1>
    <p>Two Solace PubSub+ appliances can be configured as a high-availability (HA) redundant pair so that if one appliance is taken out-of-service or fails, the other will automatically take over servicing clients for the downed appliance. This eliminates the potential for a single point of failure with Solace PubSub+.</p>
    <p>The HA redundancy feature is largely transparent to clients and other Solace PubSub+ appliances in the network. Only the two appliances that are paired as mates require explicit configuration to take advantage of the feature — there is no special configuration needed on client host computers.</p>
    <p>Solace PubSub+ appliances support two HA redundancy models:</p>
    <ul>
      <li><u>Active/Standby</u>—a primary appliance provides service to clients and sends and receives data and messages, while a backup appliance waits in standby mode—it only provides service should the primary appliance fail. Simultaneous load sharing between the two appliances is not supported. The active/standby model supports Direct and Guaranteed Messaging clients.</li>
      <li><u>Active/Active</u>—both appliances simultaneously provide service to clients during normal operating conditions. That is, some clients connect to the primary IP interface of one appliance and the rest connect to the primary IP interface of the other appliance that is its mate. This allows for load-sharing between the two appliances. However, should one of the appliances go out of service, the remaining appliance can provide the service ordinarily provided by both of the appliances individually. The active/active model supports Direct Messaging clients.</li>
    </ul>
    <h4>Before you begin</h4>
    <p>The instructions that follow assume some familiarity with the appliance's HA feature. For some more detailed information, consider consulting <MadCap:xref href="Appliance-Redundancy-and-Fault-Tolerance.htm">Appliance Redundancy &amp; Fault Tolerance</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="Prerequisites"/>Prerequisites</h2>
    <p>Before configuring the redundancy settings for each Solace PubSub+ appliance to be used in an HA pair, ensure you read and observe all of the following information:</p>
    <ol>
      <li>Both appliances in an HA pair should be the same. That is, appliances should be the same model (for example, both 3530s or both 3560s) and use the same model Network Acceleration Blades (NABs), Assured Delivery Blades (ADBs), and Host Bus Adapters (HBAs). <p>Using matching appliances avoid potential reductions in messaging performance and/or the number of available client connections if a failover occurs and activity switches over to the appliances with less capabilities.</p></li>
      <li>Primary, backup, and static IP interfaces must use valid IP addresses, and the primary, backup, and static IP interfaces used by a NAB port should be part of the same IP subnet. This requirement is not enforced by the system.</li>
      <li>The Solace PubSub+ version must be the same on both appliances.</li>
      <li>The underlying signaling for HA appliance redundancy is based on RFC 3768. Observe all precautions in RFC 3768 regarding VRRP Virtual Router Identifier (VRID) and uniqueness of protected addresses when configuring system redundancy. In particular:<ol style="list-style-type: lower-alpha;"><li>Both appliances in the redundant pair must use the same VRRP VRID.</li><li>The VRRP VRID used by the HA pair must be different from the VRRP ID used by any other devices on the Layer 2 segment (such as IP routers, or other redundant pairs of Solace PubSub+ appliances).</li></ol></li>
      <li>The appliances in an HA pair must have equivalent physical interfaces configured. For example, if all of the physical interfaces for one appliance are configured in a single Link Aggregation Group (LAG), all of the physical interfaces for its mate should also be configured in a single LAG. The Solace CLI doesn't enforce this requirement.</li>
      <li>When running appliances as an HA pair, the Spanning Tree Protocol (STP) must either be disabled or set to portfast mode (or equivalent) on the Layer 2 switch ports that the appliances are connected to. If the switch ports are part of a LAG, then STP must be disabled, or portfast enabled, both on the individual ports, and on the entire LAG.</li>
      <li>For an HA pair to function properly, both appliances in the pair must have the same configuration. For example, they must both have the same Message VPNs, client profiles, and client user names provisioned. For more information, see <MadCap:xref MadCap:unresolvedLink="import-link:redundancy_and_fault_tolerance_506099482_55200" href="../Config-Sync/Configuring-Config-Sync.htm">Managing Config-Sync</MadCap:xref>.
			</li>
      <li>When you are implementing redundancy with Guaranteed Messaging:</li>
      <ul>
        <li>Only the active/standby redundancy model is supported.</li>
        <li>A customer-supplied external disk storage array must be used. See <MadCap:xref href="../../Messaging/Guaranteed-Msg/Configuring-External-Disk-Arrays.htm">Configuring External Disk Arrays for Guaranteed Messaging</MadCap:xref> for more information.</li>
        <li>The redundant pair of appliances must be connected to the same external disk storage array and be configured with the same WWN to use the same logical disk on that external disk storage array.</li>
        <li>Physically connect the ADB mate links of both appliances together with approved MMF fibre cables. Both ports of the SPF modules in each ADB should be cabled.</li>
        <li>Use approved MMF fibre cables to physically connect both SPF module ports in the ADB of the primaryappliance with the corresponding SFP module ports in the ADB of its mate. For more information on establishing these mate links, see one of the following topics in the Installation sections for the type of  appliances being paired:<ul><li>3230—<MadCap:xref MadCap:unresolvedLink="import-link:preparing_your_site_2166676569_54639" href="../../Appliance/3230-Hardware-Installation/ADB-and-HBA-Cable-Specif.htm#preparing_your_site_1159497409_100462">Connecting to ADB and HBA SFP Devices</MadCap:xref></li><li>3260—<MadCap:xref MadCap:unresolvedLink="import-link:preparing_your_site_2166676569_54639" href="../../Appliance/3260-Hardware-Installation/ADB-and-HBA-Specs-and-Cabling-3260.htm#Connect">Connecting to ADB and HBA SFP Devices</MadCap:xref></li><li>3530—<MadCap:xref MadCap:unresolvedLink="import-link:preparing_your_site_2166676569_54639" href="../../Appliance/3530-Hardware-Installation/ADB-and-HBA-Cabling.htm#Connecting-ADB-HBA">Connecting to ADB and HBA SFP Devices</MadCap:xref></li><li>3560—<MadCap:xref MadCap:unresolvedLink="import-link:preparing_your_site_2166676569_54639" href="../../Appliance/3560-Hardware-Installation/ADB-and-HBA-Specs-and-Cabling.htm#Connect">Connecting to ADB and HBA SFP Devices</MadCap:xref></li></ul></li>
        <li>Queues and topic endpoints can be configured on either the primary or backup appliance as long as it is active, and this configuration is propagated automatically to the mate appliance.</li>
      </ul>
    </ol>
    <p class="Note" MadCap:autonum="&lt;b&gt;:  &lt;/b&gt;">Solace PubSub+ appliances in an HA pair should have their clocks synchronized with PTP or an NTP server for Guaranteed message expiry to work as expected in redundant configurations. If the backup appliance doesn't have the same clock time as the primary, then the message will not expire at the expected time if there is a failover between when the message is published and when it is set to expire. </p>
  </body>
</html>

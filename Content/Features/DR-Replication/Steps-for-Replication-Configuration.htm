<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Steps for Configuring Replication</h1>
    <p>The following basic steps are required to initially configure replication service for Message VPNs used at two replication sites:</p>
    <ol>
      <li><MadCap:variable name="Product-Names.pubsub_brand_only"/> event brokers used by the replication sites should be the same:<ul><li>PubSub+ appliances should be the same model (for example, both Solace PubSub+ 3530s or both Solace PubSub+ 3560s) and use the same model Network Acceleration Blades (NABs), Assured Delivery Blades (ADBs), and Host Bus Adapters (HBAs).</li><li>PubSub+ software event brokers should  have the same <a href="../../Software-Broker/System-Resource-Requirements.htm" class="link-internal">system resources</a> and <a href="../../Software-Broker/System-Scaling-Parameters.htm" class="link-internal">scaling parameters</a>.</li></ul><p>Using matching event brokers avoids potential reductions in messaging performance and/or the number of available client connections if a switchover occurs and the event brokers at the site providing service do not offer the same capabilities.</p></li>
      <li>
        <p>Solace recommends using same Solace PubSub+ version while setting up data replication for redundancy groups. If you need to upgrade an event broker's version, refer to the upgrade procedures for the <a href="../../Appliance/Appliance-Upgrade/Appliance-Upgrade.htm" class="link-internal">appliance</a> or <a href="../../Software-Broker/SW-Broker-Upgrade/SW-Broker-Upgrade.htm" class="link-internal">software event broker</a> for the version you want to upgrade to.</p>
      </li>
      <li>To use replication, each event broker in both replication sites must be identically configured. Therefore, enable Config-Sync for all event brokers in both replication sites. In addition, if you are using high-availability (HA)  at a replication site, you must assert one event broker’s system configuration over its mate's. See <MadCap:xref href="../Config-Sync/Configuring-Config-Sync.htm#Enabling">Enabling Config-Sync</MadCap:xref>.
                <div class="Note"><ul><li> For information on which parameters are not synchronized through Config-Sync, refer to <MadCap:xref href="../Config-Sync/Configuring-Config-Sync.htm#Properti">Properties That Are Not Synchronized</MadCap:xref>.</li><li>If you want to implement Transport Layer Security (TLS)/Secure Sockets Layer (SSL) encryption on the replication Config-Sync bridge, refer to <MadCap:xref href="../../Security/Configuring-Server-Cert-Validation.htm">Configuring Server Certificate Validation Settings</MadCap:xref>.</li><li MadCap:conditions="Default.HideFromAllOutput">Before enabling Config-Sync, if you are using a loopback Message VPN bridge on a Replicated event broker to link two different Message VPNs on that same event broker, you must configure the bridge to use an IP address of 127.0.0.1 for the remote Message VPN to prevent reconnect failures after an activity failover. For more information, see <MadCap:xref href="Reconfiguring-LoopBack.htm">Reconfiguring Loopback Bridges Before Enabling Config-Sync</MadCap:xref>.</li></ul></div></li>
      <li>Specify the replication mates for each event broker at both replication sites. See <MadCap:xref href="Replication-Sys-Level-Settings.htm#Config-Replication-Mates">Configuring Replication Mates</MadCap:xref>.
                <p class="Note">When using Solace PubSub+ appliances, the static IP interfaces of the event brokers on the remote replication site must be able to reach the IP interface of the event broker on the local replication site acting as the primary for Guaranteed Messaging.</p></li>
      <li>Set the compatibility mode to "transacted" for both sites. See <MadCap:xref href="Replication-Sys-Level-Settings.htm#Replication-Compat-Mode">Configuring Replication Compatibility Mode for Transactions</MadCap:xref>.</li>
      <li>Create corresponding Message VPNs on one event broker at both replication sites. For example, if you create a Message VPN named <code>blue</code> at one replication site, you must create another Message VPN named <code>blue</code> at its mate replication site. See <MadCap:xref href="../VPN/Configuring-VPNs.htm">Configuring Message VPNs</MadCap:xref>.</li>
      <p>Although a Message VPN created at one replication site is not automatically propagated to the other replication site through Config-Sync, when HA redundant event brokers are used at a site, a Message VPN created on one event broker is automatically propagated to its mate. </p>
      <p class="Note">Message VPN configuration parameters are synchronized through the Config-Sync facility, but Message VPNs must be created and deleted manually. The existing configuration on the active site automatically overwrites the configuration of the standby site via Config-Sync.</p>
      <li>Configure the replication bridge connection that is automatically created for each Message VPN at both replication sites. See <MadCap:xref href="Replication-VPN-Level-Settings.htm#Config-Rep-Bridges">Configuring Replication Bridges</MadCap:xref>.</li>
      <p>If you want to implement SSL encryption on Message VPN replication bridge connections, refer to <MadCap:xref href="../../Security/TLS-SSL-Service-Connections.htm#managing_tls_ssl_service_1762742558_333631">Configuring TLS/SSL Encryption for VPN Replication Bridges</MadCap:xref>.</p>
      <p class="Note">You can also use SolAdmin to configure the replication and Config‑Sync parameters for the event brokers at both replication sites.</p>
      <li>Set the replication state for each Message VPN. Each Message VPN must be active at one replication site and standby at the other site (that is, a Message VPN cannot have the same replication status at more than one replication site). See <MadCap:xref href="Replication-VPN-Level-Settings.htm#Config-VPN-Rep-States">Configuring VPN Replication States</MadCap:xref>.</li>
      <li>Enable replication service for each Message VPN at both replication sites. See <MadCap:xref href="Replication-VPN-Level-Settings.htm#Enable-Replication">Enabling Replication</MadCap:xref>.</li>
      <li>On a Message VPN with an active replication status, configure the durable endpoints to which the published Guaranteed messages will be spooled to. See <MadCap:xref href="../../Messaging/Guaranteed-Msg/VPN-Level-Msg-Spool-Config.htm">Message VPN-Level Guaranteed Messaging Configuration</MadCap:xref>.</li>
      <p>These durable endpoints will be automatically configured on the corresponding Message VPNs with standby replication states through Config-Sync.</p>
      <li>Configure the topics to replicate for the Message VPNs with active replication states. These topics will be automatically configured on the corresponding Message VPNs with standby replication states through Config-Sync. See <MadCap:xref href="Replication-VPN-Level-Settings.htm#Config-Rep-Topics">Configuring Replicated Topics</MadCap:xref>.</li>
      <li>If you will use transactions, configure the transaction replication mode. See <MadCap:xref href="Replication-VPN-Level-Settings.htm#Config-Transaction-Rep">Configuring Transaction Replication Mode</MadCap:xref>.</li>
    </ol>
    <p class="Note">Once replication and Config-Sync are running, clients that connect to a replication standby Message VPN are not allowed to create durable endpoints. They are also not allowed to modify the configuration of existing endpoints (for example, they cannot add or modify topic-to-queue mappings or change the topic or selector associated with a durable topic endpoint). Clients can only create or modify durable endpoints on a Message VPN that has a replication active state.</p>
  </body>
</html>

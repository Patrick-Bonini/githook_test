<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body><h1>Configuring VPN-Level Replication Settings</h1><p>By default, the use of the replication facility is not enabled for a Message VPN. To use the replication facility, replication must be enabled for the Message VPNs at both sites.</p><p>When you are using redundant event brokers at a site, configure the replication settings for one Message VPN, and then they will be automatically propagated to its mate. (Replication bridge configuration settings are an exception—they are not automatically propagated between replication sites.)</p><h2 class="with-rule"><a name="Ack-Prop"/>Configuring ACK Propagation Intervals</h2><p>After a client consumes a message from a durable endpoint, an acknowledgment (that is, an ‘ACK’) is generated so that the message is removed from the message spool. (An ACK is also generated if a message is deleted from the message spool.)</p><p>By default, for a Message VPN with an active replication state, after clients consume a set number of messages from its endpoints, an ACK message is propagated to its mate Message VPN with a standby replication state. When this ACK message is received by the corresponding durable endpoints on the mate replication Message VPN, those endpoints can then also consume those same messages that were replicated to it.</p><p class="Note">If the messages interval is not reached, a one-second periodic timer ensures that acks are propagated in a timely manner. This ACK propagation interval only affects the bandwidth utilization on the replication bridge and likely will not need to be adjusted.</p><p>To set an interval for propagating ACK messages, enter the following CONFIG commands:</p><pre>solace(configure)# message-vpn &lt;vpn-name&gt;
solace(configure/message-vpn)# replication
solace(configure/message-vpn/replication)# ack-propagation
solace(...ssage-vpn/replication/ack-propagation)# interval messages [messages]</pre><p>Where:</p><ul><li><code>messages</code> is the number of consumed messages that must be acknowledged before an ACK message is propagated to the same Message VPN with a replication standby state on the mate site. The default value is 20.</li></ul><p>The no version of this command, <code>no messages</code>, resets the <code>ack-propagation</code> interval back to the default value.</p><p class="Note">By default, endpoints in an active Replicated Message VPN propagate consumer acks to the standby Replicated Message VPN; however, ACK propagation can be enabled/disabled on a per-endpoint basis (for queues, see <MadCap:xref href="../../Messaging/Guaranteed-Msg/Configuring-Queues.htm#Enabling">Enabling / Disabling Propagating Consumer ACKs to Replicated VPNs</MadCap:xref>; for topic endpoints, see <MadCap:xref href="../../Messaging/Guaranteed-Msg/Configuring-DTEs.htm#Enabling4">Enabling/Disabling Propagating Consumer ACKs to Replicated VPNs</MadCap:xref>).</p><h2 class="with-rule"><a name="Config-Rep-Bridges"/>Configuring Replication Bridges</h2><p>A replication bridge is used to connect a Message VPN with an active replication state and a Message VPN of the same name with a standby replication state at the mate site. When replication is enabled for a Message VPN, a replication bridge named <code>#MSGVPN_REPLICATION_BRIDGE</code> is automatically created.</p><MadCap:snippetBlock src="../../Resources/Snippets/Not-Config-Synced.flsnp"/><p class="Note">Any uni-directional client profiles that are used for the replication bridges are excepted—these are synchronized between the replication mates.</p><p>You can perform the following configurations for the replication bridge for the given Message VPN:</p><ul><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_450465">Configuring Authentication Schemes</MadCap:xref></li><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_359444">Enabling the Use of Compressed Data</MadCap:xref></li><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_359459">Configuring Message Spool Window Sizes</MadCap:xref></li><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_359477">Configuring Retry Delays</MadCap:xref></li><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_452698">Enabling TLS/SSL Encryption for Bridge Connections</MadCap:xref></li><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_421197">Setting Client Profiles for Uni-Directional Bridges</MadCap:xref></li></ul><h3><a name="configuring_data_center_replication_2112153501_450465"/>Configuring Authentication Schemes</h3><p>Authentication can be set up on a replication bridge to provide a secure connection between replication sites. Basic and client certificate authentication modes are available. Where Basic uses  basic username and password authentication for replication bridge connections, and Client Certificate uses client certificate authentication for replication bridge connections.</p><p>In an authentication scenario, the replication-standby Message VPN acts as the client and the replication-active Message VPN acts as the authenticating server.</p><h4><a name="configuring_data_center_replication_2112153501_451328"/>Configuring a Client Username for Basic Authentication</h4><p>To set a client username to use for basic replication bridge authentication, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication)# bridge
solace(configure/message-vpn/replication/bridge)# authentication basic
solace(...plication/bridge/authentication/basic)# client-username &lt;name&gt; [password &lt;password&gt;]</pre><p>Where:</p><ul><li><code>&lt;name&gt;</code> is the client username for the bridge to use to log in to the replication standby Message VPN. The username may contain up to 189 characters.</li><li><code>&lt;password&gt;</code> is an optional password that will be also required for authentication if set. The password may contain up to 128 characters.</li></ul><p>The no version of this command, <code>no client username</code>, removes the client username and any password associated with it.</p><div class="Note"><ul><li>A client username can only be configured for the replication bridge when the replication bridge is shutdown.</li><li>A client username used to establish a replication bridge connection must be given permission to create bridge connections (see <MadCap:xref href="../../Security/Configuring-Client-Profiles.htm#allow-bridge-connections">Allowing Bridge Connections</MadCap:xref>).</li></ul></div><h4><a name="configuring_data_center_replication_2112153501_452192"/>Configuring a Certificate File for Client Certificate Authentication</h4><p>To set the certificate file to use for client certificate replication bridge authentication, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication)# bridge
solace(configure/message-vpn/replication/bridge)# authentication client-certificate
solace(...dge/authentication/client-certificate)# certificate-file &lt;filename&gt;</pre><p>Where:</p><ul><li><code>&lt;filename&gt;</code> is the file name of the certificate to use for authentication. The certificate must be located in the <code>/usr/sw/jail/certs</code> directory of the event broker and have an extension of <code>.pem</code>. Once a certificate is configured, a copy of it is saved internally. The file in the <code>certs</code> directory is no longer required.</li></ul><p>The no version of this command, <code>no certificate file</code>, disassociates the certificate file from the current replication bridge.</p><p>For authentication to succeed, the common name provided in the certificate file must exist as a client username on the remote Message VPN. The client username must be enabled, and the client profile that is used by that client username must have <code>allow-bridge-connections</code> enabled. The provided client certificate must also be enabled on the remote Message VPN and adhere to the specified client certificate authentication settings on the remote Message VPN.</p><p>The certificate file can only be configured while the replication bridge is shutdown.</p><p class="Note">If no client certificate file is configured for the replication bridge, the bridge will present the event broker’s server certificate for authentication.
        </p><h3><a name="configuring_data_center_replication_2112153501_359444"/>Enabling the Use of Compressed Data</h3><p>Compression can be enabled for a replication bridge’s data connections to make better use of available WAN bandwidth. The default setting is no compression.</p><p>To enable compression, enter the following CONFIG command:</p><pre>solace(configure/message-vpn/replication/bridge)# compressed-data</pre><p>The <code>no</code> version of this command, <code>no compressed-data</code>, disables the use of compression.</p><p class="Note">Before configuring compression for a replication bridge while a Message VPN is in the standby state, replication on the Message VPN must be disabled (see <MadCap:xref href="#Enable-Replication">Enabling Replication</MadCap:xref>).
        </p><h3><a name="configuring_data_center_replication_2112153501_359459"/>Configuring Message Spool Window Sizes</h3><div class="Caution"><p class="Tbl_Body">The default value for a replication bridge's message spool window size is expected to work well in most typical deployments. Configuring an excessively large message spool window size can negatively impact network performance. Before changing this parameter, <a href="../../get-support.htm" class="link-internal">contact Solace</a> for assistance in choosing the appropriate value for your network conditions.</p></div><p>The message spool window size dictates how many outstanding configuration messages may be sent over a replication bridge before the Message VPN with an active replication state must receive an acknowledgment.</p><p>To configure the message spool window size, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication/bridge)# message-spool
solace(...-vpn/replication/bridge/message-spool)# window-size &lt;number&gt;</pre><p>Where:</p><ul><li><code>&lt;number&gt;</code> is an integer from 1 to 65536 that sets how many messages can be in the window. The default is 255.</li></ul><p>The no version of this command, <code>no message-spool window-size</code>, resets the message spool window size value back to the default value.</p><p class="Note">Before configuring the message spool window size, the replication bridge connection must be disabled by shutting down the replication feature for the Message VPN (see <MadCap:xref href="#Enable-Replication">Enabling Replication</MadCap:xref>).</p><h3><a name="configuring_data_center_replication_2112153501_359477"/>Configuring Retry Delays</h3><p>To configure the number of seconds that must pass before retrying a connection to the replication mate over the replication bridge, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication/bridge)# retry-delay &lt;seconds&gt;</pre><u>Where</u>:<ul><li><code>&lt;seconds&gt;</code> is an integer from 1 to 255 that specifies the number of seconds to wait before retrying a connection to the replication mate. The default is 3.</li></ul><p>The no version of this command, <code>no retry-delay</code>, resets the number of seconds to wait back to the default value.</p><p class="Note">Before configuring a retry-delay value, the replication bridge connection must be disabled by shutting down the replication feature for the Message VPN (see <MadCap:xref href="#Enable-Replication">Enabling Replication</MadCap:xref>).
        </p><h3><a name="configuring_data_center_replication_2112153501_452698"/>Enabling TLS/SSL Encryption for Bridge Connections</h3><p>TLS/SSL encryption can be enabled on replication bridges.</p><p>To enable, enter the following CONFIG command:</p><pre>solace(configure/message-vpn/replication/bridge)# ssl</pre><p>To disable, enter the following CONFIG command:</p><pre>solace(configure/message-vpn/replication/bridge)# no ssl</pre><h3><a name="configuring_data_center_replication_2112153501_421197"/>Setting Client Profiles for Uni-Directional Bridges</h3><p>By default, when the bridge connection from the Message VPN with an active replication state is established to the Message VPN of the same name with a standby replication state at the mate site, the TCP parameters from a non‑editable, default client profile, <code>#client-profile</code>, are used (this default client profile has a TCP max window size of 2 MB). However, if the TCP parameters used by the <code>#client‑profile</code> client profile are not suitable for your network, you can use those from another client profile on the Message VPN with an active replication state. </p><p>To specify a client profile that will provide the TCP parameters to use for the uni‑directional bridge link, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication/bridge)# unidirectional
solace(...vpn/replication/bridge/unidirectional)# client‑profile &lt;name&gt;</pre><p>Where:</p><ul><li><code>&lt;name&gt;</code> is the name of a client profile that exists on the Message VPN with an active replication state. A client profile name can contain up to 32 alphanumeric characters (case‑sensitive).</li></ul><p>The no version of this command, <code>no client-profile</code>, removes the current client profile assignment, and reassigns the default client profile, <code>#client-profile</code>.</p><h2 class="with-rule"><a name="Config-Rep-Queues"/>Configuring Replication Queues</h2><p>When replication is enabled for a Message VPN, a replication queue (named <code>#MSGVPN_REPLICATION_DATA_QUEUE</code>) is automatically created. Messages are spooled here before they are replicated on the replication mate.</p><p>You can set the following replication queue configuration parameters:</p><ul><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_359504">Max Spool Usage</MadCap:xref></li><li><MadCap:xref class="Heading_And_Page" href="#configuring_data_center_replication_2112153501_359511">Reject Message To Sender on Discard</MadCap:xref></li></ul><h3><a name="configuring_data_center_replication_2112153501_359504"/>Max Spool Usage</h3><p>To configure the maximum message spool disk space that can be used for the replication queue for the Message VPN, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication/queue)#
solace(configure/message-vpn/replication/queue)# max-spool-usage &lt;size&gt;</pre><p>Where:</p><ul><li><code>&lt;size&gt;</code> is an integer value specifying the maximum amount of message spool disk space permitted for the replication queue in MB.</li></ul><p>The no version of this command, <code>no max-spool-usage</code>, resets the permitted message spool usage quota available for use by the queue back to the default value.</p><h3><a name="configuring_data_center_replication_2112153501_359511"/>Reject Message To Sender on Discard</h3><p>The reject-msg-to-sender-on-discard option sets whether the replication queue will provide a client with a negative acknowledgment (that is, a “nack”) when published Guaranteed messages are not enqueued and are discarded. When using replicated transactions, the client will also get a negative acknowledgment if the transaction cannot be put on the replication queue. By default, the reject-msg-to-sender-on-discard option is enabled.</p><p>The reject-msg-to-sender-on-discard option can be configured on a Message VPN for a replication queue. Normally, this value should not be disabled, because disabling it will allow Guaranteed messages or transactions that cannot be replicated to be accepted. However, if the replication queue is full because of a long term failure of the standby site, this option can be disabled so that non-replicated service can be provided. </p><p>To configure how the replication queue should behave when Guaranteed messages and transactions are not enqueued and are discarded, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication/queue)#
solace(configure/message-vpn/replication/queue)# reject-msg-to-sender-on-discard</pre><p>Where:</p><ul><li><code>reject-msg-to-sender-on-discard</code> enables the reject-msg-to-sender-on-discard option for the queue so that session events (that is, nacks) are sent to the publishing clients whenever messages or transactions are not enqueued and are discarded. These messages are not allowed to be enqueued on any other endpoints.</li></ul><p>The no version of this command, <code>no reject-msg-to-sender-on-discard</code>, disables the reject-msg-to-sender-on-discard option for the queue so that no session events are returned to the publishing client whenever messages or transactions are not enqueued on the replication queue and are discarded.</p><h2 class="with-rule"><a name="Config-Reject"/>Configuring to Reject Messages When Sync Ineligible</h2><p>If a Message VPN with an active replication state is using synchronous replication when propagating replicated messages and transactions to its mate Message VPN with a standby replication state, and the replication bridge is very slow or goes down, the Message VPN can either switch to an asynchronous replication mode (this is the default action), or the synchronous replication mode can be maintained and error indications (that is, nacks) are sent back to clients publishing to replicated messages and transactions when they cannot be propagated to the standby Message VPN.</p><p>To configure the given Message VPN so that its synchronous replication mode should be maintained and nacks should be sent back to the publishing clients, enter the following CONFIG command on one event broker at the active site:</p><pre>solace(configure/message-vpn/replication)# reject-msg-when-sync-ineligible</pre><p>The no version of this command, <code>no reject-msg-when-sync-ineligible</code>, configures the given Message VPN to switch to asynchronous replication when there are problems with the replication bridge. This is the default behavior.</p><div class="Note"><ul><li>When configured to reject messages when sync ineligible and the replication service is degraded (that is, the Message VPN is sync ineligible), then new synchronous XA transactions will fail to start.</li><li>These commands may be executed when clients are connected and publishing messages and whether replication is enabled or not.</li></ul></div><h2 class="with-rule"><a name="Config-Rep-Topics"/>Configuring Replicated Topic Subscriptions</h2><p>To configure a topic pattern to use for replicating messages to the corresponding Message VPN on the mate site, enter the following CONFIG command on one event broker at the active site:</p><pre>solace(configure/message-vpn/replication)# create replicated-topic &lt;topic-pattern&gt;</pre><p>Where:</p><ul><li><code>topic pattern</code> is the topic pattern to use for replicating messages to the corresponding Message VPN on the replication mate. Typically, a topic pattern is a topic subscription. In this case, only messages whose topics match the configured replicated topic subscription are copied to the corresponding Message VPN on the mate replication site. To enable the replication of messages delivered to queues, the topic pattern may also represent a queue. For example, a topic pattern for a queue could be “<code>#P2P/QUE/&lt;queueName&gt;</code>”.</li></ul><p>You can also specify a topic subscription exception by adding a leading "!" character to the topic subscription. In this case, messages whose topics match the configured topic subscription exception are not copied to the corresponding Message VPN on the replication site. For example, if you add a topic subscription "animals/f*" and a topic subscription exception "!animals/fox",  messages published to "animals/frog" are copied to the replication site; however, messages published to "animals/fox" are not.  For more information about subscription exceptions, see <MadCap:xref href="../../Messaging/Guaranteed-Msg/System-Level-Subscription-Exception-Config.htm">System-Level Subscription Exception Configuration</MadCap:xref>.</p><p>The no version of this command, <code>no replicated-topic</code>, removes the specified replicated topic pattern.</p><div class="Note"><ul><li>The topic pattern can include the * and &gt; wildcard characters.</li><li>Since Direct messages that match a replicated topic will be promoted to Guaranteed messages, it's recommended to avoid the use of wildcards that can match Direct messages to prevent unnecessary message promotion.</li><li>Messages that match the replicated-topic are replicated either synchronously or asynchronously, according to the configured replication mode (see <MadCap:xref class="Heading" href="#configuring_data_center_replication_2112153501_359532">Replication Mode</MadCap:xref> below). The replication mode is specified on a per-replicated topic-basis.</li><li>When using local and XA transactions, published messages in the transaction must match the topic pattern to be replicated. If a transaction contains some messages that match a replicated topic and some that do not, only those matching messages are propagated to the replication mate as part of the transaction.</li></ul></div><h3><a name="configuring_data_center_replication_2112153501_359532"/>Replication Mode</h3><p>To set the replication mode for a replicated topic subscription, enter the following CONFIG commands:</p><pre>solace(configure/message-vpn/replication)# create replicated-topic &lt;topic-pattern&gt;
solace(...sage-vpn/replication/replicated-topic)# replication-mode {sync | async}</pre><p>Where:</p><ul><li><code>sync</code> is a synchronous replication mode. When the synchronous replication mode is used, a message with a topic that matches a replicated topic subscription is not acknowledged by the event broker until the message is replicated to the mate replication site. After the message is spooled locally, message replication and publisher acknowledgment are serialized.</li><li><code>async</code> is an asynchronous replication mode. When the asynchronous replication mode is used, a message with a topic that matches a replicated topic subscription is not acknowledged by the event broker until the message is spooled locally. After the message is spooled, message replication and publisher acknowledgment occur asynchronously. Async is the default replication mode.</li></ul><p>The no version of this command, <code>no replication-mode</code>, sets the replication mode to the default value.</p><div class="Note"><ul><li>When using transactions, the replication mode of the replicated topic subscription is ignored. The replication mode of transactions is determined by the Message VPN setting. See <MadCap:xref href="#configuring_data_center_replication_2112153501_359532">Replication Mode</MadCap:xref> for more information.</li><li>Topic subscription exceptions apply only to subscriptions using the same replication mode. For example, if you configure an asynchronous topic subscription "animals/f*" and a synchronous topic subscription exception "!animals/fox" messages published to "animals/fox" are received on the mate replication site. </li></ul></div><h4>Displaying Replicated Topic Subscriptions</h4><p>To show the configured replicated topic subscriptions for the entire system, or on a per‑Message VPN-basis, enter the following User EXEC command:</p><pre>solace&gt; show replicated-topic &lt;topic&gt; [message-vpn &lt;vpn-name&gt;] [replication-mode {sync | async}] [count &lt;num-elements&gt;]</pre><p>Where:</p><ul><li><code>&lt;topic&gt;</code> is a string representation of the replicated topic pattern (that is, either a topic subscription or a queue name). The topic pattern can include CLI wildcard constructs such as * and &gt;.</li><li><code>message-vpn &lt;vpn-name&gt;</code> is a Message VPN name. The Message VPN name can contain from 1 to 32 characters and may contain wildcards * or ?.</li><li><code>replication-mode</code> filters the replicated topic subscriptions based on replication mode.</li><li><code>sync</code> asks to list only topic subscriptions that are configured to use a synchronous replication mode.</li><li><code>async</code> asks to list only topic subscriptions that are configured to use an asynchronous replication mode.</li><li><code>count</code> specifies the number of display elements to show. &lt;num-elements&gt; is the integer specifying the number of elements. Valid values are 1 through 4294967295.</li></ul><MadCap:dropDown><MadCap:dropDownHead><MadCap:dropDownHotspot>Example:</MadCap:dropDownHotspot></MadCap:dropDownHead><MadCap:dropDownBody><pre class="Code">solace&gt; show replicated-topic * message-vpn vpn-1 replication-mode async 

Message VPN: vpn-1
Replication
Topic                                                                     Mode
------------------------------------------------------------------------------
t-1-1-1                                                                  async
t-1-1-2                                                                  async
t-1-1-3                                                                  async</pre></MadCap:dropDownBody></MadCap:dropDown><h2 class="with-rule"><a name="Config-Transaction-Rep"/>Configuring Transaction Replication Mode</h2><MadCap:snippetBlock src="../../Resources/Snippets/Features/DR-Replication/configure-vpn-tranasction-replication-mode-overview.flsnp"/><p>To configure the transaction replication mode of the Message VPN, enter the following CONFIG command in the Solace CLI:</p><pre>solace(configure/message-vpn/replication)# transaction-replication-mode {async| sync}</pre><p>Where:</p><ul><li><code>async</code> sets the transaction replication mode of the Message VPN to asynchronous (the default state).</li><li><code>sync</code> sets the transaction replication mode of the Message VPN to synchronous.</li></ul><p>The no version of this command sets the mode to async.</p><div class="Note"><ul><li>Changes to this setting do not affect in-progress transaction. Those transaction will complete using their previous replication mode. Newly started transaction will use the new setting.</li><li>The replication mode of the replicated topic used to match the messages is ignored when using transactions. For example, messages published to an asynchronous topic inside a synchronous transaction use synchronous handling.</li></ul></div><h2 class="with-rule"><a name="Config-VPN-Rep-States"/>Configuring VPN Replication States</h2><p>To configure the replication state of the Message VPN, enter the following CONFIG command:</p><pre>solace(configure/message-vpn/replication)# state {standby|active}</pre><p>Where:</p><ul><li><code>standby</code> sets the replication state of the Message VPN to standby (the default state).</li><li><code>active</code> sets the replication state of the Message VPN to active.</li></ul><div class="Note"><ul><li>When this command is executed while replication is shutdown, it sets the replication state that is to be used when replication is enabled. When this command is executed while replication is enabled, it changes the replication state on the fly.</li><li>When the replication state transitions from active to standby, all clients except <code>#MSGVPN_REPLICATION_BRIDGE</code> and those with allow-clients-when-standby set in their client profile are disconnected from the event broker. After the clients are disconnected, those clients are not  allowed to reconnect while the VPN remains in standby state.</li><li>When the replication state transitions from active to standby, all Active and Idle XA transactions are canceled since they have not reached a state where they need to be persisted. An application server transaction manager will properly recover these transactions.</li></ul></div><h2 class="with-rule"><a name="Enable-Replication"/>Enabling Replication</h2><p>By default, replication is disabled on a Message VPN.</p><ul><li>Before enabling the replication facility for the Message VPN, ensure that the replication state of the Message VPN (see <MadCap:xref href="Monitoring-Replication.htm">Monitoring Replication Operation</MadCap:xref>) and the replication bridge and the replication queue are appropriately configured (see <MadCap:xref href="#Config-Rep-Bridges">Configuring Replication Bridges</MadCap:xref> and <MadCap:xref href="#Config-Rep-Queues">Configuring Replication Queues</MadCap:xref>).</li><li>Replication for the Message VPN cannot be enabled if:<ul><li>Guaranteed Messaging and message spooling on the event broker is disabled. (See <MadCap:xref href="../../Messaging/Guaranteed-Msg/System-Level-Msg-Spool-Config.htm#Enable-Guaranteed">Enabling Guaranteed Message Spooling</MadCap:xref>.)</li><li>The replication bridge client username is not configured. (See <MadCap:xref href="#Config-Rep-Bridges">Configuring Replication Bridges</MadCap:xref>.)</li><li>The replication mate’s virtual-router-name is not configured. (See <MadCap:xref href="Replication-Sys-Level-Settings.htm#Config-Replication-Mates">Configuring Replication Mates</MadCap:xref>.)</li></ul></li></ul><MadCap:snippetBlock src="../../Resources/Snippets/Not-Config-Synced.flsnp"/><ul><li>To enable the replication feature for the Message VPN, enter the following CONFIG command:
                <pre>solace(configure/message-vpn/replication)# no shutdown [force-use-existing-queue | force-recreate-queue]</pre><p>Where:</p><ul><li><code>force‑use‑existing‑queue</code> preserves any messages on a pre-existing replication queue, and the existing replication queue is reused. Before using this option ensure that the messages are not old or otherwise unsuitable to be propagated; this option can only be specified when there is a pre-existing replication queue.</li><li><code>force-recreate-queue</code> causes any messages on a pre-existing replication queue to be discarded and then the replication queue is recreated. Note that this option can only be specified when there is a preexisting replication queue.</li></ul><p class="Note">Typically the <code>no shutdown</code> command can be used without any further arguments—it enables the replication facility for the Message VPN and creates a new bridge and replication queue objects. However, if you encounter a situation where, even though replication was disabled, a previous replication queue still exists, you can use the force options with the command to handle the preexisting replication queue and any messages spooled to it.</p></li></ul><ul><li>To disable replication for a Message VPN enter the following CONFIG command for the given Message VPN:
                <pre>solace(configure/message-vpn/replication)# shutdown</pre></li></ul><p class="Note">Disabling replication for a Message VPN deletes its associated replication bridge and replication queue objects, which can also delete any enqueued messages. Therefore, it is recommended that you ensure that there are no messages enqueued on a replication Queue before shutting down replication.</p></body>
</html>

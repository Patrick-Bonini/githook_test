<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Monitoring Your DMR Cluster</h1>
    <p>If there are problems with your event mesh, for example if DMR is configured incorrectly or if there are operational problems in the network, one or more brokers may report topology errors or DMR being operationally down. </p>
    <h2 class="with-rule"><a name="topology-errors"/>Topology Errors and Troubleshooting</h2>
    <p>Topology errors are caused by problems in the configured or operational network topology. </p>
    <p>Topology problems are expected while adding and removing nodes in a network, because configuration changes need time to propagate through the event mesh. However, if you following the procedures in this documentation, no message loss is expected, and the topology problem should be temporary and clear by itself.</p>
    <p>Some examples of topology errors are:</p>
    <ul>
      <li>missing links—every node in a cluster must be connected by an internal link. Links must be bi-directional; that is, each link must be configured correctly on both nodes.</li>
      <li>mismatched link span—a link is either internal (connecting two nodes within a cluster) or external (connecting gateway nodes in two different clusters). The configuration at both ends of the link must match.</li>
      <li>missing channels—each link must have a control channel plus one data channel per message VPN.</li>
      <li>node name mismatch—each node must correctly specify the name of the remote node connected by the link.</li>
      <li>DMR is not correctly enabled—each participating VPN must opt in to DMR. In addition, for nodes connected by an internal link, the list of Message VPNs participating in DMR on each node must be the same.</li>
    </ul>
    <p> DMR can be operationally down for other reasons, such as:</p>
    <ul>
      <li>misconfiguration in other areas, such as replication or redundancy</li>
      <li>problems with Guaranteed Messaging (e.g., the message spool is down)</li>
      <li>issues with cluster authentication</li>
    </ul>
    <p>If there is a topology error, or DMR is down for some other reason, subscription propagation and data forwarding throughout the network may not be working properly.</p>
    <p>To troubleshoot issues with your event mesh, use the commands in the sections that follow to view the configuration and operational status of the objects in the mesh. Start by looking at the cluster information, then the links, then the channels. That is, start at the widest level of detail (the cluster) and narrow down your focus (first link, then channel) as needed.</p>
    <h2 class="with-rule"><a name="Show-Cluster-Info"/>Displaying Cluster Information</h2>
    <p>To display cluster information, enter the following command:</p>
    <pre class="Code" xml:space="preserve">show cluster &lt;cluster-name-pattern&gt; [detail]</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;cluster-name-pattern&gt;</code> displays clusters matching the pattern. The cluster pattern can be the cluster's full name, or part of its name with the wildcard character <code>?</code> used to represent one character of the name, or the wildcard character <code>*</code> used to represent zero or more characters of the name. Entering only the wildcard character <code>*</code> for the name displays all clusters. </p>
    <p><code>detail</code> displays detailed information for the specified cluster.</p>
    <h2 class="with-rule"><a name="Show-Cluster-Link"/>Displaying Cluster Link Information</h2>
    <p>To display cluster link  information, enter the following command:</p>
    <pre class="Code" xml:space="preserve">show cluster &lt;cluster-name-pattern&gt; link &lt;link-name-pattern&gt; [detail | client-profile | queue | ssl]</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;cluster-name-pattern&gt;</code> displays clusters matching the pattern. </p>
    <p><code>&lt;link-name-pattern&gt;</code> displays cluster links matching the pattern. The link pattern can be the link's full name, or part of its name with the wildcard character <code>?</code> used to represent one character of the name, or the wildcard character <code>*</code> used to represent zero or more characters of the name. Entering only the wildcard character <code>*</code> for the name displays all cluster links.</p>
    <p><code>detail</code> displays detailed information for the specified link.</p>
    <p><code>client-profile</code> displays cluster link client profile information for the specified link.</p>
    <p><code>queue</code> displays cluster link queue information for the specified link.</p>
    <p><code>ssl</code> displays cluster link TLS/SSL information for the specified link.</p>
    <h2 class="with-rule"><a name="Show-Cluster-Channel"/>Displaying Cluster Channel Information </h2>
    <p>To display cluster link channel information, enter the following command:</p>
    <pre class="Code" xml:space="preserve">show cluster &lt;cluster-pattern&gt; link &lt;link-pattern&gt; channel message-vpn &lt;vpn-name&gt; [detail]</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;cluster-name-pattern&gt;</code> displays clusters matching the pattern. </p>
    <p><code>&lt;link-name-pattern&gt;</code> displays cluster links matching the pattern.</p>
    <p><code>&lt;vpn-name&gt;</code> displays channel information for the specified Message VPN.</p>
    <p><code>detail</code> displays detailed channel information for the specified link.</p>
    <h2 class="with-rule"><a name="Show-VPN-Info"/>Displaying Message VPN Information</h2>
    <p>To display DMR information for a particular Message VPN, enter the following command:</p>
    <pre class="Code" xml:space="preserve">show message-vpn &lt;vpn-name&gt; dynamic-message-routing [dmr-bridge &lt;remote-node-name-pattern&gt;]</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;vpn-name&gt;</code> displays DMR information for the specified Message VPN.</p>
    <p><code>&lt;remote-node-name-pattern&gt;</code> displays information for DMR bridges that connect to the specified remote node.</p>
  </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Configuring DMR on a Message VPN</h1>
    <p>The Dynamic Message Routing (DMR) configuration tasks that you can perform for an existing Message VPN include:</p>
    <ul>
      <li>
        <MadCap:xref href="#Enable-DMR-Msg-Vpn">Enabling or Disabling DMR for a Message VPN</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Create-DMR-Bridge">Configuring a DMR Bridge </MadCap:xref>
      </li>
    </ul>
    <h2 class="with-rule"><a name="Enable-DMR-Msg-Vpn"/>Enabling or Disabling DMR for a Message VPN</h2>
    <p>You can enable or disable DMR for a given Message VPN. In other words, each individual Message VPN can opt in or out of participating in DMR.  </p>
    <p>Enabling DMR on Message VPNs  establishes data channels between all nodes connected with internal cluster links. To establish a data channel between nodes connected with external cluster links, in addition to enabling DMR on a Message VPN, you must also create a DMR bridge for each external link (refer to <MadCap:xref href="#Create-DMR-Bridge">DMR Bridge Configuration</MadCap:xref>).</p>
    <p>Once a data channel has been established, application messages  are exchanged across nodes, as dictated by the subscription sets maintained over control channels. </p>
    <p>When DMR is disabled for a Message VPN, the following occurs:</p>
    <ul>
      <li>The Message VPN’s data channels are terminated, whether this node is the initiator of the link or not.</li>
      <li>Direct and Guaranteed messages are not sent to or received from adjacent nodes.</li>
      <li>Guaranteed messages are not enqueued to the adjacent nodes.</li>
      <li>Existing enqueued Guaranteed message are lost.</li>
    </ul>
    <div class="Note">
      <p>The set of Message VPNs participating in DMR must be the same for every node in the cluster.</p>
    </div>
    <p>To enable DMR for a Message VPN, enter the following commands:</p>
    <pre class="Code" xml:space="preserve">solace(configure)# message-vpn &lt;message-vpn-name&gt;
solace(configure/message-vpn)# dynamic-message-routing
solace(...e/message-vpn/dynamic-message-routing)# no shutdown</pre>
    <p>To disable DMR for a Message VPN, enter the following command:</p>
    <pre class="Code" xml:space="preserve">
solace(...e/message-vpn/dynamic-message-routing)# shutdown</pre>
    <p class="Note">By default, DMR is enabled for the <code>default</code> Message VPN on software event brokers, and disabled for appliances. </p>
    <h2 class="with-rule"><a name="Create-DMR-Bridge"/>Configuring a DMR Bridge</h2>
    <p>A DMR bridge is required to establish a data channel over a corresponding external link to the remote node for a given Message VPN. Each DMR bridge identifies which external link the Message VPN should use, and what the name of the equivalent Message VPN at the remote node is.</p>
    <p>To create a DMR bridge between Message VPNs enter the following commands:</p>
    <pre class="Code" xml:space="preserve">solace(configure/message-vpn)# dynamic-message-routing
solace(...e/message-vpn/dynamic-message-routing)# create dmr-bridge &lt;node-name&gt;
solace(...pn/dynamic-message-routing/dmr-bridge)# remote
solace(...mic-message-routing/dmr-bridge/remote)# message-vpn &lt;msg-vpn-name&gt;</pre>
    <p><u>Where</u>:</p>
    <p><code>&lt;node-name&gt;</code> is the name of the remote node on which the Message VPN you want to connect to resides.</p>
    <p><code>&lt;msg-vpn-name&gt;</code> is name of the Message VPN on the remote node that you want to connect to.</p>
  </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1><MadCap:concept term="Software"/>Docker for Linux</h1>
    <p>This section walks you through the steps to set up a single PubSub+ <MadCap:variable name="Product-Names.broker_sw_short"/> container with Docker  in a non-cloud Linux environment.</p>
    <ul>
      <li>
        <MadCap:xref href="#before-you-begin">Before You Begin</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#get-a-pubsub-software-event-broker">Step 1: Get a PubSub+ Software Event Broker</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#create-the-container">Step 2: Create the Container</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#manage-the-pubsub-software-event-broker">Step 3: Manage the PubSub+ Software Event Broker</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#next-steps">Next Steps</MadCap:xref>
      </li>
    </ul>
    <h2 class="with-rule"><a name="before-you-begin"/>Before You Begin</h2>
    <p>It’s assumed that you have a stable version of the Docker daemon installed on your Linux host.


</p>
    <h3><a name="system-requirements"/>System Requirements</h3>
    <MadCap:snippetBlock src="../../../Resources/Snippets/System-Requirements-Container-Images.flsnp"/>
    <h2 class="with-rule"><a name="get-a-pubsub-software-event-broker"/>Step 1: Get a PubSub+ Software Event Broker</h2>
    <p>Pull the event broker image from the Docker repository using these two steps:</p>
    <ol>
      <li>
        <p>Start Docker.</p>
      </li>
      <li>Pull the image:
                <pre xml:space="preserve">&gt;sudo docker pull solace/solace-pubsub-standard</pre></li>
    </ol>
    <MadCap:snippetBlock src="../../../Resources/Snippets/container-ubuntu-linux-download-instance.flsnp"/>
    <p>Once you've obtained the package, start Docker  and <a href="https://docs.docker.com/engine/reference/commandline/load/" target="_blank" class="link-offsite">load</a> the image.</p>
    <p>For example:</p>
    <pre xml:space="preserve">&gt;sudo docker load -i /tmp/solace-pubsub-enterprise-&lt;version&gt;-docker.tar.gz</pre>
    <h2 class="with-rule"><a name="create-the-container"/>Step 2: Create the Container</h2>
    <p>There are many options that you can set with the <code>docker create</code> or <code>docker run</code> command that is used to build the event broker container. The following example sets up a simple configuration suitable for a test deployment.</p>
    <p>This example:</p>
    <ul>
      <li> runs an event broker <code>solace</code> using the <code>latest</code> PubSub+ Standard image from Docker Hub</li>
      <li>creates an <code>admin</code> user with global access permissions</li>
      <li> publishes the following event broker container ports to the same ports on the Ubuntu host:<MadCap:snippetBlock src="../../../Resources/Snippets/container-ubuntu-linux-ports.flsnp"/></li>
    </ul>
    <p>In the example, the <code><a href="../../Configuring-Storage.htm#understanding-storage-group" class="link-internal">storage-group</a></code> (mapped to <code>/var/lib/solace</code> in the container) is bind-mounted to <code>/mnt/solace</code> on the host. </p>
    <MadCap:snippetBlock src="../../../Resources/Snippets/container-ubuntu-linux-storage.flsnp"/>
    <p>You must create the <code>/mnt/solace</code> directory on the host before creating the container. </p>
    <p>To  run the container, enter the following command:</p>
    <pre xml:space="preserve">&gt;sudo docker run -d -p 8080:8080 -p 55555:55555 --shm-size=1g --env username_admin_globalaccesslevel=admin --env username_admin_password=admin --name=solace 

--mount type=bind,source=/mnt/solace,destination=/var/lib/solace,ro=false solace/solace-pubsub-standard</pre>
    <div class="Note">
      <ul>
        <li>If you loaded the image from a compressed tar archive, replace <code>solace/solace-pubsub-standard</code> in the example with the repository and tag that corresponds to your image. For example, if you loaded version 10.1.0.19 of the PubSub+ Enterprise edition, use <code>solace-pubsub-enterprise:10.1.0.19</code>.</li>
      </ul>
    </div>
    <MadCap:snippetBlock src="../../../Resources/Snippets/docker-selinux-labels.flsnp"/>
    <h2 class="with-rule"><a name="manage-the-pubsub-software-event-broker"/>Step 3: Manage the PubSub+ Software Event Broker</h2>
    <MadCap:snippetBlock src="../../../Resources/Snippets/container-manage-broker-docker.flsnp"/>
    <h2 class="with-rule"><a name="next-steps"/>Next Steps</h2>
    <MadCap:snippetBlock src="../../../Resources/Snippets/SW-broker-setup-next-steps.flsnp"/>
  </body>
</html>

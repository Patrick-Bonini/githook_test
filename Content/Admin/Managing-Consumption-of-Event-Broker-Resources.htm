<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1>Resource Consumption </h1>
    <p>This section describes how you, as a network administrator, can manage the consumption of Solace PubSub+ event broker resources on a Message VPN-basis. It also describes how you can set resource consumption limits for endpoints and how to control access to resources through client profiles.</p>
    <p>To effectively plan how to manage event broker resources on a Message VPN‑basis, you should be familiar with the following:</p>
    <ul>
      <li>the system-level limits for Guaranteed Message delivery (for example, the maximum number of Message VPNs and the maximum combined number of queues and topic endpoints that are permitted)</li>
      <li> the maximum Guaranteed message ingress rates offered by the types of Solace PubSub+ software event brokers and Solace PubSub+ appliances used in your network. These rates are useful for determining what type of load Message VPNs could encounter.
                </li>
    </ul>
    <p>In addition, if you are deploying event brokers in high-availability (HA) pairs and/or you are using replication for disaster-recovery site protection, you must ensure that the event brokers used in the HA pairs and/or replication clusters are evenly matched. That is, the event brokers that are provisioned should have equivalent operating limits so that if a failover occurs,  the event broker that takes over service can support the same number of active client and Message VPNs that the out-of-service event broker was supporting. </p>
    <h2 class="with-rule"><a name="Overbook"/>Overbooking Event Broker Resources</h2>
    <p>You can configure Message VPNs on the Solace PubSub+ event broker so that:</p>
    <ul>
      <li>a full overbooking of all event broker resources is allowed
			<p>This means that any Message VPN can consume all available event broker resources. This is the event broker default.</p></li>
      <li>partial overbooking of event broker resources by Message VPNs is allowed
        <p>This means that no single Message VPN may consume all resources, but their configured resource consumption limits are high enough that, in combination, they could reach the system limit.</p></li>
      <li>no overbooking of event broker resources is allowed<p>This means that the sum of the configured consumption limits of all Message VPNs will not exceed the system limits.</p></li>
    </ul>
    <h3>Example Overbooking Scenarios</h3>
    <p>The scenarios below show examples of full, partial, and no overbooking scenarios for the maximum permitted number of client connections for a model of Solace PubSub+ 3260 that has a total system limit of 9,000 simultaneous client connections: </p>
    <ul>
      <li><b>Fully-Overbooked Solace PubSub+ Event Brokers</b>—Scenario A shows a fully overbooked event broker where the maximum permitted number of simultaneous client connections for each Message VPN is the same as maximum allowed for the entire event broker.
			  <p style="text-align: left;"><img src="../Resources/Images/Admin/full-overbooking.png" MadCap:mediastyle="@media print { max-width: 340px; }" alt="Full Overbooking of Router" style="max-width: 340px;"/></p></li>
    </ul>
    <ul>
      <li><b>Partially-Overbooked Solace PubSub+ Event Brokers</b>—Scenario B shows a partially overbooked event broker. Although no single Message VPN allows the maximum permitted number of simultaneous client connections, the limits for the Message VPNs in combination exceed the system limit.
                <p style="text-align: left;"><img src="../Resources/Images/Admin/partial-overbooking.png" alt="Parital Overbooking of Router" MadCap:mediastyle="@media print { max-width: 340px; }" style="max-width: 340px;"/></p></li>
    </ul>
    <ul>
      <li><b>Non-Overbooked Solace PubSub+ Event Brokers</b>—Scenario C shows an event broker that is not overbooked. In this scenario the total maximum number of permitted simultaneous client connections for the entire event broker cannot be exceeded even when the values for each Message VPN are combined.
                <p style="text-align: left;"><img src="../Resources/Images/Admin/no-overbooking.png" alt="No Overbooking of Router" MadCap:mediastyle="@media print { max-width: 340px; }" style="max-width: 340px;"/></p></li>
    </ul>
    <h2 class="with-rule"><a name="Setting"/>Setting Consumption Limits for VPNs</h2>
    <p>The table below lists the event broker configuration parameters that you can use to control the consumption of event broker resources on a per-Message VPN-basis.</p>
    <table class="TableStyle-Table_Num" style="caption-side: top;width: 95%;mc-table-style: url('../Resources/TableStyles/Table_Num.css');" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption">Message VPN-Based Limits</p>
      </caption>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 33%;"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Resource Parameter</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">To set, see...</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number of clients that can simultaneously connect to a Message VPN.</p>
            <p class="Note">The number of simultaneous client allowed for a Message VPN depends on the type of Solace PubSub+ event broker.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Features/VPN/Configuring-VPNs.htm#Max-Connections">Configuring Maximum Connections</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number of local client subscriptions that can be added to a Message VPN.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Features/VPN/Configuring-VPNs.htm#Max-Subs">Configuring Maximum Subscriptions</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum amount of system-level message spool disk space (in MB) that a Message VPN can use.</p>
            <p class="Note">The default value for the amount of disk storage permitted for a Message VPN is 0. Therefore, a value must be configured after a Message VPN is created so that it can spool messages.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Messaging/Guaranteed-Msg/VPN-Level-Msg-Spool-Config.htm#Configur7">Configuring the Max Spool Usage</MadCap:xref>
            </p>
            <p class="Note">This is also configurable on a per-Guaranteed endpoint‑basis.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p class="Tbl_Body">The maximum number of simultaneous transacted sessions allowed for a Message VPN.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Messaging/Guaranteed-Msg/VPN-Level-Msg-Spool-Config.htm#Configur6">Configuring the Max Number of Transacted Sessions</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number of queue and topic endpoints that can be created.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Messaging/Guaranteed-Msg/VPN-Level-Msg-Spool-Config.htm#Configur5">Configuring the Max Number of Endpoints</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number egress flows (that is, Guaranteed message client receive flows) that can be created.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Messaging/Guaranteed-Msg/VPN-Level-Msg-Spool-Config.htm#Configur32">Configuring the Max Number of Flows</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">The maximum number ingress flows (that is, Guaranteed message client publish flows) that can be created.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p>
              <MadCap:xref href="../Messaging/Guaranteed-Msg/VPN-Level-Msg-Spool-Config.htm#Configur32">Configuring the Max Number of Flows</MadCap:xref>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 class="with-rule"><a name="Setting2"/>Setting Consumption Limits for Endpoints</h2>
    <p>The table below lists the event broker configuration parameters that you can use to control the consumption of event broker resources on a per-endpoint-basis.</p>
    <table class="TableStyle-Table_Num" style="caption-side: top;width: 95%;mc-table-style: url('../Resources/TableStyles/Table_Num.css');" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption">Endpoint-Based Limits</p>
      </caption>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <col style="width: 33%;" class="TableStyle-Table_Num-Column-Column1"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Resource Parameter</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">To set, see...</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number of messages spooled to an endpoint that can be delivered to a client on a flow but remained unacknowledged the client.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <ul>
              <li>For queues: <MadCap:xref href="../Messaging/Guaranteed-Msg/Configuring-Queues.htm#managing_guaranteed_messaging_1810020758_455709">Configuring Max Permitted Number of Delivered Unacked Messages</MadCap:xref></li>
              <li>For topic endpoints: <MadCap:xref href="../Messaging/Guaranteed-Msg/Configuring-DTEs.htm#Configur22">Configuring Max Number of Delivered Unacked Messages</MadCap:xref></li>
            </ul>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum message size (in bytes) permitted for the given durable message queue or topic endpoint.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <ul>
              <li>For queues: <MadCap:xref href="../Messaging/Guaranteed-Msg/Configuring-Queues.htm#Configur17">Configuring Max Permitted Message Sizes</MadCap:xref></li>
              <li>For topic endpoints: <MadCap:xref href="../Messaging/Guaranteed-Msg/Configuring-DTEs.htm#Configur23">Configuring Max Permitted Message Sizes</MadCap:xref></li>
            </ul>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">The maximum amount of message spool disk space (in MB) that a queue or a topic endpoint is permitted to use.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <ul>
              <li>For queues: <MadCap:xref href="../Messaging/Guaranteed-Msg/Configuring-Queues.htm#Configur16">Configuring Max Spool Usage Values</MadCap:xref></li>
              <li>For topic endpoints: <MadCap:xref href="../Messaging/Guaranteed-Msg/Configuring-DTEs.htm#Configur25">Configuring Max Spool Usage Values</MadCap:xref></li>
            </ul>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 class="with-rule"><a name="Controll"/>Controlling Client Access to Resources</h2>
    <p>For each Message VPN, you can configure client profiles that set limits to control clientsʼ consumption of event broker resources. These client profiles are then applied to the client usernames that clients use to authentication with the event broker. </p>
    <p>The following table lists client profile parameters that affect the amount of event broker resources clients can consume.</p>
    <table class="TableStyle-Table_Num" style="caption-side: top;width: 95%;mc-table-style: url('../Resources/TableStyles/Table_Num.css');" cellspacing="0">
      <caption valign="top" style="padding-bottom: 3pt;">
        <p class="TblCaption">Solace PubSub+ Event Broker Resources Accessed Through Client Profiles</p>
      </caption>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 33%;"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Resource Parameter</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">To set, see...</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number of client connections that can simultaneously connect with the same client username account.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#Config-Max-Connects-Username">Configuring the Max Connections Per Username</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number of local client subscriptions allowed for a single client connection.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#Config-Max-Subscriptions">Configuring the Max Permitted Subscriptions</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum depth of egress per-client priority queues, as measured in work units of 2048 bytes.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#Config-Egress-Queues">Configuring Egress Priority Queues</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p class="Tbl_Body">The maximum number of topics the event broker can track for performing the eliding function on each client connection.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#managing_client_authentication_and_authorization_21734666_225859">Configuring the Maximum Number of Topics to Elide</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">Allow or deny clients to publish Guaranteed messages.</p>
            <p class="Note">Publishing Guaranteed messages consumes message spool resources in the Message VPN when messages are enqueued for delivery to Guaranteed Messaging consumers. You can adjust this parameter to ensure that only authorized clients are allowed to publish Guaranteed messages.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#All-G-Msg-Sends">Allowing Guaranteed Message Sends</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">Allow or deny clients to create Guaranteed endpoints.</p>
            <p class="Tbl_Body">You can adjust this parameter to ensure that only authorized clients are allowed to create Guaranteed endpoints.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#Allow-G-Msg-Creates">Allowing Guaranteed Endpoint Creates</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
            <p class="Tbl_Body">The maximum number of durable and non‑durable queues and topic endpoints that can be owned by clients using the same client username.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#Allow-G-Msg-Creates">Allowing Guaranteed Endpoint Creates</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
            <p class="Tbl_Body">Allow or deny clients to use transacted sessions using Solace messaging APIs.</p>
            <p class="Tbl_Body">You can adjust this parameter to ensure that only authorized clients are allowed to create Guaranteed endpoints.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
            <p class="Tbl_Body">
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#Allow-Trans-Sess">Allowing Transacted Sessions</MadCap:xref>
            </p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
            <p class="Tbl_Body">The maximum number of simultaneous transacted sessions allowed for a single client connection.</p>
          </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p>
              <MadCap:xref href="../Security/Configuring-Client-Profiles.htm#Max-Transacted-Sess">Configuring the Max Number of Transacted Sessions</MadCap:xref>
            </p>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

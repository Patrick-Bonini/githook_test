<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    </head>
  <body>
    <h1>Backing Up Configuration Files to External File Servers</h1>
    <p>You can back up configuration files to an external file server using SFTP or SCP. Backing up configuration files externally ensures that you have a set of configuration files in case of local file failure. It is good practice to perform external configuration backups before upgrading, downgrading, installing service patches, or making changes to network hardware.</p>
    <p class="Warning">Do not use this procedure for <MadCap:variable name="Product-Names.broker_cloud_short"/>s in <MadCap:variable name="Product-Names.cloud_product_short"/>. Using this procedure in <MadCap:variable name="Product-Names.cloud_product_short"/>  may result in a degradation of service. Instead, see <MadCap:xref href="../Cloud/backup-brokers-messaging.htm">Backing Up [%=Product-Names.broker_cloud_short_title%]s</MadCap:xref> for more information.</p>
    <h2 class="with-rule"><a name="system_and_software_maint_back_up_external_when_to"/>When to Externally Backup</h2>
    <p>It is important that you backup configuration files to an external file server regularly (using either SFTP or SCP) to ensure that you have a set of backup files available in case your current local configuration database becomes corrupted or otherwise unusable.</p>
    <p>Solace recommends that you perform at least one configuration backup to an external file server daily. Furthermore, external backups should be done in the following circumstances:</p>
    <ul>
      <li>before upgrading or downgrading an event broker</li>
      <li>before installing a service patch for installed event brokers</li>
      <li>before making any major changes to the network hardware</li>
      <li>before deploying a large number of new network devices</li>
    </ul>
    <div class="Caution">
      <p>Do not attempt to start, stop, or reset the event broker at any point during the backup process.</p>
    </div>
    <h2 class="with-rule"><a name="system_and_software_maint_back_up_external_CLI"/>Externally Backing Up Config Files Using CLI</h2>
    <p>To back up a configuration file to an external file server using SFTP or SCP from the event broker using a CLI user account, follow this procedure:</p>
    <p class="Note">Ensure that you have a file server on the event broker network to which you have IP connectivity.</p>
    <ol>
      <li>Enter the following User EXEC command: <pre>solace&gt; enable<br/>solace#</pre></li>
      <li>Enter one of the following commands to copy the desired configuration file to the external file server (using either SFTP or SCP) from the event broker:
        <pre>solace# copy current-config sftp://[&lt;username&gt;@]&lt;ip-addr&gt;/&lt;remote-pathname&gt;</pre><p>Or</p><pre>solace# copy current-config scp://[&lt;username&gt;@]&lt;ip-addr&gt;/&lt;remote-pathname&gt;</pre><p><u>Where</u>:</p><p><code>&lt;username&gt;</code>is your SFTP or SCP username</p><p><code>&lt;ip-addr&gt;</code> and <code>&lt;remote-pathname&gt;</code> point to the location (either an SFTP server or an SCP server) where the current configuration file is to be copied.</p></li>
    </ol>
    <h2 class="with-rule"><a name="system_and_software_maint_back_up_external_file_trans"/>Externally Backing Up Config Files Using File Transfer</h2>
    <p>Backing up a configuration file to an external file server (using SFTP or SCP) from an event broker can also be done using a File Transfer user account created through the <code>username</code> Global CONFIG command.</p>
    <p><u>Example</u>:</p>
    <pre>[remote_machine]# sftp pascal@192.168.1.208:configs/backup ./appliance86-backup.1730.cfg</pre>
    <pre>Connecting to 192.168.1.208...</pre>
    <pre>Password: &lt;password&gt;</pre>
    <pre>Fetching /configs/backup to ./appliance86-backup.1730.cfg<br/>/configs/backup 100% 34MB 4.9MB/s 00:07</pre>
  </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Configuring LDAP Authentication</h1>
    <p>To successfully enable LDAP authentication for CLI users and/or LDAP authorization for clients, the following must be configured:</p>
    <ul>
      <li>on external host machines, up to three LDAP servers</li>
      <li>on the Solace PubSub+ event broker, up to ten LDAP profiles </li>
    </ul>
    <p>For information about LDAP authorization for clients, see <MadCap:xref href="../Security/Configuring-LDAP-Groups.htm">Client LDAP Authorization Configuration</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="Configur-ldap-servers"/>Configuring LDAP Servers</h2>
    <p>To successfully enable LDAP authentication for CLI users and/or LDAP authorization for clients, an LDAP administrator must install and configure an LDAP server on an external host machine. For information on choosing a host machine and installing the server software, refer to the third-party LDAP server documentation.</p>
    <div class="Note">
      <p class="Tbl_Body"> Only use LDAP version 3 with Solace PubSub+ event brokers. LDAP versions 1 and 2 are not supported.</p>
    </div>
    <h2 class="with-rule"><a name="Configur-profiles"/>Configuring LDAP Profiles</h2>
    <p>For LDAP authentication of CLI users and/or LDAP authorization of clients to function, an LDAP profile must be configured on the event broker and be enabled. An LDAP profile contains authentication/authorization request retry timeout values and LDAP authentication/authorization configurations for each of the LDAP servers used by the LDAP profile. Each LDAP profile can use up to three LDAP servers, and up to ten LDAP profiles can be configured.</p>
    <p>At a minimum, a system administrator must configure at least one reachable LDAP server and a search base-dn for the LDAP profile. The LDAP profile must then be enabled (refer to <MadCap:xref href="#Enable-LDAP-Profiles">Enabling LDAP Profiles</MadCap:xref>).</p>
    <ul>
      <li>To create a new LDAP profile, enter the following CONFIG level command:
                <p class="Code">solace(configure)# authentication<br/>solace(configure/authentication)# create ldap-profile &lt;profile-name&gt;</p></li>
      <li>To edit properties for an existing LDAP profile, enter the following CONFIG level command:
                <p class="Code">solace(configure)# authentication<br/>solace(configure/authentication)# ldap-profile &lt;profile-name&gt;</p></li>
    </ul>
    <p><u>Where</u>:</p>
    <p><code>&lt;profile-name&gt;</code> is the name of the LDAP profile. An LDAP profile name can contain up to 32 alphanumeric characters and underscores.</p>
    <p>The no version of this command, <code>no ldap-profile &lt;profile-name&gt;</code>, deletes the specified LDAP profile from the event broker (the LDAP profile named <code>default</code>, however, cannot be deleted). Before deleting a LDAP profile:<ul><li>it must be disabled through the <code>shutdown</code> LDAP Profile Authentication CONFIG command</li><li>no other configured objects can refer to it</li></ul></p>
    <p>
           When an LDAP profile is created, it is not automatically enabled. To enable an LDAP profile, you must enter the <code>no shutdown</code> LDAP Profile Authentication CONFIG command (refer to <MadCap:xref href="#Enable-LDAP-Profiles">Enabling LDAP Profiles</MadCap:xref>).
        </p>
    <p>After setting the <code>ldap-profile</code>, you can configure the following parameters:</p>
    <ul>
      <li>
        <MadCap:xref href="#Allow-Unath-Authentication">Allowing Unauthenticated Authentication</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Cofig-Admin-DN">Configuring Admin Distinguished Names</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Cofig-Search">Configuring Search Parameters</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Enable-LDAP-Profiles">Enabling LDAP Profiles</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Enable-TLS">Enabling TLS/SSL Encryption</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#Register-LDAP">Registering LDAP Servers</MadCap:xref>
      </li>
    </ul>
    <h3><a name="Allow-Unath-Authentication"/>Allowing Unauthenticated Authentication</h3>
    <div class="Caution">
      <p> As discussed in RFC 4513, LDAP supports unauthenticated authentication. If the <code>allow-unauthenticated-authentication</code> attribute is enabled for an LDAP profile, all clients can pass LDAP server authentication and connect to the event broker without a password (if unauthenticated authentications are permitted by the LDAP server). This can introduce a significant security risk; therefore, by default, unauthenticated authentication by LDAP is not enabled on LDAP profiles.</p>
    </div>
    <p>To configure an LDAP profile to allow unauthenticated authentication for all clients (if LDAP is the provisioned authentication method on the event broker), enter the following CONFIG command:</p>
    <pre class="Code">solace(configure/authentication/ldap-profile)# allow-unauthenticated-authentication</pre>
    <p>The no version of this command, <code>no allow-unauthenticated-authentication</code>, turns off unauthenticated authentication by LDAP (the default) so that all clients of LDAP profiles that attempt to connect without passwords are rejected immediately by the event broker without consulting the LDAP server.</p>
    <h3><a name="Cofig-Admin-DN"/>Configuring Admin Distinguished Names</h3>
    <p>To configure the credentials of the event broker in the current LDAP profile for connecting to an LDAP server, enter the following CONFIG command:</p>
    <p class="Code">solace(configure/authentication/ldap-profile)# admin dn &lt;admin-dn&gt; password &lt;admin-password&gt;</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;admin-dn&gt;</code> is the LDAP distinguished name for the event broker to use to authenticate itself to the LDAP server.</p>
    <p class="Tbl_Body"><code>&lt;admin-password&gt;</code> is the password to use with the admin distinguished name to bind to the LDAP server.</p>
    <h3><a name="Cofig-Search"/>Configuring Search Parameters</h3>
    <p>To configure search parameters in the current LDAP profile for connecting to an LDAP server, enter the following CONFIG command:</p>
    <p class="Code">solace(configure/authentication/ldap-profile)# search [base-dn &lt;distinguished-name&gt; | deref {never | search | base | always} | filter &lt;filter&gt; | follow-continuation-references | scope {base | one-level | subtree} | timeout &lt;duration&gt;]</p>
    <p><u>Where</u>:</p>
    <p><code>base-dn</code> sets the base node for searches:</p>
    <ul>
      <li><code>&lt;distinguished-name&gt;</code> is the LDAP distinguished name of the node of the directory tree to start searches from. For example: “<code>ou=software,dc=solacesystems,dc=com</code>”</li>
    </ul>
    <p><code>deref</code> configures the alias dereferencing behavior of directory searches:</p>
    <ul>
      <li><code>never</code>—never dereference aliases</li>
      <li><code>search</code>—only dereference aliases when searching</li>
      <li><code>base</code>—only dereference aliases when locating the base node</li>
      <li><code>always</code>—always dereference aliases (default)</li>
    </ul>
    <p><code>filter</code> sets the templated filter to use to locate individual users in the directory service:</p>
    <ul>
      <li><code>&lt;filter&gt;</code> is the filter string used to search for directory entries.               <p>The following substitution variables can be added to the filter:</p><ul><li style="font-family: Courier;font-weight: normal;font-style: normal;letter-spacing: 0em;text-decoration: none;"><code>$CLIENT_USERNAME</code></li><li style="font-family: Courier;font-weight: normal;font-style: normal;letter-spacing: 0em;text-decoration: none;"><code>$VPN_NAME </code><p>Substitution variables are recognized by the event broker and are substituted with the client’s relevant information. Examples of filters using substitution variables:</p><ul><li style="font-family: Courier;font-weight: normal;font-style: normal;letter-spacing: 0em;text-decoration: none;"><code>“(&amp;(cn=$CLIENT_USERNAME)(ou=$VPN_NAME))”</code></li><li style="font-family: Courier;font-weight: normal;font-style: normal;letter-spacing: 0em;text-decoration: none;"><code>“(cn=$CLIENT_USERNAME)”</code></li><p>When using LDAP to authenticate and/or authorize users, the username is substituted into the variable <code>$CLIENT_USERNAME</code> in the filter string.</p></ul></li></ul></li>
    </ul>
    <p><code>follow-continuation-references</code> enables or disables the following of continuation references returned by the contacted LDAP server. When this parameter is enabled, if an LDAP search does not fully end on the contacted server, the search for relevant entries may continue on up to ten other servers it references. By default, this parameter is enabled.</p>
    <p><code>scope</code> configures the scope of directory searches:</p>
    <ul>
      <li><code>base</code>—search only the base node</li>
      <li><code>one-level</code>—search only one level deep</li>
      <li><code>subtree</code>—search the entire subtree directory (default)</li>
    </ul>
    <p><code>timeout</code> configures the amount of time (in seconds) to wait before retrying an authentication or authorization request to a LDAP server:</p>
    <ul>
      <li><code>&lt;duration&gt;</code> is an integer from 1 to 40 that indicates the amount of time (in seconds) to wait to retry a request. This is the amount of time the LDAP server has to complete a search request.</li>
    </ul>
    <p>There are two configurable timeouts related to LDAP requests.  One is for LDAP lookup of the username and password, and the other is for the lookup of the client's group membership.</p>
    <h3><a name="Enable-LDAP-Profiles"/>Enabling LDAP Profiles</h3>
    <div class="Caution">
      <p class="Tbl_Body">The <code>shutdown</code> LDAP Profile Authentication CONFIG command disables the current LDAP profile. Thereafter all clients attempting to authenticate using this LDAP profile will fail until it is enabled again through the <code>no shutdown</code> LDAP Profile Authentication command.</p>
    </div>
    <ul>
      <li>To enable the current LDAP profile on the event broker, enter the following CONFIG command:                <p class="Code">solace(configure/authentication/ldap-profile)# no shutdown</p></li>
      <li>To disable the current LDAP profile on the event broker, enter the following CONFIG command:
                <p class="Code">solace(configure/authentication/ldap-profile)# shutdown</p></li>
    </ul>
    <p>By default, LDAP profiles are not enabled on an event broker.</p>
    <h3><a name="Enable-TLS"/>Enabling TLS/SSL Encryption</h3>
    <p>There are two ways to enable TLS/SSL encryption for LDAP Authentication: StartTLS and LDAPS.</p>
    <p><b>LDAP authentication with StartTLS</b>—A plaintext LDAP connection established over the default port 389, which is upgraded to a secure connection.</p>
    <p>To enable TLS/SSL encryption with StartTLS in the current LDAP profile, enter the following CONFIG command:</p>
    <pre class="Code" xml:space="preserve">solace(configure/authentication/ldap-profile)# starttls</pre>
    <p>The no version of this command, <code>no starttls</code>, disables TLS for the current LDAP profile. </p>
    <p><b>LDAP authentication with LDAPS</b>—A secure connection, by default, over port 636</p>
    <p>To enable an encrypted connection using LDAPS, add <code>ldaps://</code> as the prefix to the LDAP server name specified in the ldapserver parameter. Refer to <MadCap:xref href="#Register-LDAP">Registering LDAP Servers</MadCap:xref> for more information.</p>
    <div class="Note">
      <ul>
        <li>
                    The <code>starttls</code> setting is ignored if an LDAP-server host URL is specified with LDAPS protocol.</li>
        <li>Starting with the Solace PubSub+ event broker 9.5.0 release, the <code>[no] tls</code> command has been deprecated.       </li>
        <li>
            When performing the procedure <MadCap:xref href="#Cofig-TLS">Configuring TLS Support for LDAP Authentication</MadCap:xref>, the Common Name (CN) of the CA certificate must match the hostname component of the LDAP host.
</li>
      </ul>
    </div>
    <h3><a name="Register-LDAP"/>Registering LDAP Servers</h3>
    <p>To register the connection information for each LDAP server used by the LDAP profile, enter the following CONFIG command for each host:</p>
    <p class="Code">solace(configure/authentication/ldap-profile)# ldap-server &lt;ldap-host&gt; index &lt;server-index&gt;</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;ldap-host&gt;</code> is the Uniform Resource Indicator (URI) of the LDAP server. A system administrator can specify an IP address and port number (if a number is not specified, port 389 is used by default) or a domain name. For example, “<code>ldap://192.167.123.4:389</code>” or “<code>ldap://ldap.solace.com</code>”.</p>
    <div class="Note">
      <ul>
        <li>For LDAP authentication using StartTLS, the port in the LDAP host is used for both TLS and non-TLS connections to the LDAP server.</li>
        <li>Ensure that the LDAP server IP address is reachable from the event broker management interface.</li>
        <li>If the LDAP server uses a hostname:<ul><li>You must configure the name server on the event broker. For more information, refer to <MadCap:xref href="Configuring-DNS.htm">Configuring DNS</MadCap:xref>.</li><li>When performing the procedure <MadCap:xref href="#Cofig-TLS">Configuring TLS Support for LDAP Authentication</MadCap:xref>, the Common Name (CN) of the trusted CA certificate must match the hostname component of the LDAP host.</li></ul></li>
        <li>Each LDAP profile is supported by up to three LDAP servers. You must provide connection information for each LDAP server used by the LDAP profile.</li>
      </ul>
    </div>
    <p><code>&lt;server index&gt;</code> is the priority index of the host to be provisioned. Valid values are 1, 2, or 3.</p>
    <p>The no version of this command, <code>no ldap-server {&lt;ldap-host&gt; | index &lt;server-index&gt;}</code>, deprovisions the LDAP host, as indicated by a URI or the server index, and deletes all associated configuration values from the Solace PubsSub+ event broker.</p>
    <h2 class="with-rule"><a name="Use-TLS-Between"/>Using TLS/SSL</h2>
    <p>By default, information sent between the Solace PubSub+ event broker (the LDAP client) and the LDAP server during the authentication process is sent as plain text. If better protection of information passed between the event broker and a provisioned LDAP server is required, TLS/SSL can be used to encrypt the communication. As mentioned in <MadCap:xref href="#Enable-TLS">Enabling TLS/SSL Encryption</MadCap:xref>, you can configure TLS/SSL support for LDAP Authentication using StartTLS or LDAPS.</p>
    <p>To use LDAP authentication/authorization over TLS/SSL, an LDAP profile enabled for TLS/SSL must be used, and the event broker must be configured with a list of Certificate Authority (CA)-approved certificates.</p>
    <h3><a name="Cofig-TLS"/>Configuring TLS Support for LDAP Authentication</h3>
    <p>To support TLS/SSL encryption for connections to LDAP servers, do the following:</p>
    <ol>
      <li>
        <p>You can enable a secure connection using StartTLS or LDAPS.</p>
        <ul>
          <li>To enable a secure connection using StartTLS, using the following command:</li>
          <pre class="Code">solace(configure/authentication/ldap-profile)# starttls</pre>
          <p>The <code>starttls</code> setting is ignored if an LDAP-server host URL is specified with LDAPS protocol.</p>
          <li>To enable a secure connection using LDAPS, in Step 3 below, add <code>ldaps://</code> as the prefix to the LDAP-server name specified in the ldapserver parameter.</li>
        </ul>
      </li>
      <li>Import and load trusted CA certificates onto the event broker (refer to <MadCap:xref href="../Security/Managing-Certificate-Authorities.htm#configure-certificate-revocation">Configuring the Domain Validation Certificate Authorities List</MadCap:xref>).</li>
      <li>Configure an LDAP server for an LDAP profile on the event broker for TLS/SSL service through the <code>ldap-server</code> LDAP Profile Authentication CONFIG command. Refer to <MadCap:xref href="#Register-LDAP">Registering LDAP Servers</MadCap:xref> for configuration instructions.</li>
      <p>When configuring an LDAP server for TLS/SSL, the hostname or IP address must match the subject or a subject alternative name of the LDAP server's certificate.</p>
      <p>For example, if the LDAP server hostname is <code>ldap.solace.com</code>, you could use the Solace CLI to verify the server name:</p>
      <pre class="Code">solace# shell “debug”<br/><br/>login: support<br/>Password: <br/>[support@solace ~]$ openssl s_client -connect ldap.solace.com:636<br/></pre>
      <p>This returns the certificate, and the server specified in the certificate is the CN of the certificate subject, for example:</p>
      <pre class="Code" xml:space="preserve">subject=/CN=ldap.solace.comQh</pre>
      <p class="Note">If you are using StartTLS, when configuring an LDAP server on the event broker, the unencrypted port should be specified for the server hostname.</p>
    </ol>
    <h3><a name="View-Trusted"/>Viewing Event Brokers’ Trusted CA Certificates</h3>
    <p>To view the event broker’s trusted CA certificates, enter the following User EXEC command:</p>
    <p class="Code">solace&gt; show domain-certificate-authority ca-name &lt;ca-name&gt; [cert [raw-content]</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;ca-name&gt;</code> is the name of the certificate authority.</p>
    <p><code>raw-content</code> specifies to show the CA certificate's raw content.</p>
    <MadCap:dropDown>
      <MadCap:dropDownHead>
        <MadCap:dropDownHotspot>Example:</MadCap:dropDownHotspot>
      </MadCap:dropDownHead>
      <MadCap:dropDownBody>
        <pre class="Code" xml:space="preserve">solace&gt; show domain-certificate-authority ca-name myCA cert
Certificate Authority:      myCA
Certificate Content:
    Version: 3 (0x2)
    Serial Number: 12132645341674646070 (0xa85fd0a82050aa36)
    Signature Algorithm: md5WithRSAEncryption
        Issuer:
            C=CA
            ST=Ontaria
            L=Ottawa
            O=Solace Systems
            OU=Application
            CN=a28
            emailAddress=software@solacesystems.com
        Validity
            Not Before: Jun 20 15:18:07 2012 GMT
            Not After : Jun 21 15:18:07 2022 GMT
        Subject:
            C=CA
            ST=Ontaria
            L=Ottawa
            O=Solace Systems
            OU=Application
            CN=a28
            emailAddress=software@solacesystems.com
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (1024 bit)
                Modulus:
                    00:f7:85:1e:6d:6d:82:d9:14:a4:05:b3:37:f6:d5:
                    05:b1:b3:32:9e:c0:f9:29:47:0d:aa:32:33:27:a4:
                    ff:63:2c:8d:bb:65:6c:91:cb:3e:d3:51:55:bd:f3:
                    d3:47:a8:c9:61:a0:55:63:30:15:e6:9d:5d:43:cd:
                    d2:ca:c5:3c:d5:15:db:50:94:f6:21:b2:38:66:b2:
                    f1:99:95:5d:39:f8:25:2b:b1:5f:cc:38:04:16:d6:
                    3e:a7:cc:52:3c:7e:8c:b7:cb:2d:5d:b6:81:f6:ed:
                    1a:5c:b3:d4:8c:35:61:e6:95:86:99:f9:61:71:ea:
                    8b:77:5e:b8:4d:8e:28:c9:73
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                02:CD:F4:3A:87:82:CC:59:06:09:7C:0E:07:76:7C:F3:0E:4C:79:D8
            X509v3 Authority Key Identifier: 
                keyid:02:CD:F4:3A:87:82:CC:59:06:09:7C:0E:07:76:7C:F3:0E:4C:79:D8
                DirName:/C=CA/ST=Ontaria/L=Ottawa/O=Solace Systems/OU=Application/CN=a28/emailAddress=software@solacesystems.com
                serial:A8:5F:D0:A8:20:50:AA:36

            X509v3 Basic Constraints: 
                CA:TRUE
    Signature Algorithm: md5WithRSAEncryption
         c5:1e:34:8b:c2:b3:e1:6b:e9:08:45:39:fc:94:7a:3a:8d:86:
         db:3d:a1:6c:74:d0:73:57:00:95:c7:6a:1f:16:03:32:4e:b1:
         82:bb:b7:34:a7:69:3f:de:85:df:8d:f6:15:01:0f:f8:0a:4e:
         1f:1f:de:c2:49:de:80:f7:c5:e3:6d:7f:fd:a5:f6:85:83:0e:
         f7:cc:ce:2e:c9:ad:6b:37:ae:07:4c:99:f2:c7:87:08:7a:f9:
         a7:08:a0:39:47:66:b3:78:f0:0b:79:f2:e2:b5:39:39:d1:01:
         da:16:a4:86:83:33:48:82:4b:99:d1:b0:0b:65:d8:83:a6:03:
         35:70
</pre>
      </MadCap:dropDownBody>
    </MadCap:dropDown>
    <h2 class="with-rule"><a name="Cofig-LDAP-Groups"/>Configuring LDAP Groups</h2>
    <p>CLI users can belong to an LDAP group that can be used to authorize CLI users. Specific access levels are configured for each LDAP group.</p>
    <p>A CLI user may belong to more than one LDAP group, and the access levels defined for each group may differ. In this case, the greatest global access level and the greatest Message VPN access level access level defined in the groups the CLI user is a member of are used.</p>
    <p>To create an LDAP group object that represents an LDAP group that exists on the LDAP server, enter the following CONFIG commands:</p>
    <p class="Code">solace(configure)# authentication <br/>solace(configure/authentication)# user-class cli<br/>solace(configure/authentication/user-class)# access-level<br/>solace(...uthentication/user-class/access-level)# ldap<br/>solace(...tication/user-class/access-level/ldap)# create group &lt;group-name&gt;</p>
    <p><u>Where</u>:</p>
    <p><code>group-name</code> is the name of an LDAP group that exists on the LDAP server. LDAP names can contain up to 256 alphanumeric characters, except the ‘*’ or ‘?’ characters, and the first character may not be ‘#’. Additional things to consider about the group name:</p>
    <ul>
      <li> If the group name contains the characters “#”, “+”, “;”, “=”, the LDAP server may return the value of the group name where those characters are appended with a “\” character. For example, for a group name of “<code>test#,lab,com</code>”, the LDAP server could return “<code>test\#,lab,com</code>”. The exact handling of these special characters depends on the LDAP server provider that is used.
			</li>
      <li>To edit the properties for an LDAP group that has already been provisioned on the event broker, enter the following CONFIG command: <code>solace(...tication/user-class/access-level/ldap)# group &lt;group-name&gt;</code>.</li>
      <li>The group name is case sensitive and must match the case of the groups returned by the LDAP server.</li>
    </ul>
    <p>The no version of this command, <code>no group name &lt;group-name&gt;</code>, removes the given group name.</p>
    <h3><a name="Assign-Global-Access"/>Assigning Global Access Levels</h3>
    <p>To assign a global access level for CLI users that belong to a given LDAP group, enter the following CONFIG command:</p>
    <p class="Code">solace(...on/user-class/access-level/ldap/group)# global-access-level [none|read-only|read-write|admin]</p>
    <p><u>Where</u>:</p>
    <p><code>none</code> specifies a global access level of none. The default value is none.</p>
    <p><code>read‑only</code> specifies a global access level of read-only.</p>
    <p><code>read-write</code> specifies a global access level of read-write.</p>
    <p><code>admin</code> specifies a global access level of admin.</p>
    <h3><a name="Assign-Default-MVPN"/>Assigning Message VPN Default Access Levels</h3>
    <p>To assign a Message VPN default access level for CLI users that belong to a given LDAP group, enter the following CONFIG commands:</p>
    <p class="Code">solace(...on/user-class/access-level/ldap/group)# message-vpn<br/>solace(...s/access-level/ldap/group/message-vpn)# default-access-level [none|read-only|read-write]</p>
    <p><u>Where</u>:</p>
    <p><code>none</code> specifies a default Message VPN access level of none. The default value is none.</p>
    <p><code>read‑only</code> specifies a default Message VPN access level of read-only.</p>
    <p><code>read-write</code> specifies a default Message VPN access level of read-write.</p>
    <h4><a name="VPN-Exceptions"/>Configuring Message VPN Default Access Level Exceptions</h4>
    <p>To configure an exception to the default Message VPN access level for CLI users that belong to the given LDAP group, enter the following CONFIG command:</p>
    <p class="Code">solace(c...s/access-level/ldap/group/message-vpn)# create access-level-exception &lt;vpn-name&gt; access-level [none|read-only|read-write]</p>
    <p>To modify an existing exception to the default Message VPN access level for CLI users that belong to the given LDAP group, enter the following CONFIG command:</p>
    <p class="Code">solace(...lass/access-level/default/message-vpn)# access-level-exception &lt;vpn-name&gt; access-level [none|read-only|read-write]</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;vpn-name&gt;</code> is the name of a Message VPN that the exception to the default Message VPN access level will apply to.</p>
    <p><code>none</code> specifies a Message VPN access level of none. The default value is none.</p>
    <p><code>read‑only</code> specifies a Message VPN access level of read-only.</p>
    <p><code>read-write</code> specifies a Message VPN access level of read-write.</p>
    <p>The no version of this command, <code>no access-level-exception</code>, removes any exceptions so that the CLI user has the default Message VPN access level for all Message VPNs.</p>
    <p class="Note">
            The number of permitted Message VPN default access level exceptions is not limited, except that it cannot exceed the number of existing Message VPNs on the event broker.</p>
    <h2 class="with-rule"><a name="Config-Group-Membership"/>Configuring Group Membership Attribute Names</h2>
    <p>To authenticate a CLI user, a group membership attribute name must be retrieved from the LDAP server as part of the LDAP search.</p>
    <p>The attribute name indicates that the CLI user belongs to a particular group that exists on the LDAP server and is referenced through an instance provisioned on the Solace PubSub+ event broker (refer to <MadCap:xref href="#Cofig-LDAP-Groups">Configuring LDAP Groups</MadCap:xref>). For example, the attribute name of “memberOf” could be used for an Active Directory‑based LDAP server.</p>
    <p>To set a group membership attribute name for user authentication, enter the following CONFIG commands:</p>
    <p class="Code">solace(configure)# authentication<br/>solace(configure/authentication)# user-class cli<br/>solace(configure/authentication/user-class)# access-level<br/>solace(...uthentication/user-class/access-level)# ldap<br/>solace(...tication/user-class/access-level/ldap)# group-membership-attribute-name &lt;attribute-name&gt;</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;attribute-name&gt;</code> is the name of the attribute the event broker attempts to retrieve from the LDAP server in a search response. An attribute name can contain up to 64 alphanumeric characters.</p>
    <p>The no version of this command, <code>no group-membership-attribute-name &lt;attribute-name&gt;</code>, deletes the LDAP group membership attribute name from the event broker. When using LDAP for CLI user authentication, deleting this attribute results in all future CLI users getting the default access levels (refer to <MadCap:xref href="Configuring-Default-Access-Levels-Externally.htm">Configuring Default CLI User Access Levels with External Authentication</MadCap:xref>).</p>
    <h3><a name="Enable-Second-Searches"/>Enabling LDAP Group Membership Secondary Searches</h3>
    <p>A typical LDAP server deployment has the group membership information stored in the user records that allows the group list to be retrieved right away. However, you can also use an LDAP group membership secondary search that retrieves an attribute from the user records, and then performs a secondary LDAP search using that attribute’s value to retrieve the group list. By default, LDAP group membership secondary search is not enabled.</p>
    <p>To use  LDAP group membership secondary search, you must make the following configuration steps.</p>
    <p class="Note">The CLI examples shown modify the LDAP profile named <code>default</code>.</p>
    <p><b>Step 1</b>: Specify the attribute that needs to be retrieved from the primary search.</p>
    <p>Enter the following CONFIG commands:</p>
    <p class="Code">solace # configure<br/>solace (configure)# authentication<br/>solace (configure/authentication)# ldap-profile default<br/>solace (configure/authentication/ldap-profile)# group-membership-secondary-search<br/>solace (...ile/group-membership-secondary-search)# filter-attribute-from-primary-search &lt;value&gt;</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;value&gt;</code> is the attribute name that the primary search should retrieve from the LDAP server.</p>
    <p><b>Step 2</b>: Provide a substitution variable for the secondary search filter.</p>
    <p>When a secondary search is used, a secondary search filter expression substitutes the search attribute value returned from the primary search with a  secondary search filter expression using substitution variable <code>$ATTRIBUTE_VALUE_FROM_PRIMARY_SEARCH</code>.</p>
    <p>Enter the following CONFIG commands:</p>
    <p class="Code">solace # configure<br/>solace (configure)# authentication<br/>solace (configure/authentication)# ldap-profile default<br/>solace (configure/authentication/ldap-profile)# group-membership-secondary-search<br/>solace (...ile/group-membership-secondary-search)# filter &lt;filter&gt;</p>
    <p><u>Where</u>:</p>
    <p><code>&lt;filter&gt;</code> is the filter to use to locate user entries in a directory service. The event broker will recognize the substitution variables and substitute the user's relevant information. The following substitution variables can be added to the filter:</p>
    <ul>
      <li>
        <code>$ATTRIBUTE_VALUE_FROM_PRIMARY_SEARCH</code>
      </li>
      <li>
        <code>$CLIENT_USERNAME</code>
      </li>
      <li>
        <code>$VPN_NAME</code>
      </li>
    </ul>
    <p>An example of filters using substitution variables is <code>member=$ATTRIBUTE_VALUE_FROM_PRIMARY_SEARCH</code></p>
    <p><b>Step 3</b>: Enable LDAP group membership secondary searches for the event broker.</p>
    <p>Enter the following CONFIG commands:</p>
    <p class="Code">solace# configure<br/>solace(configure)# authentication<br/>solace(configure/authentication)# ldap-profile default<br/>solace(configure/authentication/ldap-profile)# group-membership-secondary-search<br/>solace(...ile/group-membership-secondary-search)# no shutdown</p>
    <div class="Note">
      <ul>
        <li>LDAP group membership secondary search only applies to CLI/SEMP users. The authentication/authorization for client users is only done against the configuration from primary search.</li>
        <li>If LDAP group membership secondary search is enabled, then it effectively replaces the “primary” group membership lookup, which does not get performed anymore.</li>
      </ul>
    </div>
  </body>
</html>

<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1>Declarative SEMP</h1>
    <p>This section provides information about <MadCap:variable name="Variables.CompanyName" MadCap:conditions="SAP.SapHideFromOutput"/> <MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Declarative SEMP.</p>
    <p><MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Declarative SEMP enables you to configure a <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker <MadCap:conditionalText MadCap:conditions="SAP.SapHideFromOutput">(both appliance and software)  </MadCap:conditionalText>by declaring the state of multiple configuration objects and then synchronizing that state to the event broker.</p>
    <h2 class="with-rule">Overview</h2>
    <p><MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Declarative SEMP enables a declarative API for the configuration of the <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker for services.  Declarative API configuration relies on a target configuration without knowledge of the current configuration.  The declarative configuration system then determines how to convert from the current state to the target state. </p>
    <p>More specifically, Declarative SEMP provides for a declarative API based on the concept of a module, which is a data structure containing configuration information, and a plug-in that takes the module and a CRUD instruction and maps them to the SEMPv2 API in a declarative fashion.  Typical instructions to be taken by the Declarative SEMP interface include:</p>
    <ul>
      <li>
        <p>Generate—Provides the current configuration of objects described in the input module as a Hashicorp Configuration Language (HCL) Infrastructure as Code (IaC) file</p>
      </li>
      <li MadCap:conditions="Default.HideFromAllOutput">
        <p MadCap:conditions="Default.HideFromAllOutput">Diff —Compares the input configuration with the current configuration and replies with its differences</p>
      </li>
      <li>
        <p>Plan—Identifies the series of changes to be applied to convert the current configuration to the target configuration IaC directory provided</p>
      </li>
      <li>
        <p>Apply—Apply takes a plan or target configuration IaC directory and executes it to convert the current configuration to the target configuration</p>
      </li>
      <li>
        <p>Destroy—Generates a plan to remove configuration elements in the target configuration IaC directory</p>
      </li>
    </ul>
    <p>
      <img src="../../Resources/Images/SEMP/DSEMP-Overview.png" alt="Illustration depicting the concepts described in the surrounding text."/>
    </p>
    <p class="Note">While a declarative SEMP API could be used in a variety of applications, this feature is initially limited to service configuration, which is defined as the configuration elements contained within a Message VPN (as configured by <MadCap:variable name="Product-Names.pubsubmanager_long"/>).</p>
    <h2 class="with-rule">Use Cases</h2>
    <p>Good examples of uses for declarative configuration include golden configurations, configuration management systems, and service additions from teams other than the messaging infrastructure team.</p>
    <p><MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Declarative SEMP supports the following use cases:</p>
    <ul>
      <li>Application Team Self Serve Infrastructure as Code with Environment Separation</li>
      <li>Configuration Management</li>
    </ul>
    <h3>Application Team Self Serve Infrastructure as Code with Environment Separation</h3>
    <p>In this case, suppose you have deployed an event mesh and your application teams have begun to adopt the use of the event mesh en masse.  Your messaging infrastructure team cannot keep up with incoming requests to configure consumers and producers on the event mesh infrastructure. You need <MadCap:variable name="Variables.CompanyName"/> to provide the ability for your application teams to write IaC to add or remove consumers and/or producers and other non-environmental components within certain constraints to the broker environment your team has already created. You also need to be able to copy services from one environment to the next (for example, in a CICD pipeline).  Finally, you need to be able to provide templates (for example, different queue types) for your application teams to leverage in their IaC.</p>
    <h3>Configuration Management</h3>
    <p>In this case let's also suppose you have deployed an event mesh and your application teams have begun to adopt the use of the event mesh en masse. However, this time you need to be able to pull down the current configuration of the services (non-infrastructure components) on your event mesh and hold them in a set of configuration files at version control for your event mesh.  These version control files can be utilized to revert your event mesh services to their prior configuration in the same environments in the event of configuration corruption or a failed attempt to reconfigure your event mesh services.  The version control configurations can also be manually modified to apply these services to the other environments.</p>
    <h2 class="with-rule">Dependencies</h2>
    <p><MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Declarative SEMP has the following dependencies: </p>
    <ul>
      <li>
        <p>Requires Terraform. Terraform is a command-line program that applies a declarative configuration to create or update as necessary a set of resources via pluggable providers (SEMP objects correspond to resources in Terraform).  Providers are automatically downloaded as needed from the public Terraform registry or from private registries as specified in the configuration. The <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker provider<MadCap:conditionalText MadCap:conditions="SAP.SapHideFromOutput">s are</MadCap:conditionalText><MadCap:conditionalText MadCap:conditions="SAP.SapOnlyOutput"> is</MadCap:conditionalText> available in the standard Terraform public registry.<MadCap:conditionalText MadCap:conditions="SAP.SapHideFromOutput"> There are two providers, one for the appliance and one for the software event broker, which you can also use to configure <MadCap:variable name="Product-Names.pubsub_brand_only"/> Cloud services.</MadCap:conditionalText> For more information about Terraform, see <a href="https://www.terraform.io/" class="link-offsite">https://www.terraform.io/</a>. </p>
      </li>
      <li>
        <p>In order to properly configure event broker objects for a particular release, you must use the appropriate event broker provider and SEMPv2 versions. For more information, see <MadCap:xref href="#Version-Compatibility">Version Compatibility </MadCap:xref>.</p>
      </li>
    </ul>
    <h2 class="with-rule">Limitations</h2>
    <p><MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Declarative SEMP has the following limitations:</p>
    <ul>
      <li>
        <p>Terraform apply will not be atomic.  If interrupted by a user, failure, reboot, or switchover the configuration changes may be partly applied and there will be no attempt to rollback the changes.</p>
      </li>
      <li>
        <p>Terraform must be the authoritative source of configuration.  If there is any overlap between Terraform controlled configuration and either pre-existing configuration or modifications from other management interfaces, the behaviour will be undefined.</p>
      </li>
      <li>
        <p>Apply operations may impact performance (especially large changes).  </p>
      </li>
      <li>
        <p>Application of configuration may not be hitless.  In other words, brief service interruptions may occur during an apply.  These can include a queue missing a published message, or clients being briefly disconnected.  </p>
      </li>
      <li>
        <p>Declarative SEMP does not support OpenTofu.</p>
      </li>
      <li>
        <p>Declarative SEMP is supported in production environments only on configuration elements specific to a Message VPN. In other words, the elements that you can configure under a Message VPN via <MadCap:variable name="Product-Names.pubsubmanager_long"/>. Use of any resource not contained within a Message VPN is not supported. </p>
        <p>Within a Message VPN, the following objects are coupled to other objects and subject to additional limitations:</p>
        <ul>
          <li>
            <p>ACL profiles—You cannot destroy an ACL profile without removing the coupling from all objects that reference the profile.</p>
          </li>
          <li>
            <p>User profiles—You cannot destroy a user profile without removing the coupling from all objects that reference the profile.</p>
          </li>
          <li>
            <p>Authorization groups—You cannot destroy an authorization group without removing the coupling from all objects that reference the group.</p>
          </li>
          <li>
            <p>LDAP groups—You cannot destroy an LDAP group without removing the coupling from all objects that reference the group.</p>
          </li>
          <li>
            <p>RDP consumer OAuth JWT claims—You cannot manage RDP consumer OAuth JWT claims with Declarative SEMP.</p>
          </li>
        </ul>
      </li>
    </ul>
    <h2 class="with-rule">Getting Started with <MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Declarative SEMP</h2>
    <p MadCap:conditions="SAP.SapHideFromOutput">For a description of how to use the <MadCap:variable name="Variables.CompanyName"/> event broker providers to execute  operations against <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker configuration as described in HCL, see the documentation included with each provider:</p>
    <ul MadCap:conditions="SAP.SapHideFromOutput">
      <li>
        <p> For the <MadCap:conditionalText MadCap:conditions="SAP.SapHideFromOutput">software </MadCap:conditionalText>event broker provider, see <a href="https://registry.terraform.io/providers/solaceproducts/solacebroker/latest/docs" class="link-offsite" target="_blank">https://registry.terraform.io/providers/solaceproducts/solacebroker/latest/docs</a>. </p>
      </li>
      <li>
        <p>For the appliance provider, see <a href="https://registry.terraform.io/providers/solaceproducts/solacebrokerappliance/latest/docs" class="link-offsite" target="_blank">https://registry.terraform.io/providers/solaceproducts/solacebrokerappliance/latest/docs</a>.</p>
      </li>
    </ul>
    <p>For a description of how to use the  event broker provider to execute  operations against <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker configuration as described in HCL, see the <a href="https://registry.terraform.io/providers/solaceproducts/solacebroker/latest/docs" target="_blank" class="link-offsite">documentation</a> included with the provider.</p>
    <p> The <MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> event broker provider also offers the ability to generate a configuration file from a preconfigured event broker. For more information, see the <a href="https://registry.terraform.io/providers/solaceproducts/solacebroker/latest/docs/guides/config-generator" class="link-offsite" MadCap:conditions="SAP.SapHideFromOutput" target="_blank">software event broker</a><a href="https://registry.terraform.io/providers/solaceproducts/solacebroker/latest/docs/guides/config-generator" class="link-offsite" MadCap:conditions="SAP.SapOnlyOutput" target="_blank">event broker</a><MadCap:conditionalText MadCap:conditions="SAP.SapHideFromOutput"> or <a href="https://registry.terraform.io/providers/solaceproducts/solacebrokerappliance/latest/docs/guides/config-generator" class="link-offsite" target="_blank">appliance</a></MadCap:conditionalText> provider documentation. </p>
    <p class="Note">Terraform uses the snake case naming scheme, while SEMP uses camel case.  It is also universal practice that resources and datasource be prefixed with the preferred local name of the provider.  SEMP names will be converted appropriately for those two requirements but otherwise used as is.  For example, this means that <code>solacebroker_msg_vpn</code> is the Message VPN resource name and <code>max_subscription_count</code> is the attribute for the maximum subscription count, since <code>MsgVpn</code> is the SEMP API object name and <code>maxSubscriptionCount</code> is the name of the SEMP attribute.</p>
    <h3><MadCap:conditionalText MadCap:conditions="SAP.SapHideFromOutput"><MadCap:variable name="Product-Names.pubsub_brand_only"/> </MadCap:conditionalText>Terraform Modules</h3>
    <p>Terraform modules encapsulate the configuration of a set of related Terraform resources into a single module block. The input variables of the module become the configurable attributes of the module block.  The output variables of the module become attributes that can be referenced elsewhere from the module object.</p>
    <p MadCap:conditions="SAP.SapHideFromOutput"><MadCap:variable name="Variables.CompanyName"/> includes the following Terraform modules in each provider:</p>
    <p MadCap:conditions="SAP.SapOnlyOutput">The following Terraform modules are included in the event broker provider:</p>
    <ul>
      <li>
        <p>
          <MadCap:xref href="#Service-Module">Service Module</MadCap:xref>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#Client-Module">Client Module</MadCap:xref>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#JNDI-Module">JNDI Module</MadCap:xref>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#Queue-Endpoint-Module">Queue Endpoint Module</MadCap:xref>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#REST-Delivery-Module">REST Delivery Module</MadCap:xref>
        </p>
      </li>
    </ul>
    <p>The intent of these modules is to provide a default configuration that middleware teams can modify  and pass on to the application development team for further adjustments.</p>
    <p>The relationship between each module is described in the following diagram:</p>
    <p>
      <img src="../../Resources/Images/SEMP/DSEMP-Module-Relationships.png"/>
    </p>
    <h4><a name="Service-Module"/>Service Module</h4>
    <p>The Service module encapsulates Message VPN-level service configuration, including protocols, authentication and authorization settings, and resource limits. It defines and makes ACL and client profiles available for use.</p>
    <p>For more information, including examples that show common use cases, see the <a href="https://registry.terraform.io/modules/SolaceProducts/service/solacebroker/latest" target="_blank" class="link-offsite">Service</a> Terraform module documentation. </p>
    <h4><a name="Client-Module"/>Client Module</h4>
    <p>The Client module represents a client user entity, either a client username or authorization group.</p>
    <p>For more information, including examples that show common use cases, see the <a href="https://registry.terraform.io/modules/SolaceProducts/client/solacebroker/latest" target="_blank" class="link-offsite">Client</a> Terraform module documentation. </p>
    <h4><a name="JNDI-Module"/>JNDI Module</h4>
    <p>The JNDI module provides a wrapper for a JMS connection factory event broker object. More specifically, this module enables an application team member to create a  connection factory object in the JNDI store of an event broker with minimal insight into all of the necessary <MadCap:variable name="Variables.CompanyName" MadCap:conditions="SAP.SapHideFromOutput"/> configuration components  by only providing the resource-specific information.</p>
    <p>For more information, including examples that show common use cases, see the <a href="https://registry.terraform.io/modules/SolaceProducts/jndi/solacebroker/latest" target="_blank" class="link-offsite">JNDI</a> Terraform module documentation.</p>
    <h4><a name="Queue-Endpoint-Module"/>Queue Endpoint Module</h4>
    <p>The Queue Endpoint module represents a durable event broker endpoint to publish to, or consume from. In addition, it can also represent an endpoint template.</p>
    <p>For more information, including examples that show common use cases, see the <a href="https://registry.terraform.io/modules/SolaceProducts/queue-endpoint/solacebroker/latest" target="_blank" class="link-offsite">Queue Endpoint</a> Terraform module documentation. </p>
    <h4><a name="REST-Delivery-Module"/>REST Delivery Module</h4>
    <p>The Rest Delivery module represents REST delivery point (RDP), REST consumer, and queue binding configuration. More specifically, this module enables an application team member to create an RDP that connects to a consumer (for example, a public cloud) with minimal insight into all of the necessary <MadCap:variable name="Variables.CompanyName" MadCap:conditions="SAP.SapHideFromOutput"/> configuration components by only providing the resource-specific information.</p>
    <p>For more information, including examples that show use cases, see the <a href="https://registry.terraform.io/modules/SolaceProducts/rest-delivery/solacebroker/latest" target="_blank" class="link-offsite">Rest Delivery</a> Terraform module documentation. </p>
    <h2 class="with-rule"><a name="Version-Compatibility"/>Version Compatibility </h2>
    <p>This section lists the releases of the <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker with the corresponding required <MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/><MadCap:conditionalText MadCap:conditions="SAP.SapOnlyOutput">event broker</MadCap:conditionalText> provider and SEMPv2 versions.<MadCap:conditionalText MadCap:conditions="SAP.SapHideFromOutput"> BETA versions of the <MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> provider are not supported in production environments.</MadCap:conditionalText> </p>
    <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" class="TableStyle-Table_Num" cellspacing="0">
      <col style="width: 25%;" class="TableStyle-Table_Num-Column-Column1"/>
      <col style="width: 25%;" class="TableStyle-Table_Num-Column-Column1"/>
      <col style="width: 25%;" class="TableStyle-Table_Num-Column-Column1"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1"><MadCap:variable name="Product-Names.pubsub_brand_only"/> Event Broker Version</th>
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1"><MadCap:variable name="Product-Names.pubsub_brand_only" MadCap:conditions="SAP.SapHideFromOutput"/> Event Broker Provider Version</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">SEMPv2 Version</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">10.8.1</td>
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">1.0</td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">2.41</td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1" MadCap:conditions="SAP.SapHideFromOutput">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">10.6.1</td>
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">0.9.3 (BETA)</td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">2.39</td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1" MadCap:conditions="SAP.SapHideFromOutput">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">10.4.1</td>
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">0.9.0 (BETA)</td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">2.36</td>
        </tr>
      </tbody>
    </table>
    <p class="Note">If you use an older <MadCap:variable name="Variables.CompanyName" MadCap:conditions="SAP.SapHideFromOutput"/> event broker provider with a newer event broker, you  will not have the option to configure the new resources that might come with the new event broker load. Similarly, for an older event broker with a newer <MadCap:variable name="Variables.CompanyName" MadCap:conditions="SAP.SapHideFromOutput"/> provider, you might have the ability to create resources that the event broker doesn’t support. In that case your Terraform configuration will fail since SEMP doesn’t have the ability to configure your request.</p>
  </body>
</html>

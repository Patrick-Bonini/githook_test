<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1>
      <MadCap:concept term="Cloud"/>
      <MadCap:variable name="Product-Names.cloud_agent_short"/>
    </h1>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> is required to deploy and manage <MadCap:variable name="Product-Names.cloud_product_short"/> <MadCap:variable name="Product-Names.broker_cloud_short"/>s. The <MadCap:variable name="Product-Names.cloud_agent_short"/> performs these functions:</p>
    <ul>
      <li>
        <p>Managing the lifecycle and configuration of <MadCap:variable name="Product-Names.broker_cloud_short"/>s in the deployment, including creation, deletion, updates, and configuration options on all <MadCap:variable name="Product-Names.broker_cloud_short"/>s in the data center</p>
      </li>
      <li>
        <p>Gathering system-level diagnostic information of the <MadCap:variable name="Product-Names.broker_cloud_short"/>s to send to the <MadCap:variable name="Product-Names.home_cloud_long"/> to allow for rapid response to address any issues. The information is provided solely to help with the recovery of <MadCap:variable name="Product-Names.broker_cloud_short"/>s. For more information, see <MadCap:xref href="#info-exchanged-home-cloud">Information Exchanged Between  the [%=Product-Names.home_cloud_long%] and the [%=Product-Names.cloud_agent_short%]</MadCap:xref></p>
      </li>
      <li>
        <p>Managing the lifecycle of the monitoring agents, which send metrics and monitoring data from <MadCap:variable name="Product-Names.broker_cloud_short"/> to the central monitoring service. This is required  for <MadCap:variable name="Product-Names.broker_cloud_short"/>s to be monitored and necessary for <MadCap:variable name="Product-Names.cloud_product_short"/> to function. For more information, see <MadCap:xref href="#info-exchanged-central-monitoring">Information Exchanged Between the [%=Product-Names.cloud_agent_short%] and the Centralized Monitoring Service</MadCap:xref>.</p>
      </li>
    </ul>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> resides in the same network where the <MadCap:variable name="Product-Names.broker_cloud_short"/>s are deployed. In the following architecture diagram, the red box highlights the <MadCap:variable name="Product-Names.cloud_agent_short"/>. </p>
    <p>
      <div class="thumbnail-container">
        <img class="solacethumbnail" src="../../Resources/Images/Cloud-Security/security_arch_missioncontrolagent.png" alt="Diagram of the Cloud architecture that highlights the Mission Control Agent."/>
      </div>
    </p>
    <p> The security measures applied to communication between the <MadCap:variable name="Product-Names.cloud_agent_short"/> and the <MadCap:variable name="Product-Names.home_cloud_long"/> include:<br/></p>
    <ul>
      <li>
        <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> always initiates the connection to the <MadCap:variable name="Product-Names.home_cloud_short"/>. It does not listen, nor accept incoming connections.</p>
      </li>
      <li>
        <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> never transmits any messaging data, schema information, or personal account information.</p>
      </li>
      <li>
        <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> receives management data, consisting of configuration information for the <MadCap:variable name="Product-Names.broker_cloud_short"/>s, and sends only metadata related to orchestrating an <MadCap:variable name="Product-Names.broker_cloud_short"/> and monitoring data related to system-level checks on the <MadCap:variable name="Product-Names.broker_cloud_short"/> components. For more information about the data shared, see <MadCap:xref href="#info-exchanged-home-cloud">Information Exchanged Between  the [%=Product-Names.home_cloud_long%] and the [%=Product-Names.cloud_agent_short%]</MadCap:xref></p>
      </li>
      <li>
        <p>The data exchanged between the <MadCap:variable name="Product-Names.cloud_agent_short"/> consists of information collected only from the <MadCap:variable name="Product-Names.broker_cloud_short"/>s that the <MadCap:variable name="Product-Names.cloud_agent_short"/> manages. </p>
      </li>
      <li>
        <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> authenticates with the <MadCap:variable name="Product-Names.home_cloud_short"/>, allowing it to connect securely to exchange information. The <MadCap:variable name="Product-Names.cloud_agent_short"/> does not require a public IP address.</p>
      </li>
      <li>
        <p>The information sent between the <MadCap:variable name="Product-Names.cloud_agent_short"/> and the <MadCap:variable name="Product-Names.home_cloud_short"/> is encrypted and can't be read by the cloud service providers (Amazon, Google, or Microsoft).</p>
      </li>
    </ul>
    <p> The <MadCap:variable name="Product-Names.cloud_agent_short"/> requires a minimal number of permissions to run within the customer's network to manage the lifcycle and configuration of <MadCap:variable name="Product-Names.broker_cloud_short"/>s.</p>
    <p>For more information about <MadCap:variable name="Product-Names.cloud_agent_short"/> security, see the following sections:</p>
    <ul>
      <li>
        <MadCap:xref href="#cloud-agent-installation">[%=Product-Names.cloud_agent_short%] Installation</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#info-exchanged-home-cloud">Information Exchanged Between  the [%=Product-Names.home_cloud_long%] and [%=Product-Names.cloud_agent_short%]</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#info-exchanged-central-monitoring">Information Exchanged Between the [%=Product-Names.cloud_agent_short%] and the Centralized Monitoring Service</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#info-exchanged-eventbrokerservices">Information Exchanged Between the [%=Product-Names.cloud_agent_short%] and [%=Product-Names.broker_cloud_short_title%]s</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#cloud-agent-connectivity">[%=Product-Names.cloud_agent_short%] Connectivity</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#required-permissions">Permissions Required for the [%=Product-Names.cloud_agent_short%]</MadCap:xref>
      </li>
    </ul>
    <h2 class="with-rule"><a name="cloud-agent-installation"/><MadCap:variable name="Product-Names.cloud_agent_short"/> Installation</h2>
    <p>During installation, the <MadCap:variable name="Product-Names.cloud_agent_short"/> is bootstrapped with the configuration it needs to manage <MadCap:variable name="Product-Names.broker_cloud_short"/>s in the customer's environment. This configuration includes:</p>
    <ul>
      <li>for private cloud deployments: 
            <ul><li>restricted IaaS credentials for the customer's virtual network or VPC</li><li>IaaS infrastructure
details, such as the names of the virtual network or VPC and subnets</li><li>SSH Key Pair (<code>.pem</code> file) used to configure cloud instances or virtual machines for <MadCap:variable name="Product-Names.broker_cloud_short"/>s</li></ul></li>
      <li>for Kubernetes deployments:
            <ul><li>the data center ID and target namespace</li><li>restricted service account credentials. This service-account is bound to a custom role with the minimum necessary permissions, which is scoped to the target namespace.</li><li>infrastructure details, such as the names of the primary, backup, and monitoring zones, configuration details for Datadog, and storage and load balancer parameters</li></ul></li>
    </ul>
    <p>Additionally, the customer data center is registered with the <MadCap:variable name="Product-Names.home_cloud_short"/> and is locked to the customer account.</p>
    <h2><a name="info-exchanged-home-cloud"/>Information Exchanged Between  the <MadCap:variable name="Product-Names.home_cloud_long"/> and the <MadCap:variable name="Product-Names.cloud_agent_short"/></h2>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> authenticates with the <MadCap:variable name="Product-Names.home_cloud_long"/> with basic authentication, allowing it to connect securely
            to the <MadCap:variable name="Product-Names.home_cloud_short"/> to exchange information. The <MadCap:variable name="Product-Names.cloud_agent_short"/> always initiates of the connection with the <MadCap:variable name="Product-Names.home_cloud_short"/>. The <MadCap:variable name="Product-Names.home_cloud_long"/> never initiates the call.</p>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> never transmits messaging data or any personal account information and never  exchange any access keys or credential information of any user. It send only control plane (management) information to the <MadCap:variable name="Product-Names.home_cloud_short"/>. </p>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> receives management data, consisting of configuration information for the <MadCap:variable name="Product-Names.broker_cloud_short"/>s, and shares only metadata related to orchestrating an <MadCap:variable name="Product-Names.broker_cloud_short"/> and monitoring data related to system-level checks on the <MadCap:variable name="Product-Names.broker_cloud_short"/> components that the <MadCap:variable name="Product-Names.cloud_agent_short"/> has permission to access.  </p>
    <p>The information that is exchanged between the <MadCap:variable name="Product-Names.home_cloud_short"/> and the <MadCap:variable name="Product-Names.cloud_agent_short"/> includes:</p>
    <ul>
      <li>
        <p><MadCap:variable name="Product-Names.broker_cloud_short_intitalcap"/>s — The metadata required to configure an <MadCap:variable name="Product-Names.broker_cloud_short"/>, including cloud instance, IaaS configuration details, configuration specifications (e.g., ARM templates, CloudFormation stacks), and upgrade the <MadCap:variable name="Product-Names.cloud_agent_short"/>. This includes responses codes and status information for <MadCap:variable name="Product-Names.home_cloud_short"/> initiated actions (upgrades, service creation and deletion, etc.), confirmation as to whether the action completed as intended are collected.</p>
      </li>
      <li>
        <p>Heartbeats — Health checks for various components of the <MadCap:variable name="Product-Names.broker_cloud_short"/>s are logged.</p>
      </li>
      <li>
        <p>Response codes and status — The <MadCap:variable name="Product-Names.home_cloud_short"/> initiated actions (upgrades, service creation and deletion, etc.), confirmation as to whether the action completed as intended are collected.</p>
      </li>
      <li>
        <p>Commands — Only high-level commands to create, configure, and manage <MadCap:variable name="Product-Names.broker_cloud_short"/>s are exchanged.</p>
      </li>
      <li>
        <p>DNS configuration — The <MadCap:variable name="Product-Names.cloud_agent_short"/> coordinates DNS configuration with the <MadCap:variable name="Product-Names.home_cloud_short"/>. This information is necessary to communicate with the <MadCap:variable name="Product-Names.broker_cloud_short"/>s.</p>
      </li>
      <li>
        <p>Certificates — The <MadCap:variable name="Product-Names.home_cloud_short"/> provides the signed URL to the <MadCap:variable name="Product-Names.cloud_agent_short"/> to allow the <MadCap:variable name="Product-Names.cloud_agent_short"/> to load the server certificates to the <MadCap:variable name="Product-Names.broker_cloud_short"/>s.</p>
      </li>
      <li>
        <p>Diagnostic information — The <MadCap:variable name="Product-Names.cloud_agent_short"/> collects and shares diagnostic information to assist with incident handling. No personal information is collected as part of the diagnostic information.</p>
      </li>
    </ul>
    <p>For more detailed information about the data exchanged between <MadCap:variable name="Product-Names.cloud_agent_short"/> and the <MadCap:variable name="Product-Names.home_cloud_short"/>, <a href="../../get-support.htm" target="_blank" class="link-internal">contact <MadCap:variable name="Variables.CompanyName"/></a>.</p>
    <h2><a name="info-exchanged-central-monitoring"/>Information Exchanged Between the <MadCap:variable name="Product-Names.cloud_agent_short"/> and the Centralized Monitoring Service</h2>
    <p><MadCap:variable name="Variables.CompanyName"/> uses the Datadog cloud application for its central monitoring service component. The Datadog agent is the monitoring component that resides in a deployment. There is one Datadog agent per  <MadCap:variable name="Product-Names.broker_cloud_short"/>. For more details, see  <MadCap:xref href="../Deployment-Considerations/deployment-architecture-k8s.htm">Deployment Architecture for Kubernetes</MadCap:xref>.</p>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> configures the Datadog agents for monitoring, but no other information is exchanged.  The Datadog agents collect  and send monitoring information (logs and metrics) to the central monitoring service about an <MadCap:variable name="Product-Names.broker_cloud_short"/> and metrics about the <MadCap:variable name="Product-Names.cloud_agent_short"/>.  For more details about the central monitoring service, see <MadCap:xref href="security-centralized-monitoring-service.htm">Understanding the Centralized Monitoring Service</MadCap:xref>.</p>
    <h2><a name="info-exchanged-eventbrokerservices"/><MadCap:variable name="Product-Names.cloud_agent_short"/> Communication within the Kubernetes Cluster</h2>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> communicates with various Kubernetes cluster components, which includes the <MadCap:variable name="Product-Names.broker_cloud_short"/>s deployed in the cluster. </p>
    <ul>
      <li>
        <p>The communication with the <MadCap:variable name="Product-Names.broker_cloud_short"/>s consists of information exchanged to manage their lifecycle and configuration operations that includes creating, deleting, updating, and configuring <MadCap:variable name="Product-Names.broker_cloud_short"/>s. This communication  uses a combination of SEMPv1, SEMPv2, and <MadCap:variable name="Product-Names.solace_cli"/> commands (via Kubernetes <code>exec</code> mode).</p>
      </li>
      <li>
        <p>Communication within the Kubernetes cluster is for Kubernetes API and kubelets.</p>
      </li>
    </ul>
    <p>The following table shows the destination ports that are used within the Kubernetes cluster (source ports are ephemeral):</p>
    <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');margin-left: 0;margin-right: auto;" class="TableStyle-Table_Num" cellspacing="0">
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <col class="TableStyle-Table_Num-Column-Column1"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Port</th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Requirement Within Kubernetes Cluster</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">1943 </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
            <p>This port is required for communication between the <MadCap:variable name="Product-Names.broker_cloud_short"/>s and the <MadCap:variable name="Product-Names.cloud_agent_short"/> to manage lifecycle operations.</p>
            <p> External SEMP requests are that are received on port 943 are forwarded to 1943 to the containers for the <MadCap:variable name="Product-Names.broker_cloud_short"/>s.</p>
          </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">443 </td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">This standard port is required for interaction between the <MadCap:variable name="Product-Names.cloud_agent_short"/> and the Kubernetes API that is required for control plane operations to manage <MadCap:variable name="Product-Names.broker_cloud_short"/>s. </td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">6443 </td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
            <p>This standard port is required for communication of between the <MadCap:variable name="Product-Names.cloud_agent_short"/> and kubelets (including <code>exec kubectl</code>) required for control plane operations to manage <MadCap:variable name="Product-Names.broker_cloud_short"/>s.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="Note">Port 1943 must be enabled <b>within</b> the Kubernetes cluster, however Port 1943 does not need to be enabled for <b>incoming connections</b> to the Kubernetes cluster for <MadCap:variable name="Product-Names.broker_cloud_short"/>s.</p>
    <p>
      <MadCap:conditionalText MadCap:conditions="Default.HideFromAllOutput"><b>Writers Note not to share</b>: Fact: Authentication is only basic authentication and there are no plans to use OAuth. The reason is because it's within the cluster and if you've broken into the cluster, you have more serious security concerns where this won't help much. James Ellwood did not want us to mention this fact.</MadCap:conditionalText>
    </p>
    <h2><a name="cloud-agent-connectivity"/><MadCap:variable name="Product-Names.cloud_agent_short"/> Connectivity</h2>
    <p>Connectivity for the <MadCap:variable name="Product-Names.cloud_agent_short"/> does not require a public IP address and the <MadCap:variable name="Product-Names.cloud_agent_short"/> always initiates the connection to the <MadCap:variable name="Product-Names.home_cloud_long"/>. The <MadCap:variable name="Product-Names.cloud_agent_short"/> communicates with the <MadCap:variable name="Product-Names.home_cloud_short"/> in the following ways:</p>
    <ul>
      <li>
        <p>securely over port 55443 using the Solace Message Format (SMF) protocol over TCP</p>
      </li>
      <li>
        <p>Securely over HTTP port 443 during installation and bootstrapping. This is also how the docker image for the <MadCap:variable name="Product-Names.cloud_agent_short"/> is retrieved from the <MadCap:variable name="Variables.CompanyName"/> registry for Kubernetes installations</p>
      </li>
    </ul>
    <p>For Kubernetes deployments, Docker images are part of a deployment. The Docker images that are used in deployment are available via Kubernetes to the <MadCap:variable name="Product-Names.solace_container_registry"/> (<code>gcr.io</code>) through port 443 (secure port). Having the Docker images available in the <code>gcr.io</code> is ideal if your security policies require that all images are scanned prior to deployment.</p>
    <p MadCap:conditions="SAP.SapHideFromOutput">For VM-based deployments on AWS and Azure, security updates are delivered on port 80 for the <MadCap:variable name="Product-Names.cloud_agent_short"/>'s EC2/VM image. If your security policies don't permit port 80 to be accessible, the <MadCap:variable name="Product-Names.cloud_agent_short"/> EC2 (for AWS) or VM (for Azure) must be periodically recreated with an updated AMI/VM to obtain the latest security patches. <a href="../../get-support.htm" target="_blank" class="link-internal">Contact <MadCap:variable name="Variables.CompanyName"/></a>  to obtain an updated AMI/VM.</p>
    <MadCap:snippetBlock src="../../Resources/Snippets/CloudDeployment/vmbased-deprecation-warning.flsnp" MadCap:conditions="SAP.SapHideFromOutput"/>
    <h2><a name="required-permissions"/>Permissions Required for the <MadCap:variable name="Product-Names.cloud_agent_short"/></h2>
    <p>The <MadCap:variable name="Product-Names.cloud_agent_short"/> requires a service account with the specific permissions. The service account requires a minimal set of permissions that permit the <MadCap:variable name="Product-Names.cloud_agent_short"/> to manage and configure <MadCap:variable name="Product-Names.broker_cloud_short"/>s and communicate with the <MadCap:variable name="Product-Names.home_cloud_long"/>.</p>
    <p>Depending on the deployment chosen, the following permissions are required for the <MadCap:variable name="Product-Names.cloud_agent_short"/>:</p>
    <dl>
      <dt><a name="kubernetes-permissions"/>Kubernetes</dt>
      <dd>The permissions listed below apply to all Kubernetes-based deployments that include Amazon Elastic Kubernetes Service (<a href="../Deployment-Considerations/installing-ps-cloud-k8s-eks-specific-req.htm" class="link-internal">EKS</a>), Azure Kubernetes Service (<a href="../Deployment-Considerations/installing-ps-cloud-k8s-aks-specific-req.htm" class="link-internal">AKS</a>), and Google Kubernetes Engine (<a href="../Deployment-Considerations/installing-ps-cloud-k8s-gke-specific-req.htm" class="link-internal">GKE</a>).</dd>
      <dd>
        <MadCap:snippetBlock src="../../Resources/Snippets/CloudDeployment/kubernetes_mca_permissions.flsnp"/>
      </dd>
      <dt MadCap:conditions="SAP.SapHideFromOutput">Amazon Web Services (AWS)—VM-Based Deployments Only</dt>
      <dd>
        <MadCap:snippetBlock src="../../Resources/Snippets/CloudDeployment/vmbased-deprecation-warning.flsnp" MadCap:conditions="SAP.SapHideFromOutput"/>
      </dd>
      <dd MadCap:conditions="SAP.SapHideFromOutput">The permissions below apply to VM-based deployments. For permissions for Amazon Elastic Kubernetes Service (EKS), see the required <a href="#kubernetes-permissions" class="link-internal">Kubernetes permissions</a>.</dd>
      <dd MadCap:conditions="SAP.SapHideFromOutput">
        <MadCap:snippetBlock src="../../Resources/Snippets/CloudDeployment/aws_mca_permissions.flsnp"/>
      </dd>
      <dt MadCap:conditions="SAP.SapHideFromOutput">Azure—VM-Based Deployments Only</dt>
      <dd>
        <MadCap:snippetBlock src="../../Resources/Snippets/CloudDeployment/vmbased-deprecation-warning.flsnp" MadCap:conditions="SAP.SapHideFromOutput"/>
      </dd>
      <dd>
        <p MadCap:conditions="SAP.SapHideFromOutput">The permissions below apply to VM-based deployments in Azure. For permissions for Azure Kubernetes Service (AKS), see the required <a href="#kubernetes-permissions" class="link-internal">Kubernetes permissions</a>.</p>
      </dd>
      <dd MadCap:conditions="SAP.SapHideFromOutput">
        <MadCap:snippetBlock src="../../Resources/Snippets/CloudDeployment/azure_mca_permissions.flsnp"/>
      </dd>
    </dl>
  </body>
</html>

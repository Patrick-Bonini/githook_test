<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    </head>
  <body>
    <h1>Consuming Messages from a Queue </h1>
    <p>In this tutorial you'll learn how to consume guaranteed messages from the queue you created in  <MadCap:xref href="ggs_queue.htm">Creating Your First  Queue</MadCap:xref>. To consume guaranteed messages, you connect to the <MadCap:variable name="Product-Names.broker_cloud_short"/> and choose the queue to consume from. </p>
    <p>The Try-Me! in the Cloud Console doesn't include the ability to connect to a queue, so you'll use the Try Me! feature in <MadCap:variable name="Product-Names.pubsubmanager_long"/>. </p>
    <p>This tutorial shows you how to: </p>
    <ol>
      <li>
        <p>
          <MadCap:xref href="#Connecti">Connect to [%=Product-Names.pubsubmanager_short%] and Use Credentials in the Try-Me!</MadCap:xref>
          <a href="#Connecti"> </a>
        </p>
      </li>
      <li>
        <p>
          <MadCap:xref href="#Understa">Understanding the Queues End-to-End</MadCap:xref>
          <a href="#Understa"> </a>
        </p>
      </li>
    </ol>
    <h2 class="with-rule">Before You Begin</h2>
    <p>Complete the previous tutorial,  <MadCap:xref href="ggs_queue.htm">Creating Your First  Queue</MadCap:xref>.</p>
    <h2 class="with-rule"><a name="Connecti"/>Connect to <MadCap:variable name="Product-Names.pubsubmanager_short"/> and Consume Messages</h2>
    <p>To try out consuming messages from a queue, we'll use the <b>Try-Me!</b> tool in Broker Manager to connect to the event broker and bind to the queue.</p>
    <ol>
      <li>
        <MadCap:snippetBlock src="../Resources/Snippets/Cloud/Task_UI_Snippets/login_console.flsnp">
                </MadCap:snippetBlock>
      </li>
      <li>From the navigation bar, select <b>Cluster Manager</b><img src="../Resources/Images/Cloud/reusable-icons/navbar_cluster_manager.png"/>. </li>
      <li>Select the <MadCap:variable name="Product-Names.broker_cloud_short"/> that you want to configure.</li>
      <li>On the <b>Service Details</b> page, select the <b>Try Me!</b> tab.</li>
      <li>Click <b>Open </b><MadCap:variable name="Product-Names.pubsubmanager_long" style="font-weight: bold;"/>.</li>
      <li>In <MadCap:variable name="Product-Names.pubsubmanager_short"/>, on the left navigation bar, select <b>Try Me!</b>.</li>
      <li>In the <b>Publisher</b> panel, in the <b>Establish Connection</b> section, click the expand icon <img src="../Resources/Images/Cloud/reusable-icons/expand-arrow.png" style="width: 18px;height: 18px;"/>.</li>
      <li>Connect to the <MadCap:variable name="Product-Names.broker_cloud_short"/> by entering the connection information from the <b>Service Details</b> page:</li>
      <ol style="list-style-type: lower-alpha;">
        <li> Copy the value for <b>Client Username</b> and paste it into the<b> Client Username</b> field. </li>
        <li>Copy the value for <b>Client Password</b> and paste it into the <b>Client Password</b> field</li>
      </ol>
      <li>In the <b>Subscriber</b> panel, in the <b>Establish Connection</b> section, click the expand icon <img src="../Resources/Images/Cloud/reusable-icons/expand-arrow.png" style="width: 18px;height: 18px;"/> and make sure that <b>Same as Publisher</b> is selected for each field. </li>
      <li>Under the <b>Publisher</b> panel, click <b>Connect</b>. Once the connection is established, in the <b>Subscriber</b> panel, click <b>Connect</b>.</li>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Connection-Information.png" class="solacethumbnail"/>
        </div>
      </p>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Broker-Manager-Connection-Information.png" class="solacethumbnail"/>
        </div>
      </p>
      <li>In the <b>Subscriber</b> panel, click <b>Bind to an endpoint to receive guaranteed messages</b>  to expand the section.</li>
      <p>
        <img src="../Resources/Images/Broker-Manager/Broker-Manager-Binding-Endpoint.png" class="img-border"/>
      </p>
      <li> If you changed the Subscriber queue to a queue you created on the event broker service, make sure to change the Publisher queue to match it.</li>
      <p>
        <img src="../Resources/Images/Broker-Manager/Broker-Manager-Publisher-Matching.png" class="img-border"/>
      </p>
      <li>Under <b>Publisher</b>, click <b>Publish</b>. The messages appear at the bottom of the <b>Subscriber</b> panel. </li>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Broker-Manager-consuming-guaranteed-messages-from-queue.png" class="solacethumbnail"/>
        </div>
      </p>
      <li>To consume guaranteed messages from a <b>Queue</b>, type the name of the queue and click <b>Start Consume</b>. For example, use the default queue name or the name of the queue you created in the previous tutorial.<p><img src="../Resources/Images/Broker-Manager/Broker-Manager-Targeted-Queue.png" class="img-border"/></p></li>
      <li>To stop consuming messages from the queue, click <b>Stop Consume</b>. </li>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Broker-Manager-stop-consume.png" class="solacethumbnail"/>
        </div>
      </p>
    </ol>
    <h2 class="with-rule"><a name="Understa"/>Understand How Queues Store Messages</h2>
    <p>When a subscriber is not connected to the queue, the queue stores any messages it receives to send them to the subscriber when it reconnects. Guaranteed messages are not lost because the queue retains the message until the subscriber can receive them.</p>
    <p style="font-weight: normal;">In the last step of the previous task, you stopped consuming messages, which simulates the subscriber stopping the connection to the queue. To see how queues store messages, perform these steps: </p>
    <ol>
      <li>
        <p>In <MadCap:variable name="Product-Names.pubsubmanager_short"/>, in the left navigation bar, select <b>Queues</b>, then select the <b>Queues</b> tab to see the status of your queue. You should see in the <b>Consumers</b> column that there are zero consumers.</p>
      </li>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Messages-and-consumer-queued-A1.png" class="solacethumbnail"/>
        </div>
      </p>
      <li>In the left navigation bar, select <b>Try Me!</b></li>
      <li>If necessary, re-establish a connection for the publisher, and then publish three persistent messages.</li>
      <li>Return to the queue by selecting <b>Queues</b> in the left navigation bar. You should see that there are now three messages shown in the <b>Messaged Queued (msgs)</b> column.</li>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Messages-and-consumer-queue-A2.png" class="solacethumbnail"/>
        </div>
      </p>
      <li>Restore the connection between the queue and the subscriber. On left navigation, select the <b>Try Me!</b> tab, and under <b>Subscriber</b>, expand <b>Bind to an endpoint to receive guaranteed messages</b> and click <b>Start Consume</b>.</li>
      <p>The stored messages in the queue are immediately sent and consumed by the subscriber.</p>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Messages-consumed.png" class="solacethumbnail"/>
        </div>
      </p>
      <li>Return to the queue again by selecting <b>Queues</b> in the left navigation bar. You should see: </li>
      <ul style="list-style-type: circle;">
        <li>The <b>Messages Queued (msgs)</b> column displays zero because the messages have been sent to the subscriber.</li>
        <li>The <b>Consumers</b> column displays 1 because the subscriber is consuming messages. </li>
      </ul>
      <p>
        <div class="thumbnail-container">
          <img src="../Resources/Images/Broker-Manager/Messages-and-consumer-queued-A3.png" class="solacethumbnail"/>
        </div>
      </p>
    </ol>
    <h2 class="with-rule">Next Steps</h2>
    <p>You learned how to obtain the credentials to connect to <MadCap:variable name="Product-Names.broker_cloud_short"/>, how to consume messages, and how messages are queued. After, you learned how the queue prevents the loss of messages, and the behaviors associated with it. </p>
    <ul>
      <li>Learn how to <a href="Event-Portal/get-started-event-portal-designer.htm" class="link-internal">start designing an event-driven architecture using <MadCap:variable name="Product-Names.eventportal_product_short"/></a>.</li>
      <li>See the other APIs you can use for <MadCap:xref href="gqs_building_apps.htm">Developing Applications with <MadCap:variable name="Product-Names.cloud_product_short"/>.</MadCap:xref></li>
      <li MadCap:conditions="SAP.SapHideFromOutput">Learn how to manage your <MadCap:variable name="Product-Names.broker_cloud_short"/> with <MadCap:xref href="../Admin/SEMP/Using-SEMP.htm">SEMP.</MadCap:xref></li>
    </ul>
    <p MadCap:conditions="SAP.SapHideFromOutput"> </p>
    <p MadCap:conditions="SAP.SapHideFromOutput"> </p>
    <p> </p>
    <p> </p>
  </body>
</html>

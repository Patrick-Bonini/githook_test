<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    </head>
  <body>
    <h1><MadCap:concept term="Cloud"/>Schemas</h1>
    <p>A schema defines the structure and meaning of each data value in the payload of an event so that the publisher and all subscribers understand the structure and what each value means. Some events can use a primitive schema when, for example, all values in the event are boolean or integers. For events that require a complex schema that defines various data attributes and their relationships, you can create or import existing payload schema definitions in JSON, XSD, DTD, Avro, and Protobuf format.</p>
    <p>Complex schemas can reference other schemas as long as both schemas have the same schema type and they are both shared or, if the schemas are not shared, they are both in the same application domain.</p>
    <p>You can create new schemas in <MadCap:variable name="Product-Names.ep_designer"/> and you can add schemas to <MadCap:variable name="Product-Names.ep_designer"/> by importing  Confluent subjects from your runtime data in <MadCap:variable name="Product-Names.ep_rt_event_manager"/>. For more information, see <MadCap:xref href="event-portal-audit-runtime-data.htm#Importing_Kafka_Objects">Importing Kafka Objects</MadCap:xref>.</p>
    <p>This section includes the following tasks:</p>
    <ul>
      <li>
        <MadCap:xref href="#create-schema">Creating a Schema</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#multiple-schema-version">Updating a Schema</MadCap:xref>
      </li>
      <li>
        <MadCap:xref href="#state_change_schema">Changing the State of a Schema Version</MadCap:xref>
      </li>
    </ul>
    <p>You can also create custom attributes for schemas. For more information, see <MadCap:xref href="event-portal-designer-tool.htm#Using_Custom_Attributes">Using Custom Attributes.</MadCap:xref></p>
    <p>You can also move schemas to a different application domain. For more information, see <MadCap:xref href="event-portal-designer-application-domains.htm#Move_Objects" target="_blank">Moving Objects Between Application Domains</MadCap:xref></p>
    <h2 class="with-rule"><a name="create-schema"/>Creating a Schema</h2>
    <p>To create a schema in <MadCap:variable name="Product-Names.ep_designer"/>, perform these steps:</p>
    <ol>
      <li><MadCap:snippetText src="../../Resources/Snippets/Cloud/Task_UI_Snippets/login_console.flsnp"/><![CDATA[
               ]]></li>
      <li>On the navigation bar, select <MadCap:variable name="Product-Names.ep_designer" style="font-weight: bold;"/><img src="../../Resources/Images/Cloud/reusable-icons/navbar_designer.png" alt=""/>. </li>
      <li>On the <b>Application Domains</b> page, click the application domain that you want to add a schema to.</li>
      <li>Click <b>Components </b><img src="../../Resources/Images/Cloud/reusable-icons/designer-list.png" alt=""/> to switch to the list view.</li>
      <li>
        <p>Select the <b>Schemas</b> tab then click <b>Create Schema</b>.</p>
        <p>
          <div class="thumbnail-container">
            <img src="../../Resources/Images/Event-Portal/create-schema.png" alt="Screenshot showing the settings described in the surrounding steps." class="solacethumbnail"/>
          </div>
        </p>
      </li>
      <li>Enter a <b>Name</b> for the schema. </li>
      <li>Select the <b>Schema Type</b>. The <b>Schema Type</b> can be JSON Schema, XSD, DTD, AVRO, or Protobuf.</li>
      <li>If you want events and schemas in other application domains to be able to reference this schema, select <b>Allow Schema to be shared across application domains</b>. </li>
      <li>(Optional) Add values for any schema custom attributes that have been set up in your organization.</li>
      <li>In the <b>Version</b> field, specify a semantic version value for the schema in the format major.minor.patch. The default is 0.1.0.</li>
      <li>(Optional) Enter a <b> Version Name</b> for the initial version of the schema .</li>
      <li>(Optional) Enter a <b>Description</b> for the schema. The <b>Description</b> field supports Markdown. Click <b>toggle preview</b><img src="../../Resources/Images/Cloud/reusable-icons/markdown-html-toggle.png" alt=""/> to preview the rendered text.</li>
      <li>(Optional) Add values for any schema version custom attributes that have been set up in your organization.</li>
      <li>In the <b>Content</b> field enter the schema definition or click <b>Import From File</b> to import an existing schema definition.</li>
      <li>(Optional) To reference another schema in <MadCap:variable name="Product-Names.eventportal_product_short"/>, perform these steps:<ol style="list-style-type: lower-alpha;"><li>Click <b>Manage Referenced Schemas</b>.</li><li>Locate the schema you want to reference. The list shows schemas of the same type in the same application domain, and shared schemas from other application domains that you have access to. You can search by name and filter the list by application domain. If you selected <b>Allow Schema to be shared across application domains</b>, only shared schemas appear in the list. You can click the name of the schema to view more details.</li><li>Click <b>Add</b> next to the schema version that you want to reference.</li><li>If it's not already part of the schema definition, in the <b>Content</b> field, add a reference to the schema. For example, in a JSON schema, add <code>"schema_parameter": { "$ref": "/path/referenced_schema" }</code> for a schema parameter that references another schema.</li></ol></li>
      <li>Click <b>Save Schema</b>.</li>
    </ol>
    <h2><a name="multiple-schema-version"/>Updating a Schema</h2>
    <p>When you update a schema, you can update an existing version or create a new version of the schema. Versions allow you to work on updates and test new versions in development and staging environments while latest stable version remains in the production environment. Each version also has a lifecycle state. You can only edit versions that are in Draft state. For more information, see <MadCap:xref href="../../Cloud/Event-Portal/event-portal-overview.htm#Versioning">Object Versions and Lifecycle States</MadCap:xref>.</p>
    <MadCap:snippetBlock src="../../Resources/Snippets/Cloud/Event-Portal/versioning-definition.flsnp"/>
    <p>If you  <a href="event-portal-audit-runtime-data.htm#Importing_Kafka_Subjects" target="_blank" class="link-internal">import a schema into <MadCap:variable name="Product-Names.eventportal_product_short"/></a> from a Confluent Schema Registry, the imported schema uses the registry version number as the major version. For example, version 1 in the registry is imported as version 1.0.0 in <MadCap:variable name="Product-Names.ep_designer"/>. You can change the version number, version name, description, and custom attributes of imported schema versions in <MadCap:variable name="Product-Names.ep_designer"/>, but you can't update the schema content or the list of referenced schemas. If necessary, you can create a new version of the schema object in <MadCap:variable name="Product-Names.ep_designer"/> and update the new version. If you do add a version or change a version number in Designer, <MadCap:variable name="Variables.CompanyName"/> recommends incrementing the minor or patch version number to avoid potential conflicts with future imported versions. </p>
    <p>If allowed for objects in the application domain, the description of a schema version can be edited at any lifecycle state. This option allows you to add information to the description such as deprecation and retirement dates and notes about the object's functionality or runtime behavior.</p>
    <p>To update a schema, perform these steps:</p>
    <ol>
      <li>On the <b>Application Domains</b> page,click the application domain that contains the scheme you want to update.</li>
      <li>Click <b>Components </b><img src="../../Resources/Images/Cloud/reusable-icons/designer-list.png" alt=""/> to switch to the list view.</li>
      <li>Select the <b>Schemas</b> tab.</li>
      <li>In the list of schemas, click <b>More Actions</b><img src="../../Resources/Images/Cloud/reusable-icons/more_actions_ellipsis.png" alt=" "/>for the schema you that want to update and select <b>Open Schema</b>.</li>
      <li>Perform one of the following actions:</li>
      <ul>
        <li>In the <b>Versions</b> list, click <b>More Actions</b><img src="../../Resources/Images/Cloud/reusable-icons/more_actions_ellipsis.png" alt=" "/>for the version that you want to update and select <b>Edit</b>. Any changes you make update that version of the schema. You can edit a schema version only if it is in Draft state.</li>
        <li>In the <b>Versions</b> list, click <b>More Actions</b><img src="../../Resources/Images/Cloud/reusable-icons/more_actions_ellipsis.png" alt=" "/>for the version that you want to update and select <b>Duplicate</b>. All properties of the existing version are copied into a new version. By default, the new version number is incremented by 0.0.1. You can change the version number to any number not already in use.</li>
        <li>Above the <b>Versions</b> list, click <b>Add</b><img src="../../Resources/Images/Cloud/reusable-icons/ep_add_icon.png" alt=""/>to create a new version of the schema without duplicating an existing version. By default, the new version number is the next unused major version. You can change the version number to any number not already in use.</li>
      </ul>
      <li>Update the schema version details as necessary.</li>
      <li>Click <b>Save Version</b> or <b>Save &amp; Close</b>.</li>
    </ol>
    <h2><a name="state_change_schema"/>Changing the State of a Schema Version</h2>
    <p>When you create a new version of a schema, the version is in Draft state. When the version is ready, you can change the version state to Released. When you release a new version of a schema, you may also want to change older versions of the schema to Deprecated or Retired. You must have at least the <MadCap:variable name="Product-Names.ep_user"/> role with Manager level access to the application domain to change the version state.  For more information, see <MadCap:xref href="../../Cloud/Event-Portal/event-portal-overview.htm#Versioning">Object Versions and Lifecycle States.</MadCap:xref></p>
    <p>You must change a schema out of Draft state before you can change any events or other schemas that reference it out of Draft state. If you want to retire a schema version, you must first retire all event versions and other schema versions that reference it.</p>
    <p>To change the state of a schema version, perform these steps:</p>
    <ol>
      <li>On the <b>Application Domains</b> page,click the application domain that contains the scheme you want to update.</li>
      <li>Click <b>Components </b><img src="../../Resources/Images/Cloud/reusable-icons/designer-list.png" alt=""/> to switch to the list view.</li>
      <li>Select the <b>Schemas</b> tab.</li>
      <li>In the list of schemas, click <b>More Actions</b><img src="../../Resources/Images/Cloud/reusable-icons/more_actions_ellipsis.png" alt=" "/>for the schema that you want to update and select <b>Open Schema</b>.</li>
      <li>Select the version that you want to change the state of, then click <b>Manage Lifecycle</b>.</li>
      <li>Select the new state.</li>
      <li>(Optional) If you set the <b>State</b> to <b>Deprecated</b> or <b>Retired</b>, set the <b>End of Life</b> date. If you set a planned or actual <b>End of Life</b> date, the date displays in the version details.</li>
      <li>Click <b>Save</b>.</li>
    </ol>
  </body>
</html>

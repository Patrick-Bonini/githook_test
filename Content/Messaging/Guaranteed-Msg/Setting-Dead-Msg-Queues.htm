<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head/>
  <body>
    <h1>Configuring Dead Message Queues</h1>
    <MadCap:snippetBlock src="../../Resources/Snippets/BrokerManager/Context/dmq-desc.flsnp"/>
    <h2 class="with-rule"><a name="Setting-the-DMQ"/>Configuring a DMQ</h2>
    <p>This section provides information to configure DMQs using <MadCap:variable name="Product-Names.solace_cli"/>. For information about configuring DMQs in <MadCap:variable name="Product-Names.pubsubmanager_long"/>, see <a href="../../Cloud/Broker-Manager/configuring-dmqs-broker-manager.htm" class="link-internal">Configuring Dead Message Queues for <MadCap:variable name="Product-Names.cloud_product_short"/></a> or <a href="../../Admin/Broker-Manager/configuring-dmqs-broker-manager.htm" class="link-internal">Configuring Dead Message Queues for <MadCap:variable name="Product-Names.broker_sw_short"/>s and <MadCap:variable name="Product-Names.broker_appliance_short"/>s</a>.</p>
    <p>To assign a specific DMQ for a durable queue, enter the following CONFIG command:
                <p class="Code">solace(configure/message-spool/queue)# dead-message-queue &lt;name&gt;</p></p>
    <p>To assign a specific DMQ for a durable topic endpoint, enter the following CONFIG command:
                <p class="Code">solace(configure/message-spool/topic-endpoint)# dead-message-queue &lt;name&gt;</p></p>
    <p><u>Where</u>:</p>
    <p><code>&lt;name&gt;</code> is the name of an existing queue on the same Message VPN as the given endpoint.</p>
    <p>The <code>no</code> version of this command, <code>no dead-message-queue</code>, resets the endpoint's assigned DMQ to the default of <code>#DEAD_MSG_QUEUE</code>.</p>
    <div class="Caution">
      <p class="Tbl_Body"> Moving messages to the DMQ while new messages are also being spooled could consume a large amount of event broker spool resources. Solace recommends that there always be an online consumer connected to a DMQ for expired messages to reduce overall event broker spool usage requirements.</p>
    </div>
    <h2><a name="Set-DMQ-endpoint-templates"/>Setting the DMQ through Endpoint Templates</h2>
    <p>You can assign a specific DMQ for client created endpoints using an endpoint template. When client created endpoints are created dynamically using an API, the endpoint name will be matched to the endpoint template. Take a look at <MadCap:xref href="Endpoint-Templates.htm">Endpoint Templates</MadCap:xref> for more information.</p>
    <p>To assign a specific DMQ for a client created queue using a queue template, enter the following CONFIG command:
                <p class="Code">solace(configure/message-spool/queue-template)# dead-message-queue &lt;name&gt;</p></p>
    <p>To assign a specific DMQ for a client created topic endpoint using a topic endpoint template, enter the following CONFIG command:
                <p class="Code">solace(configure/message-spool/topic-endpoint-template)# dead-message-queue &lt;name&gt;</p></p>
    <p><u>Where</u>:</p>
    <p><code>&lt;name&gt;</code> is the name of an existing queue on the same Message VPN as the given endpoint.</p>
    <p>The <code>no</code> version of this command, <code>no dead-message-queue</code>, resets the endpoint's assigned DMQ to the default of <code>#DEAD_MSG_QUEUE</code>.</p>
    <h2 class="with-rule"><a name="set-dmq-eligibility"/>Setting DMQ Eligibility and TTL</h2>
    <h4>Setting DMQ-eligibility</h4>
    <p>AÂ message's DMQ-eligibility is set by the publishing client. For more information:</p>
    <ul>
      <li>on Solace messaging APIs, see <MadCap:xref href="../../API/API-Developer-Guide/Creating-Messages-1.htm#DMQ-Elig">Dead Message Queue Eligibility</MadCap:xref>.</li>
      <li>on Solace REST messaging, see <MadCap:xref href="../../API/RESTMessagingPrtl/Solace-REST-Message-Encoding.htm#_Toc426703633">Solace-Specific HTTP Headers </MadCap:xref> on setting <code>Solace-DMQ-Eligible</code>.</li>
      <li>on JMS APIs, see <MadCap:xref href="../../API/Solace-JMS-API/Setting-Message-Properties.htm#Dead">Dead Message Queue Eligibility</MadCap:xref></li>
      <li>for AMQP 1.0, every message is DMQ-eligible</li>
    </ul>
    <h4>Setting TTL</h4>
    <p>A message's TTL value may also be set by a publishing client, and / or it may also have a <code>max-ttl</code> value, which an endpoint can set when it receives the message.</p>
    <h2 class="with-rule"><a name="dmq-feature-interactions"/>Feature Interactions</h2>
    <MadCap:snippetBlock src="../../Resources/Snippets/Features/dmq-feature-interaction.flsnp"/>
  </body>
</html>

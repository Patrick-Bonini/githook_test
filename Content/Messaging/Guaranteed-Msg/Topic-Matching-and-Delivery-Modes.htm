<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
  <head>
    <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" MadCap:stylesheetType="table"/>
  </head>
  <body>
    <h1><MadCap:concept term="Cloud;Appliance;Software"/>Topic Matching and Message Delivery Modes</h1>
    <p>When a <MadCap:variable name="Product-Names.pubsub_brand_only"/> event broker using Guaranteed messaging receives messages published to a topic, it can automatically change the delivery mode of the messages to accommodate the persistence requirements of an endpoint or a direct client subscription when there is a topic match. Changing message delivery modes is known as message promotion and demotion.</p>
    <MadCap:snippetBlock src="../../Resources/Snippets/message-prom-dem-caution.flsnp"/>
    <h2>Examples</h2>
    <h3> Direct Message Published to a Topic Matching a Subscription Set for an Endpoint </h3>
    <p>A client application may publish a Direct message to a topic that matches a topic subscription set for a queue or a topic endpoint on the event broker. Because an endpoint can only accept Guaranteed messages (persistent and non‑persistent), the event broker changes the messageʼs delivery mode to non-persistent so that the endpoint can receive it. When a client publishes a message as Direct, the message is not acknowledged back to the client. However, when the message’s delivery mode is changed to non‑persistent and the message is spooled to the endpoint, the message then acts as a Guaranteed message and an acknowledgment from the receiving client is provided to the event broker.</p>
    <p MadCap:conditions="SAP.SapHideFromOutput">For an illustration of how the delivery mode of a message published as Direct can change if it matches a topic assigned to an endpoint, see <MadCap:xref class="Num_And_Name_And_Page" href="../../API/API-Developer-Guide/Publishing-Direct-Messages.htm#publishing_direct_messages_2102779381_656733">Publishing Direct Messages</MadCap:xref>.</p>
    <h3>Event Broker Receives a Persistent Message Published to a Topic</h3>
    <p>When an event broker receives a persistent message published to a topic, it delivers the message to any endpoints that have matching topic subscriptions. However, because topic subscriptions registered for individual clients are for Direct messages, the event broker can change the message’s delivery mode to Direct and send it to those clients with matching topic subscriptions. In this scenario, because the client published the message as persistent, the message is acknowledged back to the publishing client.</p>
    <p>The only way for a client to receive persistent messages is to either bind to a durable topic endpoint or queue, or request that a non-durable queue or topic endpoint be created for it.</p>
    <p MadCap:conditions="SAP.SapHideFromOutput">For an illustration of how the delivery mode of a message published as non‑persistent or persistent can change if it matches a client’s topic subscription, see <MadCap:xref class="Num_And_Name_And_Page" href="../../API/API-Developer-Guide/Publishing-Guaranteed-Messages.htm#publishing_guaranteed_messages_3926332939_612041">Publishing Guaranteed Messages</MadCap:xref>.</p>
    <h3>How Message Delivery Modes Can Change for Endpoints with Matching Topics</h3>
    <p>The following table lists how messages’ delivery modes can be changed for endpoints with matching topics.</p>
    <table class="TableStyle-Table_Num" style="width: 95%;margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0">
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 50%;"/>
      <col class="TableStyle-Table_Num-Column-Column1" style="width: 50%;"/>
      <thead>
        <tr class="TableStyle-Table_Num-Head-Header1">
          <th class="TableStyle-Table_Num-HeadE-Column1-Header1">
                        Delivery Mode of Published Message
                    </th>
          <th class="TableStyle-Table_Num-HeadD-Column1-Header1">
                       Received by Endpoint as ...</th>
        </tr>
      </thead>
      <tbody>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">Direct</td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">Non-Persistent</td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyH-Column1-Body1">Non-Persistent</td>
          <td class="TableStyle-Table_Num-BodyG-Column1-Body1">Non-Persistent</td>
        </tr>
        <tr class="TableStyle-Table_Num-Body-Body1">
          <td class="TableStyle-Table_Num-BodyB-Column1-Body1">Persistent</td>
          <td class="TableStyle-Table_Num-BodyA-Column1-Body1">Persistent</td>
        </tr>
      </tbody>
    </table>
  </body>
</html>

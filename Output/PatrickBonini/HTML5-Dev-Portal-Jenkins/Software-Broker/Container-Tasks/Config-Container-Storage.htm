<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="PubSub+ Software Event Broker|[%=System.LinkedHeader%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta http-equiv="Cache-control" content="no-cache" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Managing Storage for Container Images</title>
        <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /> -->
        <!--style to display feedback button correctly in IE-->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- links to get the EDA styling to work -->
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/MainStyles.min.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
        <style>@media screen and (min-width: 0\0)
{
	.feedback-button
	{
		margin-right: -40px;
		top: 50%;
		border-radius: 9px 9px 0px 0px;
	}

	#canvas
	{
		position: relative;
	}
}

@media print
{
	#plugin
	{
		overflow: visible !important;
	}
}

</style>
        <link href="../../Resources/Stylesheets/eda_styles.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script src="https://cmp.osano.com/AzZrhlTmT5f216Foa/84ba7dc4-a4e5-4b02-b120-977eb6f052d4/osano.js">
        </script>
        <script type="text/javascript">/*<![CDATA[*/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KLSDFH');
		/*]]>*/</script>
        <script type="text/javascript" src="../../Skins/Default/Scripts/TopicToolBar.js">
        </script>
    </head>
    <!-- Top Orange and Darkgrey header-->
    <!-- Div for EDA banner -->
    <div class="eda_banner">
        <p>Register Now for EDA Summit 2024 - Virtual Event <a href="https://edasummit.com/" target="_blank">Register for Free</a></p>
    </div>
    <!-- end Div for EDA banner -->
    <div class="top-nav">
        <div class="main_list">
            <ul class="top-navlinks">
                <li><a href="https://solace.com/support/" target="_blank">Support</a>
                </li>
                <li><a href="https://solace.com/contact/" target="_blank">Contact Us</a>
                </li>
            </ul>
        </div>
        <div class="container-fluid">
            <div class="src-li">
                <div id="srchWrapTwo">
                    <form class="search" action="#">
                        <div class="search-bar search-bar-container needs-pie">
                            <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs" />
                            <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                </div>
                                <div class="search-filter-content" id="sf-content">
                                    <ul>
                                        <li>
                                            <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="search-submit-wrapper" dir="ltr">
                                <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div><span class="tool-tip" tooltip-position="left" tooltip="To search for CLI commands, events, or APIs, navigate to the related sections.">i</span>
            <!-- Sept. 28, 2022 - This is being moved to under div class= top-nav
			<div class="main_list">
				<ul class="top-navlinks">
					<li><a href="https://solace.com/support/" target="_blank">Support</a></li>
					<li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li>
				</ul>
			</div> -->
        </div>
        <!-- Sept. 27, 2022 - The commented out content below used to provide the products, company, etc., links in the top header, next to the search field. -->
        <!-- <div class="main_list"><ul class="top-navlinks"><li><a href="https://solace.com/products/" target="_blank">Products</a></li><li><a href="https://solace.com/company/" target="_blank">Company</a></li><li><a href="https://www.solace.dev/" target="_blank">Developers</a></li><li><a href="https://solace.com/support/" target="_blank">Support</a></li><li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li></ul></div> -->
    </div>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1000px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../index.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic Print NextTopic;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous topic" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next topic" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLSDFH" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div id="content">
                                        <div id="contentBody">
                                            <div class="row collapse">
                                                <div class="ContentRow" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                    <div>
                                                        <div class="nocontent" xmlns="">
                                                            <div class="MCBreadcrumbsBox_MCBreadcrumbsSelf_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="4" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                                            </div>
                                                        </div>
                                                        <div role="main" id="mc-main-content" xmlns="">
                                                            <h1 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Managing_Storage_for_Container_Images" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="aanchor364" xmlns=""></a>
                                                                <MadCap:concept term="Software" />Managing Storage for Container Images</h1>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">By default all files created inside a container are stored on a writable container layer. This means that:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>The data doesn't persist when that container no longer exists, and it can be difficult to get the data out of the container if another process needs it.</li>
                                                                <li>A container's writable layer is tightly coupled to the host machine where the container is running. You can't easily move the data somewhere else.</li>
                                                                <li>Writing into a container's writable layer requires a storage driver to manage the filesystem. The storage driver provides a union filesystem, using the Linux kernel. This extra abstraction reduces performance as compared to using data volumes, which write directly to the host filesystem.<p class="Note">Support is provided for any storage driver—<code>overlay2</code> is a good choice.</p></li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">There are two options for containers to store files in the host machine so that the files are persisted even after the container stops: volumes and bind mounts.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For more information about storage options for containers, see <a href="https://docs.docker.com/storage/" target="_blank" class="link-offsite">Manage Data in Docker</a> in the Docker documentation.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Use_a_Volume_for_the_Storage-Group" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="use-volumes"></a>Use a Volume for the Storage-Group</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The container image has a predefined mount point for an event broker's <a href="../Configuring-Storage.htm#understanding-storage-group" class="link-internal">storage-group</a> (<code>/var/lib/solace</code>). If you leave the <code>storage-group</code> unspecified when you start the container, it will be stored in the container's writable layer. This can cause the container to run out of space in the union filesystem and prevent data from being properly migrated during upgrade. We strongly recommended allocating storage outside the union filesystem for the <code>storage-group</code>.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The software event broker requires storage with medium to high bandwidth/IOPs and low latency. For information about getting the best storage performance, consult the best practices documentation for your platform.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"> A <a href="https://docs.docker.com/storage/volumes/" target="_blank" class="link-offsite">volume</a> is storage in a part of the host filesystem that is managed by the container runtime (for example, Docker Engine) and that has been mounted on the container's filesystem outside the writable layer. We recommend using volumes as the means to persist data for a software event broker container.</p>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For the <code>storage-group</code> mounted as a volume, we recommend <code>xfs</code> as the filesystem, because it has better performance than <code>ext4</code>. If you aren't using <code>xfs</code> or <code>ext4</code>, your filesystem must support the fallocate linux command.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Use_External_Storage_Devices_in_Production" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="use-external-storage"></a>Use External Storage Devices in Production</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For production deployments, we recommend that you assign the event broker's <code>storage-group</code> to an external storage device. In the container filesystem, the <code>storage-group</code> is stored in the directory <code>/var/lib/solace</code>.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For information about storage options for Kubernetes, see <a href="https://kubernetes.io/docs/concepts/storage/" target="_blank" class="link-offsite">Storage</a> in the Kubernetes documentation.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For information about storage options for OpenShift, see <a href="https://docs.openshift.com/container-platform/4.5/storage/understanding-persistent-storage.html" target="_blank" class="link-offsite">Understanding Persistent Storage</a> in the OpenShift documentation.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Directory_Ownership_with_Rootless_Containers" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="rootless-podman"></a>Directory Ownership with Rootless Containers</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">As described in <a href="rootless-containers.htm" class="MCXref xref">Rootless Containers</a>, the container runtime makes use of a user namespace  to map the UIDs and GIDs within the containers  to a (potentially different) block of users it is given access to on the host. This means that if you (as a <b>non-root</b> user) mount a directory from the host into a container, it is owned by the root user inside the container. If you create a file in that directory as the container root user, and then look at that file on the host, you'll see it's owned by your non-root host user.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This is illustrated in the following example:</p><pre xml:space="preserve" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">&gt; whoami
solly

# Mount an empty folder
host&gt; ls /home/solly/folder
host&gt; podman run -u 0 -v /home/solly/folder:/container/volume mycontainer /bin/bash

# Create a file from inside the container
root@container&gt; whoami
root
root@container&gt; touch /container/volume/<span style="color: #ff0000;">test</span>

# Check the file owner from inside the container
root@container&gt; ls -l /container/volume
total 0
-rw-r--r-- 1 <span style="color: #ff0000;">root root</span> 0 May 20 21:47 <span style="color: #ff0000;">test</span>
root@container&gt; exit

# Check again outside the container
host&gt; ls -l /home/solly/folder
total 0
-rw-r--r-- 1 <span style="color: #ff0000;">solly solly</span> 0 May 20 21:47 <span style="color: #ff0000;">test</span></pre>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This isn't a problem if the container is running as root, but from a security standpoint, it's better to run containers as non-root users. However, when the container user is non-root, it can't access volumes that are owned by the root user. Taking the example above, if the container were run as a non-root user, the <code>touch</code> command would fail with a permission denied error.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To get around this, you can change the ownership of the directory by running <code>chown</code> in a <code>podman unshare</code> session:</p><pre xml:space="preserve" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">podman unshare chown -R &lt;container-user&gt;:&lt;container-group&gt; &lt;path&gt;</pre>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The <code>podman unshare</code> command lets you run a command (<code>chown</code> in this case) in the same user namespace as your containers. Because all rootless containers that are run by a given user run inside the same user namespace, you only need to run <code>podman unshare chown</code> once to allow all of a user's containers to access a directory.</p>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Podman resets the ownership of directories and files in volume mounts when it starts the rootless container for the first time, therefore, simply run the <code>podman unshare</code> command after you start the container for the first time. Alternatively, create an empty directory and bind mount it—in this case the correct directory/file ownership is automatically assigned.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For more information, see <a href="rootless-containers.htm" class="MCXref xref">Rootless Containers</a> and the <a href="https://docs.podman.io/en/latest/markdown/podman-unshare.1.html" target="_blank" class="link-offsite">podman unshare</a> documentation.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Examples_of_Configuring_External_Storage" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="config-examples"></a>Examples of Configuring External Storage</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following are some examples that show how to configure external storage using Docker and Podman, for both volumes and bind mounts.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Example__Docker_for_Linux_(Using_a_Volume)" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="linux-external-storage"></a>Example: Docker for Linux (Using a Volume)</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To assign a <code>storage-group</code> to a dedicated external volume, do the following:</p>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">Attach a disk, or disks, to the host. Since the specific steps for performing this task vary from one environment to the next, we recommend that you consult your environment’s documentation for instructions.</li>
                                                                <li value="2">
                                                                    <p>Create the new <code>storage-group</code> volume. For detailed instructions, refer to <a href="https://docs.docker.com/storage/volumes/" target="_blank" class="link-offsite">Use Volumes</a> in the Docker documentation.</p>
                                                                </li>
                                                                <li value="3">
                                                                    <p>Create a new container that mounts the new <code>storage-group</code> volume and maps it to <code>/var/lib/solace</code>:</p><pre xml:space="preserve">docker create --network=host --uts=host --shm-size=1g --ulimit core=-1 --ulimit memlock=-1 --ulimit nofile=2448:42192 \
--env 'username_admin_globalaccesslevel=admin' --env 'username_admin_password=admin' --name=solace \
<span style="color: #ff0000;">--mount source=storage-group,target=/var/lib/solace</span>  solace-pubsub-enterprise:&lt;version&gt;</pre>
                                                                </li>
                                                            </ol>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If you are using SELinux and need to change the label of the host file or directory that is mounted into the container, you must use the <code>--volume</code> parameter. The <code>--mount</code> parameter does not support the <code>z</code> or <code>Z</code> options for modifying SELinux labels. For more information, see <a href="https://docs.docker.com/storage/bind-mounts/#configure-the-selinux-label" target="_blank" class="link-offsite">Configure the SELinux Label</a> in the Docker documentation.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Example__Docker_for_Windows_(Using_a_Bind_Mount)" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="windows-external-storage"></a>Example: Docker for Windows (Using a Bind Mount)</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To expand the default storage capability of software event broker&#160;containers in Docker for Windows, you can make use of drives from the  host, but these drives must be shared with the Docker for Windows Linux VM. <a href="https://docs.docker.com/docker-for-windows/#shared-drives" class="link-offsite" target="_blank">Shared drives</a> are configured in the Docker Settings menu.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To assign a directory on the host as external storage for the <code>storage-group</code> using a bind mount, add the following to the <code>docker run</code> command when you start a software event broker, replacing <code>&lt;host-path&gt;</code> with the path on the host where you want the <code>storage-group</code> to be mounted:</p><pre xml:space="preserve" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">--mount type=bind,source=&lt;host-path&gt;,target=/var/lib/solace</pre>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following example uses <code>C:\storage\data</code> as external storage for the <code>storage-group</code>:</p><pre xml:space="preserve" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">&gt; docker run <span style="color: #ff0000;">--mount type=bind,source=C:\storage\data,target=/var/lib/solace</span> -d -p 8080:8080 -p 55555:55555 ^
--shm-size=1g --env 'username_admin_globalaccesslevel=admin' --env 'username_admin_password=admin' ^
--name=solace solace-pubsub-standard:&lt;version&gt;</pre>
                                                            <p xml:space="preserve" class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If a Windows process is using one of the ports you are requesting, the command above fails with a "Ports are not available" error. You can use a different port, or you can reserve ports so that Windows can't use them. For details, see the <a href="https://solace.community/discussion/929/docker-port-55555-not-available-on-windows" target="_blank" class="link-offsite">related article</a> on the Solace community.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Example__Docker_for_Mac_(Using_a_Bind_Mount)" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="mac-external-storage"></a>Example: Docker for Mac (Using a Bind Mount)</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To expand the default storage capability of software event broker&#160;containers in Docker for Mac, you can make use of drives from the  host, but these drives must be shared with the  Docker for Mac&#160;Linux VM. <a href="https://docs.docker.com/docker-for-mac/#file-sharing" class="link-offsite" target="_blank">Shared drives</a> are configured in the Docker Settings menu.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To assign a directory on the host as external storage for the <code>storage-group</code> using a bind mount, add the following to the <code>docker run</code> command when you start a software event broker:</p><pre xml:space="preserve" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">--mount type=bind,source=&lt;host-path&gt;,target=/var/lib/solace</pre>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following example uses <code>/mnt/solace</code> as external storage for the <code>storage-group</code>:</p><pre xml:space="preserve" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">&gt; docker run <span style="color: #ff0000;">--mount type=bind,source=/mnt/solace,target=/var/lib/solace</span> -d -p 8080:8080 -p 55556:55555 \
--shm-size=1g --env 'username_admin_globalaccesslevel=admin' --env 'username_admin_password=admin' \
--name=solace solace-pubsub-standard:&lt;version&gt;</pre>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">On MacOS Big Sur and later, port 55555 (the default SMF port for the software event broker) is blocked. If this port is mapped to a port on a Docker container, the container fails to start, either silently or with a "port in use" error. To avoid this problem, the compose template maps port 55554 on the host to port 55555 in the container.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Example__Rootless_Podman_for_Linux_(Using_a_Bind_Mount)" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="podman-bind-mount"></a>Example: Rootless Podman for Linux (Using a Bind Mount)</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To assign a directory on the host as external storage for the <code>storage-group</code> using a bind mount, do the following:</p>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">
                                                                    <p>Create the directory to use as external storage for the <code>storage-group</code>:</p><pre>&gt; mkdir /home/&lt;user-name&gt;/storage-group</pre>
                                                                </li>
                                                                <li value="2">
                                                                    <p>Change the ownership of the directory so that the container user can access it (this command assumes UID 1000 belongs to GID 0, but this does not have to be the case):</p><pre xml:space="preserve">$ podman unshare chown 1000:0 -R /home/&lt;user-name&gt;/storage-group</pre>
                                                                </li>
                                                                <li value="3">
                                                                    <p>Start the container:</p><pre xml:space="preserve">&gt; podman run -d -u 1000 -p 8080:8080 -p 55555:55555 \
--shm-size=1g --env 'username_admin_globalaccesslevel=admin' --env 'username_admin_password=admin' \
<span style="color: #ff0000;">--mount type=bind,source=/home/&lt;user-name&gt;/storage-group,target=/var/lib/solace,relabel=private</span> \
--name=solace docker.io/solace/solace-pubsub-standard:edge</pre>
                                                                </li>
                                                            </ol>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">As discussed above, when you create an empty directory and bind mount it, Podman  correctly assigns the directory/file ownership when it starts the container.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Example__Rootless_Podman_for_Linux_(Using_a_Volume)" data-mc-generated-bookmark="TOC" xmlns=""></a><a name="podman-volume"></a>Example: Rootless Podman for Linux (Using a Volume)</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To assign a <code>storage-group</code> to a dedicated external volume, do the following:</p>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">Attach a disk, or disks, to the host. Since the specific steps  for this task vary from one environment to the next, we recommend that you consult your environment’s documentation for instructions.</li>
                                                                <li value="2">Ensure that Podman's <a href="https://docs.podman.io/en/latest/markdown/podman.1.html#volumepath-value" target="_blank" class="link-offsite">volume path</a> is correctly set to point to the external disk.</li>
                                                                <li value="3">Create the new <code>storage-group</code> volume. For detailed instructions, refer to <a href="https://docs.podman.io/en/latest/markdown/podman-volume-create.1.html" target="_blank" class="link-offsite">Podman volume create</a> in the Podman documentation.</li>
                                                                <li value="4">
                                                                    <p>Create a new container that mounts the new <code>storage-group</code> volume and maps it to <code>/var/lib/solace</code>:</p><pre xml:space="preserve">podman create -u 1000 --network=host --uts=host --shm-size=1g \
--ulimit core=-1 --ulimit memlock=-1 --ulimit nofile=2448:42192 \
--env 'username_admin_globalaccesslevel=admin' --env 'username_admin_password=admin' --name=solace \
<span style="color: #ff0000;">--mount type=volume,source=storage-group,target=/var/lib/solace,relabel=private</span> docker.io/solace/solace-pubsub-standard:edge</pre>
                                                                </li>
                                                            </ol>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The <code>host</code> mode for <code>--network</code> gives the container full access to local system services such as D-bus and is therefore considered insecure.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="no-print">
                                            <div><a href="#" id="docsFeedbackTrigger" class="docs-issue-collector">Provide feedback</a>
                                            </div>
                                        </div>
                                        <footer class="my-4 pt-4 text-center no-print">
                                            <div class="footer-txt text-center no-print">
                                                <ul class="list-inline ">
                                                    <li class="list-inline-item text-muted"><a href="../../Resources/Documentation-Set.htm" class="doc-set-footer-link MCXref xref xrefdoc-set-footer-link">Documentation Coverage</a>: <span class="mc-variable Variables.DocumentSetNumber variable">2024.09.16.0001</span></li>
                                                    <li class="list-inline-item text-muted">Last Updated: <span class="mc-variable Variables.MonthDayYear variable">September 16, 2024</span></li>
                                                    <li class="list-inline-item text-muted" style="font-size:13px;"> ©  <span class="mc-variable Variables.CompanyNameLegal variable">Solace Corporation</span></li>
                                                </ul>
                                            </div>
                                            <div class="footer-icons">
                                                <ul class="list-inline">
                                                    <li class="list-inline-item"><a href="https://facebook.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/facebook_22x21.png" class="Hyperlinked" alt="Facebook" title="Solace Facebook Page" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.linkedin.com/company/20219" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/LinkedIn_22x21.png" class="Hyperlinked" alt="LinkedIn" title="Solace LinkedIn Page" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://twitter.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/Twitter_22x21.png" class="Hyperlinked" alt="Twitter" title="Solace Twitter Feed" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.youtube.com/user/SolaceSystems" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/youtube_22x21.png" class="Hyperlinked" alt="YouTube" title="Solace YouTube Channel" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.instagram.com/solacedotcom/" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/instagram_22x21.png" class="Hyperlinked" alt="Instagram" title="Solace Instagram Feed" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://medium.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/medium_22x21.png" class="Hyperlinked" alt="Medium" title="Solace Medium Blog" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="footer_link_menu">
                                                <ul class="link_list">
                                                    <li class="link_list_item"><a href="https://solace.com/products/" target="_blank" class="footer-link">Products</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/company/" target="_blank" class="footer-link">Company</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://www.solace.dev/" target="_blank" class="footer-link">Developers</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/support/" target="_blank" class="footer-link">Support</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/contact/" target="_blank" class="footer-link">Contact Us</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </footer>
                                    </div>
                                    <!-- JIRA issue collector -->
                                    <script>/*<![CDATA[*/// Requires jQuery!
jQuery.ajax({
    url: "https://sol-jira.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e-T/o2joag/b/24/e73395c53c3b10fde2303f4bf74ffbf6/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-US&collectorId=076e0808",
    type: "get",
    cache: true,
    dataType: "script"
});
window.ATL_JQ_PAGE_PROPS = {
"triggerFunction": function(showCollectorDialog) {
//Requires that jQuery is available!
$("#docsFeedbackTrigger").click(function(e) {
e.preventDefault();
showCollectorDialog();
});
},
fieldValues: {
recordWebInfo: '1', // field Name
recordWebInfoConsent: ['1'] // field Id
}
};
/*]]>*/</script>
                                    <script src="../../Resources/Scripts/thumbnail.js">
                                    </script>
                                    <!-- Script for Launching offsite links in new tab -->
                                    <script type="text/javascript">/*<![CDATA[*/$("a[href^='http']").attr("target","_blank");/*]]>*/</script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="Developing Applications|Solace Messaging API Developer Guide|API Best Practices" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta http-equiv="Cache-control" content="no-cache" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>C API Best Practices</title>
        <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /> -->
        <!--style to display feedback button correctly in IE-->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- links to get the EDA styling to work -->
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/MainStyles.min.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
        <style>@media screen and (min-width: 0\0)
{
	.feedback-button
	{
		margin-right: -40px;
		top: 50%;
		border-radius: 9px 9px 0px 0px;
	}

	#canvas
	{
		position: relative;
	}
}

@media print
{
	#plugin
	{
		overflow: visible !important;
	}
}

</style>
        <link href="../../Resources/Stylesheets/eda_styles.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script src="https://cmp.osano.com/AzZrhlTmT5f216Foa/84ba7dc4-a4e5-4b02-b120-977eb6f052d4/osano.js">
        </script>
        <script type="text/javascript">/*<![CDATA[*/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KLSDFH');
		/*]]>*/</script>
        <script type="text/javascript" src="../../Skins/Default/Scripts/TopicToolBar.js">
        </script>
    </head>
    <!-- Top Orange and Darkgrey header-->
    <!-- Div for EDA banner -->
    <div class="eda_banner">
        <p>Register Now for EDA Summit 2024 - Virtual Event <a href="https://edasummit.com/" target="_blank">Register for Free</a></p>
    </div>
    <!-- end Div for EDA banner -->
    <div class="top-nav">
        <div class="main_list">
            <ul class="top-navlinks">
                <li><a href="https://solace.com/support/" target="_blank">Support</a>
                </li>
                <li><a href="https://solace.com/contact/" target="_blank">Contact Us</a>
                </li>
            </ul>
        </div>
        <div class="container-fluid">
            <div class="src-li">
                <div id="srchWrapTwo">
                    <form class="search" action="#">
                        <div class="search-bar search-bar-container needs-pie">
                            <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs" />
                            <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                </div>
                                <div class="search-filter-content" id="sf-content">
                                    <ul>
                                        <li>
                                            <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="search-submit-wrapper" dir="ltr">
                                <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div><span class="tool-tip" tooltip-position="left" tooltip="To search for CLI commands, events, or APIs, navigate to the related sections.">i</span>
            <!-- Sept. 28, 2022 - This is being moved to under div class= top-nav
			<div class="main_list">
				<ul class="top-navlinks">
					<li><a href="https://solace.com/support/" target="_blank">Support</a></li>
					<li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li>
				</ul>
			</div> -->
        </div>
        <!-- Sept. 27, 2022 - The commented out content below used to provide the products, company, etc., links in the top header, next to the search field. -->
        <!-- <div class="main_list"><ul class="top-navlinks"><li><a href="https://solace.com/products/" target="_blank">Products</a></li><li><a href="https://solace.com/company/" target="_blank">Company</a></li><li><a href="https://www.solace.dev/" target="_blank">Developers</a></li><li><a href="https://solace.com/support/" target="_blank">Support</a></li><li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li></ul></div> -->
    </div>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1000px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../index.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic Print NextTopic;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous topic" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next topic" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLSDFH" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div id="content">
                                        <div id="contentBody">
                                            <div class="row collapse">
                                                <div class="ContentRow" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                    <div>
                                                        <div class="nocontent" xmlns="">
                                                            <div class="MCBreadcrumbsBox_MCBreadcrumbsSelf_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="4" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                                            </div>
                                                        </div>
                                                        <div role="main" id="mc-main-content" xmlns="">
                                                            <h1 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">C API Best Practices</h1>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following are some of the best practices for the <span class="mc-variable Manifest-Products-APIs.api-product-c-api-long variable">PubSub+&#160;Messaging API&#160;for C</span>. The practices are divided into the following categories:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li><a href="#General" class="MCXref xref">General Best Practices</a>
                                                                </li>
                                                                <li><a href="#Threading" class="MCXref xref">Threading</a>
                                                                </li>
                                                                <li><a href="#file-desc-mgmt" class="MCXref xref">File Descriptor Management</a>
                                                                </li>
                                                                <li><a href="#init-data-structures" class="MCXref xref">Initializing Data Structures with Provided Macros</a>
                                                                </li>
                                                                <li><a href="#Memory" class="MCXref xref">Memory Management</a>
                                                                </li>
                                                                <li><a href="#Session" class="MCXref xref">Session Establishment</a>
                                                                </li>
                                                                <li><a href="#select-block-modes" class="MCXref xref">Selecting Blocking Modes</a>
                                                                </li>
                                                                <li><a href="#subscription-mgmt" class="MCXref xref">Subscription Management</a>
                                                                </li>
                                                                <li><a href="#ios-apps" class="MCXref xref">Working with iOS Applications</a>
                                                                </li>
                                                                <li><a href="#sending-messages" class="MCXref xref">Sending Messages</a>
                                                                </li>
                                                                <li><a href="#receive-messages" class="MCXref xref">Receiving Messages</a>
                                                                </li>
                                                                <li><a href="#do-not-block-callbacks" class="MCXref xref">Do Not Block in Callbacks</a>
                                                                </li>
                                                                <li><a href="#Queues" class="MCXref xref">Queues and Flows</a>
                                                                </li>
                                                                <li><a href="#error-handling" class="MCXref xref">Error Handling and Logging</a>
                                                                </li>
                                                                <li><a href="#message-config-client-behavior" class="MCXref xref">Event Broker Configuration that Influences Client Application Behavior</a>
                                                                </li>
                                                            </ul>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="General"></a>General Best Practices</h2>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Tuning"></a>Tuning Guidelines for Guaranteed Messaging</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Reductions in the rate at which clients receive messages can occur when a high volume of Guaranteed messages (particularly when they are large messages) is received over many Flows. In this situation, the number of Flows used and the Guaranteed window size used for each Flow affects the buffer usage of the per&#8209;client priority queues that the event broker uses for Guaranteed messages. These queues, called the G-1 queues, hold Guaranteed messages for the clients that are waiting for delivery out of the event broker, or have been sent but are waiting for acknowledgment from the clients.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Each G-1 queue is allocated a maximum depth buffer. This maximum depth is measured in work units, whereby a work unit represents 2,048 bytes of a message. (By default, each G-1 queue is given a maximum depth of 20,000 work units.)</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To address slow Guaranteed message delivery rates caused by high demands on the buffer allocated by G-1 queues, you should reduce the Guaranteed message window size used for each Flow and, when possible, reduce the number of Flows used. </p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If it's not possible to reduce the Guaranteed message window size, or the number of flows, you can also effectively increase the G-1 queue size by adjusting the <code>min-msg-burst</code> size used by the event broker. </p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Reapply"></a>Reapply Subscriptions</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If enabled, the API maintains a local cache of subscriptions and reapplies them when the subscriber connection is reestablished. Reapply Subscriptions will only apply direct topic subscriptions upon a Session reconnect. It will not reapply topic subscriptions on durable and non-durable endpoints.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="number-flow-msg-win-size"></a>Number of Flows and Guaranteed Message Window Size</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The amount of buffers used by a client for receiving Guaranteed messages is primarily determined by the number of Flows used per Session * the Guaranteed Message window size of each Flow. To limit a client’s maximum buffer use, you can reduce the number of Flows used and/or reduce the Guaranteed Message window size of each Flow. (The Guaranteed Message window size for each Flow is set through the Flow properties; refer to <a href="Creating-Flows.htm#Importan" class="MCXref xref">Important Flow (Message Consumer) Properties</a>.)</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Consider, for example, a client using Flows with a window size of 255 to bind to 10 Queues, and the Guaranteed messages from those Queues have an average size of 20kB. In this scenario, the Flow configuration for the client is not appropriately sized, as the client’s maximum buffer usage (approximately 24,902 work units) exceeds that offered by the event broker (20,000 work units). However, if the Flows are reconfigured with a window size of 25, then the client’s maximum buffer usage will fall within an acceptable range (approximately 2,441 work units).</p>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Work units are fixed size buffers on the event broker that are used to process messages according to set queue depths. A work unit represents 2,048 bytes of a message.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Minimum"></a>Minimum Message Burst Size</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If you can't reduce the number of Flows, or the Guaranteed Message window size, you can adjust the size of the G-1 queue. The simplest way to increase the queue is to adjust the min-msg-burst size. The min-msg-burst size specifies the number of messages that are always allowed entry into the queue. The min&#8209;msg&#8209;burst size is set on a per-client basis through client profiles.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Under normal operating conditions it's not necessary to change the default <code>min&#8209;msg-burst</code> value for the G-1 queue. However, in situations where a client is consuming messages from multiple endpoints, it's important that the <code>min&#8209;msg&#8209;burst</code> size for the G-1 queue is at least equal to the sum of all of the Guaranteed message window sizes used for the Flows that the client consumes messages from. For example, if the client connects to 1,000 endpoints, and the Flows have a window size of 50, then the <code>min-msg-burst</code> size should be set to 50,000 or more. </p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Tuning the <code>min-msg-burst</code> size in this manner ensures that the NAB holds enough messages to fill the client’s combined Guaranteed message window size when it comes online. If there aren't enough messages held, messages that aren't delivered to the client can be discarded, then another delivery attempt is required. This process of discarding, then resending messages results in a slow recovery for a slow subscriber (that is, a client that doesn't consume messages at a quick rate).</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For information on how to set the <code>min-msg-burst</code> size, refer to <a href="../../Messaging/Managing-Event-Delivery-Resources.htm#managing_msg_delivery_resources_2491525118_203210" class="MCXref xref" data-mc-unresolved-link="import-link:managing_msg_delivery_resources_4245516314_17011">Configuring Egress Per-Client Priority Queues</a>.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Threading"></a>Threading</h2>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="select-thread-model"></a>Selecting a Threading Model</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Use an API provided Context thread whenever possible unless it is unable to match the required performance, and in such cases the application-provided Context thread technique should be considered.</li>
                                                                <li>Use the 'One Session, One Context' threading model whenever possible. The 'Multiple Sessions, One Context' and 'Multiple Sessions, Multiple Contexts' models can potentially increase message processing throughput, but at the expense of additional processing caveats.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The C API uses Contexts for organizing communications with Solace PubSub+ event brokers. Each client application that uses the C API must contain a minimum of one Context; and each Context can contain one or more Sessions.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">By default, the C API provides an internal Context thread for processing work that is suitable for the most common application models and architectures. This thread can handle application timers and file descriptors as registered by the application through the API.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If you want to automatically create the Context thread, instead of relying on the application to create and destroy the Context thread, enable the <code>SOLCLIENT_CONTEXT_PROP_CREATE_THREAD</code> Context property. The API-provided Context thread blocks in <code>solClient_context_processEvents(...) </code>and is the thread the application is called from for all received messages and received events. The API-provided Context thread automatically exits cleanly when a Context is destroyed.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="app-provided-threads"></a>Application-Provided Threads</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Optionally, when the <code>SOLCLIENT_CONTEXT_PROP_CREATE_THREAD</code> Context property is disabled, an application can provide a Context thread and manage file descriptors itself. When this configuration is used, the API requires the application to provide thread processing time.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The ability for the application to use its own thread and event loop processing (with the requirement that part of that event loop includes a call to the <code>processEvents()</code>) function offers developers much flexibility.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When relying on application-provided threads, how to configure your Sessions in Contexts is an important consideration in application design, as it directly impacts factors such as CPU usage on application host machines, message latency, and throughput.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The table below describes the threading models that can be used for application provided threads and how they affect application design and performance.</p>
                                                            <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Threading Model Considerations</p>
                                                                </caption>
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Threading Model</td>
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Description</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Implementation Considerations</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">One Session, One Context Thread</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">In this scenario, a single Session is used with a single Context on the application-provided thread.</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">This approach forces all message and event processing into this Context thread instead of forwarding some or all processing downstream to other application threads.</p>
                                                                            <p class="Tbl_Body">This straight forward model allows for easier design and debugging, and it is ideal for applications that function as either a publisher or a consumer.</p>
                                                                            <p>For the majority of cases, the 'One Session, One Context' model is sufficient for publisher and consumer application design.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Multiple Sessions, One Context Thread</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">In this scenario, multiple Sessions are serviced using one Context on the application provided thread. You can process all messages received by the same message and event callback functions, or create additional callbacks.</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">This approach puts considerable processing stress on the Context thread, as all Sessions must wait in the select loop before being processed. </p>
                                                                            <p class="Tbl_Body">Depending on message volume, it could be necessary to forward messages to downstream Queues for processing by additional application threads.</p>
                                                                            <p>An application designer may want to move to 'Multiple Sessions, One Context' if there is a need to prioritize messages where higher value messages maybe sent/received across different Sessions, for example through different TCP connections. This approach can potentially increase throughput as well.  This means that it may be necessary to forward received messages to downstream application internal queues such that messages are processed by additional application message processing threads.  All received messages can be processed by the same message and event callback functions, or Session specific ones by creating additional callbacks.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_Body">Multiple Sessions, Multiple Contexts Threads</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_Body">In this scenario, the application provides a number of threads, each containing a single Context, and each Context can contain one or more Sessions.</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p class="Tbl_Body">This approach allows you to separate each Session connection into its own Context thread, which allows all processing to occur in each application-provided thread. </p>
                                                                            <p>With 'Multiple Sessions, Multiple Contexts', a designer can reduce the Context Thread processing burden of the 'Multiple Sessions, One Context' model where all Sessions must wait in the select loop before being processed. In this model, each Session can be separated into its own Context thread, and therefore enhance the processing performances that OS multi-threading provides. However, due to the increased number of threads, this approach requires expansive thread context switching, hence places more burden on the CPU and is more resource intensive.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <div class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <ul>
                                                                    <li>The application must call <code>solClient_context_timerTick()</code> for each Context.</li>
                                                                    <li>For a given Context, the messaging API’s file descriptor callbacks must be called from the same thread that calls<code> solClient_context_timerTick()</code> for that Context.</li>
                                                                </ul>
                                                            </div>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Context"></a>Context Thread Affinity</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Use <code>SOLCLIENT_CONTEXT_PROP_THREAD_AFFINITY_CPU_LIST</code> to pin the API generated Context thread to a CPU. </li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When the context thread is automatically generated by the C API, the thread affinity can be set for the context thread through the <code>SOLCLIENT_CONTEXT_PROP_THREAD_AFFINITY_CPU_LIST</code> parameter during context creation. When you set the thread affinity, it dedicates a specific CPU for processing improvement and prevents the context thread from being interrupted by other processes. By default, the thread affinity for the auto-created context thread is not set, allowing your operating system to optimally schedule the context thread on available CPUs. The expected string value is a comma-separated list that can be:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>
                                                                    <p>numbers—base-10 non-negative integers between 0 and the number of CPUs in the system<br /><b>and/or</b></p>
                                                                </li>
                                                                <li>
                                                                    <p> ranges—two numbers with a dash character between them</p>
                                                                </li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following example shows how to set thread affinity for a list of CPUs using numbers and ranges:</p>
                                                            <p class="Code" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">const char* contextProps_simple[3] = {SOLCLIENT_CONTEXT_PROP_THREAD_AFFINITY_CPU_LIST, "0,1,2,4,8-10,13-15", NULL};</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The default value of <code>SOLCLIENT_CONTEXT_PROP_THREAD_AFFINITY_CPU_LIST</code> is an empty string, which results in no thread affinity setting.</p>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This property has no effect if the application creates the context thread itself.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For more information and details about usage, see the <a href="../Messaging-APIs/C-API/c-api-home.htm#Capireference" class="MCXref xref">C API Reference</a> and the <code>solclient.h</code> header file.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="file-desc-mgmt"></a>File Descriptor Management</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following table lists the management modes that can be used in C API to handle file descriptors.</p>
                                                            <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">File Descriptor Management Modes</p>
                                                                </caption>
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Management Mode</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">API Management of API File Descriptors</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">The default management mode is for the C API to internally manage its own file descriptor events. When an application’s processing Context calls <code>solClient_context_processEvents(...)</code>, the API waits for internal file descriptor events. Control returns to the calling application processing thread when at least one event occurs or a time-out occurs.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Application Management of API File Descriptors</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">The application manages the event generation logic that is normally managed by the C API. Within a processing Context, the application provides file descriptor event register and unregister functions that the API uses to ask for events for its file descriptors. The application is then responsible for polling the file descriptor for events. When events occur on file descriptors owned by the API, the application event generation logic must call the routines that the API has registered for its file descriptors.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_Body">API Management of Application File Descriptors</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p class="Tbl_Body">The application registers its own file descriptors for events, such as read or write events, within a C API processing Context. When an application file descriptor is registered, the application provides a callback routine and a pointer to application data. The application then calls <code>solClient_context_processEvents(...)</code>, or relies on the internal API Context thread, as in the default management mode, which can cause event generation on the registered application file descriptors and on API file descriptors.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="file-desc-limits"></a>File Descriptor Limits</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">File descriptor limits in Linux and Solaris platforms restrict the number of files that can be managed per process to 1,024. Because the C API uses <code>select(2)</code> to poll devices, these file descriptor limits prevent the API from managing any single file descriptor that has a numerical value greater than 1,023.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">An application should not create more than 1,023 Sessions per process. The possible number of Sessions can be further reduced by any other files not managed by the API that the application has open.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Similarly, on Windows platforms, a single Context cannot manage more than 63 Sessions that are connected to an event broker. However, unlike an application on a Linux platform, an application on a Windows platform can work around the OS limitations by creating many Contexts within a process.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">An application that registers its own file descriptor handlers (by providing <code>non-null</code> function pointers in <code>solClient_context_createRegisterFdFuncInfo_t</code>) is not limited in the API, but it might have its own limitations.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">An application that provides its file descriptors to the API to manage (by calling <code>solClient_context_registerForFdEvents()</code>) further reduces the number of Sessions that can be handled in a single Context (Windows platform) or process wide (Linux and Solaris platforms).</p>
                                                            <p class="Caution" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Support for Solaris/SunOS is now deprecated and the last release was v7.23.0 (September 2022).  For more details, see the <a href="https://solace.com/support/product-lifecycle-policy/#deprecated_features" class="link-offsite">Deprecated Features</a> list on the Product Lifecycle Policy page.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="init-data-structures"></a>Initializing Data Structures with Provided Macros</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The C API provides static initializing macros for callback function data structures. Using the provided macros with accompanying explicit data structure initialization code is a good programming practice because it initializes the entire data structure and provides appropriate values for new fields. This ensures that your application will continue to compile without unexpected errors even if changes are made to the API callback function data structures.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Static initializing macros are provided for the following callback function data structures:</p>
                                                            <p class="Code" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">solClient_context_createFuncInfo_t – initializer SOLCLIENT_CONTEXT_CREATEFUNC_INITIALIZER</p>
                                                            <p class="Code" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">solClient_session_createFuncInfo_t – initializer SOLCLIENT_SESSION_CREATEFUNC_INITIALIZER</p>
                                                            <p class="Code" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">solClient_flow_createFuncInfo_t - initializer SOLCLIENT_FLOW_CREATEFUNC_INITIALIZER</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For example, you could initialize <code>solClient_session_createFuncInfo_t </code>as follows:</p><pre xml:space="preserve" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">solClient_session_createFuncInfo_t sessionFuncInfo = SOLCLIENT_SESSION_CREATEFUNC_INITIALIZER;
sessionFuncInfo.rxInfo.callback_p     = rxLogCallbackFunc;
sessionFuncInfo.rxInfo.user_p         = userPtr;
sessionFuncInfo.eventInfo.callback_p  = eventLogCallbackFunc;
sessionFuncInfo.eventInfo.user_p      = userPtr;</pre>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The code snippet above is equivalent to and preferable to the immediate initialization in a declaration, as shown in the following example:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">solClient_session_createFuncInfo_t sessionFuncInfo = {
            {rxMsgCallback, userPtr},
            {rxEventCallbac, userPtr},
            {NULL, NULL} };</pre>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Initializing in this manner without using the provided macros could require code changes to your program if future enhancements and changes are made to the C API.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Memory"></a>Memory Management</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following sections discuss how to manage memory in the C API and provide some guidelines for optimizing the performance of the API.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Message"></a>Message Abstraction</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Applications using the C API use the <code>solClientMsg</code> interface, an abstract data structure stored in internal memory buffers with accessors and modifiers for each of the message parts.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The <code>solClientMsg</code> interface provides the following functionality:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>An internal memory pool to avoid heap allocation and fragmentation.</li>
                                                                <li>Add and get functions for structured data in the binary data payload (that is, the binary attachment) of the message.</li>
                                                                <li>Add and get functions for unstructured data in the XML data and user-data payloads of the message.</li>
                                                                <li>Add and get functions for Solace-defined and user-defined message headers.</li>
                                                            </ul>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="modify-global-pool"></a>Modifying Global Pool Buffer Sizes</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The <code>solClientMsg</code> interface is a message buffer API, which utilizes heap memory allocations. The C API allocates specific sized buffers from its own pools and maintains them internally. Buffers are allocated from heap storage and used for saving messages in the application space until they are released by the application.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When the C API is initialized, you can optionally modify the default global data buffer sizes for the five pools that are used.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When you call the <code>solClient_initialize</code> function to initialize the C API, you can use <code>SOLCLIENT_GLOBAL_PROP_DBQUANTASIZE_&lt;0-4&gt; “GLOBAL_DBQUANTA_SIZE”</code> to specify the size (in bytes) of the data buffers for each of the five pools.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For more information, refer to <a href="../../API-Developer-Online-Ref-Documentation/c/index.html" class="MCXref xref">Register Now for EDA Summit 2024 - Virtual Event Register for Free</a>.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Configur"></a>Configuring Message Buffer Sizes</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When creating a Session, an application can configure the following memory and resource allocation-related Session property parameters:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li><code>SOLCLIENT_SESSION_PROP_BUFFER_SIZE</code>
                                                                    <p>The Session buffer size used for transmitting messages for the TCP Session. This parameter specifies the maximum amount of messages to buffer (as measured in bytes). For maximum performance, when sending small messages, the Session buffer size should be set to multiple times the typical message size.</p>
                                                                    <p>The C API always accepts at least one message to transmit. So even if the size of a single message exceeds the set buffer size, it is accepted and transmitted, as long as the current buffered data is zero. However, no further messages are accepted until the amount of data buffered is reduced below the set buffer size.</p>
                                                                </li>
                                                                <li><code>SOLCLIENT_SESSION_PROP_SOCKET_RCV_BUF_SIZE</code>
                                                                    <p>The receive buffer size (in bytes) for the subscriber data socket. A default value of 150,000 is used. If this property is set to 0, the receive buffer size uses the operating system default.</p>
                                                                    <div class="Note">
                                                                        <p>On Windows platforms the receive socket buffer size must be much larger than the send socket buffer sizes to prevent data loss when sending and receiving messages. For example, the default send socket and internal buffer sizes are set to 90,000, and the default receive socket buffer size is set to 150,000. If you change the default sizes, it is recommended that you maintain a similar sizing ratio.</p>
                                                                    </div>
                                                                </li>
                                                                <li><code>SOLCLIENT_SESSION_PROP_SOCKET_SEND_BUF_SIZE</code>
                                                                    <p>This parameter allows the send buffer size (in bytes) for the publisher data socket to be set by the application. A default value of 90,000 is used. If this property is set to 0, the send buffer size uses the operating system default.</p>
                                                                </li>
                                                            </ul>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Managing"></a>Managing Memory When Publishing Messages</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To ensure a high level of operational performance when publishing messages, avoid unnecessary memory moving and copying. To reduce the processing cycles used when moving and copying memory, consider the following guidelines:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>When the payload or message already exists in the application, use <code>solClient_msg_setXmlPtr</code> or <code>solClient_msg_setBinaryAttachmentPtr</code> functions to set the payload pointers directly to the message. The companion functions <code>solClient_msg_setXml</code> and <code>solClient_msg_setBinaryAttachment</code> copy the message into internally-allocated memory and should only be used when the message is being built and saved for some reason.</li>
                                                                <li>If the Topic or Queue name destination already exists, use <code>solClient_msg_setTopicPtr or solClient_msg_setQueueNamePtr.</code></li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Using structured data type (SDT) message containers always involves memory copies. Therefore, to conserve memory when using containers, consider the following guidelines:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>If you are sending a few headers that describe large content, consider setting the headers in the <code>USER_PROPERTY</code> map (set through <code>solClient_msg_createUserPropertyMap(...)</code>) and add the content using <code>solClient_msg_setBinaryAttachmentPtr()</code>.</li>
                                                                <li>When building a container, always try to accurately estimate the required size. The container could be a user property map (created through <code>createUserPropertyMap()</code>), a map (created in a message through <code>solClient_msg_createBinaryAttachmentMap()</code>) or a stream (created in a message through <code>solClient_msg_createBinaryAttachmentStream(...)</code>).</li>
                                                                <li>When building a complex container that uses a submap or substream, write the submap or substream completely and call <code>solClient_container_createStream(...)</code> to finish the submap or substream before adding more to the main container.
            <div class="Note"><p>When a binary attachment already exists in the application, you can use <code>solClient_msg_setBinaryAttachmentContainerPtr(...)</code> to avoid a memory copy. When the message is sent, the binary attachment contents are copied directly from the application memory to the transmit socket or buffer. Note that when this function is used, modifying the container or releasing the memory it references before the message is sent can corrupt the contents.</p></div></li>
                                                            </ul>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="manage-memory-recv-messages"></a>Managing Memory When Receiving Messages</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Message buffers received by the callback are owned by the C API, and they must not be released. However, to take ownership of these message buffers, the application can return <code>SOLCLIENT_CALLBACK_TAKE_MSG</code> to the API for each message. In this case, the application must call <code>solClient_msg_free(...)</code> when it is finished with the messages to release the memory.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="TCP"></a>TCP Send and Receive Buffer Size</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Adjust the TCP send and receive buffer sizes to optimize TCP performance, particularly when publishing large messages or for WAN performance optimization.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For TCP, the bandwidth-delay product refers to the product of a data link’s capacity and its round-trip delay time.  The result expresses the maximum amount of data that can be on the network at any given time.  A large bandwidth-delay product is expected for a WAN environment due to the intrinsic long round-trip delay, and as such TCP can only achieve optimum throughput if a sender sends a sufficiently large quantity of data to fill the maximum amount of data that the network can accept. This means that the TCP send and receive buffer size needs to be adjusted.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Specific to Windows platform, the receive socket buffer size must be much larger than the send socket buffer size to prevent data loss when sending and receiving messages.  The recommended ratio is 3 parts send buffer to 5 parts receive buffer.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">TCP’s socket send and receive buffer sizes can be configured through the API’s session properties setting. The session property parameters and default values are shown below. If the value of zero is used for setting these properties, the operating system’s default size is used.</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li><code>SOLCLIENT_SESSION_PROP_SOCKET_RCV_BUF_SIZE</code>; 150,000 bytes</li>
                                                                <li><code>SOLCLIENT_SESSION_PROP_SOCKET_SEND_BUF_SIZE</code>; 90,000 bytes</li>
                                                            </ul>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Session"></a>Session Establishment</h2>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="blocking-connects"></a>Blocking Connect</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Connect blocking calls serializes each and every session connect and increases session establishment delay.  If serialization is not necessary, disable blocking connect to improve overall session connect speed.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Enable blocking connect serializes each and every individual session connect when there are many sessions configured within a Context.  Doing so will increase the connection time. If serialization is not important, consider disabling blocking connect.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The blocking connect property is <code>SOLCLIENT_SESSION_PROP_CONNECT_BLOCKING</code>.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="host-lists"></a>Host Lists</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">As a best practice, use host lists (see note below). Host lists are applicable when you use replication for failover support and the <span class="mc-variable Product-Names.broker_sw_short variable">software event broker</span>'s hostlist High Availability (HA) support. </p>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Host Lists should not be used in Active/Active Replication deployments.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For replication failover support, client applications must be configured with a host list of two addresses, one for each of the Guaranteed Messaging enabled virtual router at each site. If a connection fails for one host, it would the client would then try to connect to the to-be-active replication host before retrying the same host. For that reason, it's recommended to set the reconnect retires per host to 1.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Host lists must not be used in an active/active replication deployment where client applications are consuming messages from endpoints on the replication active message VPN on both sites.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Similarly, for software event broker HA failover support, if the switchover-mechanism is set to hostlist instead of IP&#160;address-takeover, the client application must provide a host list of two addresses.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For more details on hostlist configuration, see <a href="../../Features/HA-Redundancy/Configuring-HA-Groups.htm" class="MCXref xref">HA Group Configuration</a>.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="client-api"></a>Client API Keep-alive</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>The Client Keep-alive interval should be set to the same order of magnitude as the TCP Keep-alive setting on the client profile.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">There are two types of keep-alive mechanisms between the client application and the event broker.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">There is the TCP Keep-alive that operates at the TCP level that is sent by the event broker to the client application. This is the TCP Keep-alive mechanism described in RFC 1122. The client application’s TCP stack responds to the event broker’s TCP Keep-alive probe.  By default, the event broker sends out a keep-alive message after it detects idle connection for 3 seconds.  It then sends 5 probes at the interval of 1 keep-alive probe per second.  Hence, the event broker will flag a client to have failed TCP keep-alive if it receives no response after 8 seconds.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">There is also the Client API Keep-alive that occurs concurrently to the TCP Keep-alive.  This is the API’s built-in keep-alive mechanism, and operates on top of TCP at the API level. This is sent from the API to the event broker. By default, a Client Keep-alive is sent at the interval of once every 3 seconds, and up to 3 keep-alive responses can be missed before the API declares that the event broker is unreachable; that is, after  9 seconds.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">These keep-alive mechanisms exist so that they will be able to advise the application or the event broker that its peer has died before it's able to notify the corresponding party.  The keep-alive mechanism is also used to prevent disconnection due to network inactivity.  However, if either mechanism is set much more aggressively, that is, with a shorter detecting time, than the other, the connection can be prematurely disconnected. For example, if the Client API Keep-alive is set at a 500 ms interval with 3 keep-alive responses while the TCP Keep-alive remains unchanged at the default, then the client API Keep-alive will trigger aggressive disconnection.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="ha-failover"></a>High Availability Failover and Reconnect Retries</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>The reconnect duration should be set to last for at least 300 seconds when designing applications for High Availability (HA) support.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When using a High Availability (HA) appliance  setup, a failover from one appliance to its mate will typically occur within 30 seconds. However, applications should attempt to reconnect for at least 5 minutes. Below is an example of setting the reconnect duration to 5 minutes using the following session property values:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>connect retries: 1</li>
                                                                <li>reconnect retries: 20</li>
                                                                <li>reconnect retry wait: 3,000 ms</li>
                                                                <li>connect retries per host: 5</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Refer to <a href="Configuring-Connection-T.htm" class="MCXref xref">Configuring Connection Time-Outs and Retries</a> for instructions on setting connect retries, reconnect retries, reconnect retry wait and connect retires per host parameters.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="replication-failover"></a>Replication Failover and Reconnect Retries</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>The number of reconnect retries should be set to -1 so that the API will retry indefinitely during a replication failover.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">In general, the duration of a replication failover is non-deterministic as it may require operational intervention for the switch, which can take up to tens of minutes, or hours.  Hence, it's recommended to set the number of reconnect retires to -1 so that the API will try to  indefinitely reconnect for a replication aware client application.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Refer to <a href="Configuring-Connection-T.htm#Reconnec" class="MCXref xref">Reconnect Retries</a> for instructions on how to set the reconnect retries parameter.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="replication-sessions"></a>Replication Failover and Session Re-Establishment</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>API versions higher than 7.1.2 are replication aware, and automatically handle session re-establishment when a replication failover occurs. Client applications running lower API versions must re-establish a session upon reconnect.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Prior to 7.1.2, sessions need to be re-established after a replication failover when a client is publishing Guaranteed messages in a session that has been disconnected, because, while the reconnect is successful, the flow needs to be re-established since the newly connected event broker in the Replication site doesn't t have any flow state information, unlike the case for HA failover where this information is synchronized. The recommendation is to catch the <code>unkonw_flow_name</code> event and re-establish a new session to get the flow created.  From version 7.1.2 onwards, the API is replication aware and transparently handles session re-establishment .</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="blocking-call-transact"></a>Blocking Call in Transacted Session Callback</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>A blocking call on the message receive callback is allowed as the messages are delivered from a message dispatcher thread, not the context thread. A message dispatcher thread is created implicitly by the API for transacted session.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">One common usage pattern of a transacted session is to consume a message and publish the result, and commit these 2 steps as one atomic step. It's generally the case that one cannot make blocking calls, that is,<code> send()</code>, from within a message callback on the context thread. However, for a transacted session, the API implicitly creates a Message Dispatcher thread for the delivery of the message and, therefore, not from the context thread.  Hence, the blocking call is on the message dispatcher thread, and not from the context thread.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When creating a transacted session, the client application can decide to have its own dispatcher thread, or to share a dispatcher thread with other transacted sessions using the same context.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Refer to “Transacted Session” in the <a href="../Messaging-APIs/C-API/c-api-home.htm#Capireference" class="MCXref xref">C API Reference</a> for further details.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="file-desc-limitations"></a>File Descriptor Limitation</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>The number of Solace sessions created by an application shouldn't exceed the number of file descriptors supported per process by the underlying operating system. For Unix variants, this number is 1024, and for Windows it's 63.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">File descriptor limits in Unix platforms restrict the number of files that can be managed per process, and this is 1024 by default. Hence, an application shouldn't create more than 1023 Sessions per Context.  A session represents a TCP/IP connection, and such a connection occupies one file descriptor. A file descriptor is an element - usually a number - that allows you to identify, in this case, a stream of data from the socket. Open a file to read information from disk also occupies one file descriptor.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">File descriptors are called ‘file’ because initially they only identified files, although more recently, they can be used to identify files on disk, sockets, pipes, and so on.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Similarly, on Windows platforms, a single Context can only manage at most 63 Sessions.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="select-block-modes"></a>Selecting Blocking Modes</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Blocking and non-blocking modes are configurable Session property parameters. When creating a Session, an application can configure whether a blocking or non-blocking mode is used when a connection is established, for send, subscribe, and unsubscribe operations. See the table below for a list of the available blocking mode Session properties.</p>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Even if a blocking mode is set for a Session, blocking mode is ignored when a call is made within a Context message receive, event, or timer callback function. In this situation, a blocking call succeeds if it can be processed immediately in a Context thread, otherwise it returns <code>SOLCLIENT_WOULD_BLOCK</code> as if it were a non-blocking call.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Blocking applications must have separate threads for process events. Blocking threads are unblocked by events detected in the <code>solClient_context_processEvent</code> function.</p>
                                                            <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Blocking Mode Session Property Parameters</p>
                                                                </caption>
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Parameter</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SESSION_PROP_CONNECT_BLOCKING</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Sets whether to connect the Session in a blocking or non-blocking mode. </p>
                                                                            <p class="Tbl_Body">Use <code>SOLCLIENT_PROP_ENABLE_VAL</code> to connect in a blocking mode (the default). Use <code>SOLCLIENT_PROP_DISABLE_VAL</code> to connect in a non-blocking mode. The default is blocking mode.</p>
                                                                            <p class="Note">Avoid setting blocking connect when many Sessions are configured in a Context thread. Setting this mode serializes every step of the connection process for all the Sessions, and, as a result, increases the connection time.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SESSION_PROP_SEND_BLOCKING</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Sets whether a blocking or non-blocking send operation is used.</p>
                                                                            <p class="Tbl_Body">Use <code>SOLCLIENT_PROP_ENABLE_VAL</code> to send in a blocking mode (the default). Use <code>SOLCLIENT_PROP_DISABLE_VAL</code> to send in a non-blocking mode.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SESSION_PROP_SUBSCRIBE_BLOCKING</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Sets whether subscribe/unsubscribe operations occur in a blocking or non-blocking mode.</p>
                                                                            <p class="Tbl_Body">Use <code>SOLCLIENT_PROP_ENABLE_VAL</code> to subscribe in a blocking mode (the default). Use <code>SOLCLIENT_PROP_DISABLE_VAL</code> to subscribe in a non-blocking mode.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SESSION_PROP_BLOCKING_WRITE_TIMEOUT_MS</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p class="Tbl_Body">The time-out (in milliseconds) when sending messages or subscribing/unsubscribing in a blocking mode.</p>
                                                                            <p class="Note">If a time-out occurs, a return code <code>SOLCLIENT_FAIL</code> is returned.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="block-modes-impact-publishers"></a>How Blocking Modes Affect Publishing</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">How a <code>solClient_session_sendMsg</code> function call is handled depends on the blocking mode chosen for the Session.</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Blocking Mode<p>In this mode, the calling thread for each <code>solClient_session_sendMsg(...)</code> function call is blocked until C API accepts the message. As a result, the <code>solClient_session_sendMsg</code> calls are automatically limited to a rate at which the event broker can accept them. The <code>solClient_session_sendMsg</code> function call remains blocked until either it is accepted by the C API or the associated timer expires.</p></li>
                                                            </ul>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Non-blocking Mode<p>In this mode, <code>solClient_session_sendMsg</code> function calls that cannot be accepted by the C API immediately return a <code>SOLCIENT_WOULD_BLOCK</code> error code to the application. When it can be accepted, the API receives a subsequent <code>SOLCLIENT_SESSION_EVENT_CAN_SEND</code> event, and then it can retry sending the request. In the interim it can continue to process other actions.</p></li>
                                                            </ul>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="subscription-mgmt"></a>Subscription Management</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following best practices can be used for managing subscriptions:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>If you are adding or removing a large number of subscriptions, set the Wait for Confirm flag (<code>SOLCLIENT_SUBSCRIBE_FLAGS_WAITFORCONFIRM</code>) on the final subscription to ensure that all subscriptions have been processed by the event broker. On all other subscriptions, to increase performance, it is recommended that the application not set Wait for Confirm.</li>
                                                                <li>In the event of a Session disconnect, you can have the API reapply subscriptions that were initially added by the application when the Session is reconnected. To reapply subscriptions on reconnect, enable the Reapply Subscriptions Session property (<code>SOLCLIENT_SESSION_PROP_REAPPLY_SUBSCRIPTIONS</code>). Using this setting is recommended.</li>
                                                            </ul>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="ios-apps"></a>Working with iOS Applications</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The iOS distribution of the C API allows you to create new or integrate existing iOS applications for use with Solace PubSub+. This section provides information on special considerations that apply to iOS applications.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="ios-apps-state"></a>Responding to State and Connectivity Changes</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For best performance, an application should respond appropriately when its state changes or the device’s network connectivity changes. This ensures that the application does not attempt to maintain connections to the event broker when it has been moved to the background by the OS.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Responding to state and network connectivity changes properly will extend device battery life and minimize data connection usage.</p>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">State Changes</h4>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Applications should close session connections when they are moved to the background, and reopen any closed connections when they return to the foreground.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">As such, Solace recommends the following actions when state transitions occur:</p>
                                                            <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Responding to State Changes</p>
                                                                </caption>
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Event</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Recommended Action</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">applicationDidBecomeActive</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Application is about to move to the foreground. Establish session connections by calling <code>solClient_session_connect()</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">applicationWillResignActive</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p class="Tbl_Body">Application is transitioning out of the foreground. Close session connections by calling <code>solClient_session_disconnect()</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Network Connectivity Changes</h4>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For best performance, applications should communicate over wi-fi connections whenever they are available instead of wireless wide area network (WWAN) connections to lower data usage and increase battery life.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To prioritize wi-fi connections, Solace recommends the following actions when network connectivity changes occur:</p>
                                                            <table class="TableStyle-Table_Num" style="width: 624px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Responding to Network Connectivity Changes</p>
                                                                </caption>
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col width="25%" class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">WWAN Status</td>
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Wi-Fi Status</td>
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Event</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Recommended Action</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Not connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Wi-fi connects</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Force sessions to reconnect by calling <code>solClient_session_disconnect()</code> followed by <code>solClient_session_connect()</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Not connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">WWAN disconnects</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Close session connections by calling <code>solClient_session_disconnect()</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Not connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_Body">Wi-fi disconnects</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Close session connections by calling <code>solClient_session_disconnect()</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p class="Tbl_Body">Not connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p class="Tbl_Body">Not connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p class="Tbl_Body">WWAN connects</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
                                                                            <p class="Tbl_Body">Establish session connections by calling <code>solClient_session_connect()</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_Body">Not connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_Body">Not connected</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_Body">Wi-fi connects</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p class="Tbl_Body">Establish session connections by calling <code>solClient_session_connect()</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <p style="font-weight: bold;" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Related Samples</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For an example of how to respond to changes in application state, refer to the <code>AppTransitionsExample</code> sample included with the iOS API.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For an example of how to respond to changes in network state, refer to the <code>AppReachabilityExample</code> sample included with the iOS API. </p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="providing-trust-store"></a>Providing a Trust Store for Creating Secure Connections</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To create a secure connection to an event broker, the iOS distribution of the C API uses OpenSSL, which is included in the API. The process of creating secure connections through the iOS distribution of the C API is the same as with other distributions. However, a few special considerations are required for the iOS distribution to provide a trust store to the C API to validate the event broker’s server certificate.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When creating a secure connection, the C API attempts to establish trust with the remote event broker. To do so, the application must provide the path to a trust store that contains CA or self-signed certificates. A path to the trust store can be provided in one of the following ways:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Include a static trust store into the applications bundle as a resource, and then provide a path to that location.
            <p>For example, assuming that the application bundles a trust store folder named <code>trustStore</code>, which contains .crt files, the following code could be used to initialize the session with this trust store:</p><pre>// The path to the trustStore will be stored into trustStorePath
NSString* trustStorePath = [[[NSBundle mainBundle] resourcePath] stringByAppendingString:@"/trustStore"];
// This path must be passed to the session we are about to create and connect
sessionProps[propIndex++] = SOLCLIENT_SESSION_PROP_SSL_TRUST_STORE_DIR;
sessionProps[propIndex++] = [resourceDirectory cStringUsingEncoding:NSASCIIStringEncoding]</pre></li>
                                                                <li>Use <code>&lt;application_Home&gt;/Documents/</code> as the trust store, and then make that directory available to the user through file sharing. As this directory is initially empty, the application can copy a default trust store from the app bundle (as shown in the preceding bullet) into that directory. Then, the user can configure the trust store from iTunes through the application’s file sharing feature.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Which approach is best depends on how the event broker’s certificate is signed. It is recommended that a CA be created to sign the event broker’s certificate, and then to bundle this CA certificate into the application. An application designer can then use this CA to create a certificate for event brokers that the application will use. This approach ensures that the application designer has control over which event broker the application trusts.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="sending-messages"></a>Sending Messages</h2>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Blocking-send"></a>Blocking Send</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Send-blocking calls automatically limit the publishing rate at which an event broker can accept messages. Use non-blocking send to increase application performance.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">In send-blocking mode, the calling thread for each send function call is blocked until the API accepts the message, and hence, the sending rate is automatically limited to the rate at which the event broker can accept the message. The send call remains blocked until either:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>it's accepted by the API, or</li>
                                                                <li>the associated blocking write timeout expires.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Compared to non-blocking mode, send calls that cannot be accepted by the API will immediately return a <code>would_block</code> error code to the client application. In the meantime, the client application can continue to process other actions. Subsequently, the API will receive a <code>can_send</code> event which signifies that the client application can retry the send() function call again.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The send blocking parameter is <code>SOLCLIENT_SESSION_PROP_SEND_BLOCKING</code>.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Batch"></a>Batch Send</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Use the batch sending facility to optimize send performance.  This is particularly useful for performance benchmarking a client application.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Use the batch-sending facility to optimize send performance.  This is particularly useful for performance benchmarking client applications.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">A group of up to 50 messages can be sent through a single API call.  This allows messages to be sent in a batch.  The messages can be either Direct or Guaranteed. When batch-sending messages through the send-multiple API, the same Delivery mode, that is Direct or Persistent mode, should be set for all  messages in the batch. Messages in a batch can be set to different destinations.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">In addition to using the batch-sending API, messages should be pre-allocated and reused for batch-sending whenever possible. Specifically, don't reallocate new messages for each call to the batch-sending API.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The batch-sending API call is <code>solClient_session_sendMultipleMsg()</code>.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Time-to-live-msg"></a>Time-to-Live Messages</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Set the TTL attribute on published guaranteed messages to reduce the risk of unconsumed messages unintentionally piling up in the queue  if the use-case allows for discarding old or stale messages.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Publishing applications should consider utilizing the TTL feature available for Guaranteed Messaging. Publishers can set the TTL attribute on each message prior to sending to the event broker.  Once the message has been spooled, the message will be automatically discarded (or moved to the queue’s configured Dead Message Queue, if available) should the message not be consumed within the specified TTL.  This common practice reduces the risk of unconsumed messages unintentionally piling up.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Alternatively, queues have a <code>max-ttl</code> setting, and this can be used instead of publishers setting the TTL on each message sent. See <a href="../../Messaging/Guaranteed-Msg/Configuring-Queues.htm#Configur21" class="MCXref xref">Configuring Max Message TTLs</a> for instructions on setting <code>max-ttl</code> for a queue.</p>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Configuring respect-ttl</h4>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Queues should be configured to <code>respect-ttl</code> as, by default, this feature is disabled on all queues. Refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-Queues.htm#Enforcin" class="MCXref xref">Enforcing Whether to Respect TTLs</a> for instructions on how to set up <code>respect-ttl</code>.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="receive-messages"></a>Receiving Messages</h2>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Consume-messages"></a>Consume Messages As Soon As Possible</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>A Client Application should not block in the message receive callback, and should consume the received messages as soon as possible to avoid reception performance degradation.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To optimize messaging throughput, received messages should be consumed as soon as possible after receipt.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Client applications can expect to receive a return fail code when making API function calls from a callback routine, if the function call would be blocking in other threads.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The application should ensure that the callback is returned promptly as this API operates in asynchronous mode only. Waiting in callback routines can deadlock the application, or at a minimum severely degrade the receive performance.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="handle-dup-messages"></a>Handling Duplicate Message Publication</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Publishing duplicate messages can be avoided if the client application uses the Last Value Queue (LVQ) to determine the last message successfully spooled by the event broker upon restarting.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When a client application is  unexpectedly restarted, it's possible for it to become out-of-sync with respect to the message publishing sequence.  There should be a mechanism by which it can determine the last message that was successfully published to, and received by, the event broker in order to correctly resume publishing without injecting duplicate messages.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">One approach is for the publishing application to maintain a database that correlates between the published message identifier and the acknowledgment it receives from the event broker.  This approach is completely self-contained on the client application side, but can introduce processing latencies if not well managed.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Another approach is to make use of the Last Value Queue (LVQ) feature, where the LVQ stores the last message spooled on the queue. A publishing client application can then browse the LVQ to determine the last message spooled by the event broker.  This allows the publisher to resume publishing without introducing duplicate messages.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-Queues.htm#Configur16" class="MCXref xref">Configuring Max Spool Usage Values</a> for instructions on setting up LVQ.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="handle-redelivered-messages"></a>Handling Redelivered Messages</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>When consuming from endpoints, a client application should appropriately handle redelivered messages.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When a client application restarts, unexpectedly or not, and rebinds to a queue, it may receive messages that it had already processed as well as acknowledged.  This can happen because the acknowledgment can be lost on route to the event broker due to network issues.  The redelivered messages will be marked with the <code>redelivered</code> flag.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">A client application that binds to a non-exclusive queue may also receive messages with the <code>redelivered</code> flag set, even though the messages are received by the client application for the first time.  This is due to other clients connecting to the same non-exclusive queue which disconnects without the application acknowledging the received messages.  These messages are then redelivered to other client applications that bind to the same non-exclusive queue.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The consuming application should contain a message processing mechanism to handle the above mentioned scenarios.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="unexpected-messages"></a>Dealing with Unexpected Message Formats</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Client applications should be able to handle unexpected message formats.  In the case of consuming from endpoints, a client application should acknowledge received messages even if those messages are unexpectedly formatted.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Client applications should be able to contend with unexpected message formats.  There shouldn't be any assumptions made about a message's payload; for example, a payload may contain an empty attachment.  Applications should be coded such that they will avoid crashing, as well as logging the message contents and sending an acknowledgment back to the event broker if using Guaranteed Messaging. If client applications crash without sending acknowledgments, then when they reconnect, the same messages will be redelivered causing the applications to fail again.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="client-acks"></a>Client Acknowledgment</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Client Applications should acknowledge received messages as soon as they have completed processing those messages when client acknowledgment mode is used.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Once an application has completed processing a message, it should acknowledge the receipt of the message to the event broker.  Only when the event broker receives an acknowledgment for a Guaranteed Message will the message be permanently removed from its message spool. If the client disconnects without sending acknowledgments for some received messages, then those messages will be redelivered.  For the case of an exclusive queue, those messages will be delivered to the next connecting client.  For the case of a non-exclusive queue, those messages will be redelivered to the other clients that are bound to the  queue.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">There are two kinds of acknowledgments:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li><u>API (also known as Transport) Acknowledgment</u>.  This is an internal acknowledgment between the API and the event broker and isn't exposed to the application.  The Assured Delivery (AD) window size, acknowledgment timer, and the acknowledgment threshold settings control API Acknowledgment.  A message that isn't transport acknowledged will be automatically redelivered by the event broker.</li>
                                                                <li><u>Application Acknowledgment</u>.  This acknowledgment mechanism is on top of the API Acknowledgment. Its primary purpose is to confirm that message processing has been completed, and  that the corresponding messages can be permanently removed from the event broker. There are two application acknowledgment modes: auto-acknowledgment and client acknowledgment. When auto-acknowledgment mode is used, the API automatically generates application-level acknowledgments on behalf of the application.  When client acknowledgment mode is used, the client application must explicitly send the acknowledgment for the message ID of each message received.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Refer to the <a href="Receiving-Guaranteed-Messages.htm" class="MCXref xref">Receiving Guaranteed Messages</a> for a more detailed discussion on the different acknowledgment modes.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="do-not-block-callbacks"></a>Do Not Block in Callbacks</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Applications must not block in and should return as quickly as possible from message receive, event and timer callbacks so that the calling thread can process the next message, event or timer and perform internal API housekeeping. The one exception is for transacted sessions. Applications can call API-provided blocking functions such as commit, rollback and send from within the message receive callback of a transacted session.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Queues"></a>Queues and Flows</h2>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="rec-one-msg"></a>Receiving One Message at a Time</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Setting <code>max-delivered-unacked-msgs-per-flow</code> to 1 and AD Window Size to 1 to ensure messages are delivered from the event broker to the client application one message at a time and in a time-consistent manner.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">An API only sends transport acknowledgments when either,</p>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">it has received the configured acknowledgment threshold worth of configured Assured Delivery (AD) window messages (i.e. 60%)</li>
                                                                <li value="2">a message has been received and the configured AD acknowledgment time as passed since the last acknowledgment was sent (i.e. 1 seconds), whichever comes first.</li>
                                                            </ol>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The application acknowledgment piggybacks on the transport acknowledgment for the delivery from the client application to the event broker. And the event broker only releases further messages once it receives the acknowledgment.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Therefore, while setting <code>max-delivered-unacked-msgs-per-flow</code> to 1 will ensure that messages are delivered to the client application one at a time, if the AD window size is not 1, then condition 1 will not be immediately fulfilled. This will result in a reception delay variation since the API will only send the acknowledgment after condition 2 is fulfilled, and is therefore not consistent with the expected end-to-end message receipt delivery delay.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-Queues.htm#managing_guaranteed_messaging_1810020758_455709" class="MCXref xref">Configuring Max Permitted Number of Delivered Unacked Messages</a> for instructions on how to configure <code>max-delivered-unacked-msgs-per-flow</code> on queues.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="set-temporary-endpoints"></a>Setting Temporary Endpoint Spool Size</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Exercise caution if a client application frequently creates temporary endpoints to ensure that the sum of all temporary endpoint spool sizes does not exceed the total spool size provisioned for the Message VPN.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">By default, the message spool quota of a Message VPN and endpoint  is based on an over-subscription model.  For instance, it's possible to set the message spool quota  of multiple endpoints to the same quota as that of an entire Message VPN. Temporary endpoints created by a client application default to 4000 MB for the Solace application and 1500 MB for the software event broker. When temporary endpoints are used extensively by a client application, the message spool over-subscription model can quickly get out-of-control when temporary endpoints are being created on-demand. Therefore, it's recommended that a client application overwrite an endpoint’s default message spool size to a value that is inline with expected usage, especially if temporary endpoints are heavily used.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="AD"></a>AD Window Size and max-delivered-unacked-msgs-per-flow</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>The AD window size configured on the API should not be greater than the <code>max-delivered-unacked-msgs-per-flow</code> value that is set for a queue on the event broker.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>max-delivered-unacked-msgs-per-flow</code> controls how many messages the event broker can deliver to the client application without receiving back an acknowledgment.  The Assured Delivery (AD) window size controls how many messages can be in transit between the event broker and the client application. So, if the AD window size is greater than <code>max-delivered-unacked-msgs-per-flow</code>, then the API may not be able to acknowledge the messages it receives in a timely manner. Effectively, the AD window size is bounded by the value set for <code>max-delivered-unacked-msgs-per-flow</code>.  For instance, if the AD window size is set to 10, and <code>max-delivered-unacked-msgs-per-flow</code> is set to 5, then the event broker will effectively be limited to send out 5 messages at a time regardless of the client application’s AD window size setting of 10.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-Queues.htm#managing_guaranteed_messaging_1810020758_455709" class="MCXref xref">Configuring Max Permitted Number of Delivered Unacked Messages</a> for instructions on how to set up <code>max-delivered-unacked-msgs-per-flow</code> on queues.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="number-of-flows"></a>Number of Flows and AD Window Size</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Size the expected number of flows per session, and its associated AD window size, to within the available memory limit of the client application host, and within the default work units allocated per client egress queue on the event broker.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The API buffers received Guaranteed messages and, in general, also owns the messages and is responsible for freeing them. The amount of buffers used by a client is primarily determined by multiplying the Assured Delivery (AD) window size by the number of flows used per session. For example, if a receiving client application is using flows with an AD window size of 255 to bind to 10 different queues on an event broker, then the maximum buffer usage, given an average message size of 1 M, will be 2560 MB. If there are 10 such clients running on the same host, then 25.6 G of memory will be required.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Similarly, the event broker dedicates a per-client egress queue to buffer the to be transmitted messages to the client application.  By default, this is 20,000 work units, or an equivalent of 40 M worth of buffer as each work unit is 2048 bytes. For a per-client egress queue to support 2560 MB worth of buffering, the number of work units for this particular client will need to be increased to 130,560. Hence, depending on application usage, it's recommended that you dimension the AD window size in relation to the number of expected flows per session such that it will be within the default 20,000 work units worth of buffer per client connection.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="error-handling"></a>Error Handling and Logging</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When Sessions are terminated unexpectedly, error information can be collected and sent to the application. Error information is handled separately for each individual thread.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="logging-level"></a>Logging and Log Level</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Client Application Debug level logging should not be enabled in production environments.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Client Application Event logging can have a significant impact on performance, and so, in a production environment, it's not recommended to enable debug level logging.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="handle-session-event-errors"></a>Handling Session Events / Errors</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Client Applications should register an implementation of the Session Event handler interface / delegate / callback when creating a Session to receive Session events.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Client applications should register an implementation of the Session Event Handler interface / delegate / callback when creating a Session to receive Session events. A complete list of Session Event is listed in the table below.  Subsequently, Session events should be handled appropriately based on client application usage.</p>
                                                            <table class="TableStyle-Table_Num" style="width: 624px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Session Events</p>
                                                                </caption>
                                                                <col style="width: 548px;" class="TableStyle-Table_Num-Column-Column1" />
                                                                <col style="width: 342px;" class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">C
  (solclient.h)</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_ACKNOWLEDGEMENT</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The oldest transmitted Persistent / Non Persistent message that has been acknowledged.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_ASSURED_DELIVERY_DOWN</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>Guaranteed Delivery Publishing is not available.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_CAN_SEND</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The send is no longer blocked.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_CONNECT_FAILED_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
                                                                            <p>The Session attempted to connect but was unsuccessful.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_DOWN_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Session was established and then went down.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_MODIFYPROP_FAIL</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The session property modification failed.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_MODIFYPROP_OK</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The session property modification completed.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_PROVISION_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
                                                                            <p>The endpoint create/delete command failed.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_PROVISION_OK</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The endpoint create/delete command completed.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_RECONNECTED_NOTICE</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The automatic reconnect of the Session was successful, and the Session was established again.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_RECONNECTING_NOTICE</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Session has gone down, and an automatic reconnect attempt is in progress.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_REJECTED_MSG_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
                                                                            <p>The appliance rejected a published message.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_REPLUBLISH_UNACKED_MESSAGES</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>After successfully reconnecting a disconnected session, the API
 received an unknown publisher flow name response when reconnecting the
 Guaranteed Delivery publisher flow.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_RX_MSG_TOO_BIG_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The API discarded a received message that exceeded the Session buffer
 size.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_SUBSCRIPTION_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The application rejected a subscription (add or remove).</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_SUBSCRIPTION_OK</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
                                                                            <p>The subscribe or unsubscribe operation has succeeded.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_TE_UNSUBSCRIBE_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Topic Endpoint unsubscribe command failed.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_TE_UNSUBSCRIBE_OK</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Topic Endpoint unsubscribe completed.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_UP_NOTICE</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Session is established</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p>SOLCLIENT_SESSION_EVENT_VIRTUAL_ROUTER_NAME_CHANGED</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p>The appliance’s Virtual Router Name changed during a reconnect
 operation.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="handle-flow-events-errors"></a>Handling Flow Events / Errors</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>Client applications should register an implementation of the Flow Event handler interface / delegate / callback when creating a Flow to receive Flow events.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Client applications should register an implementation of the Flow Event Handler interface / delegate / callback when creating a Flow to receive Flow events. Flow error / events should be handled appropriately based on client application usage.</p>
                                                            <table class="TableStyle-Table_Num" style="width: 624px;caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Flow Events</p>
                                                                </caption>
                                                                <col style="width: 548px;" class="TableStyle-Table_Num-Column-Column1" />
                                                                <col style="width: 342px;" class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">
                                                                            <p><b>C
  (solclient.h)</b>
                                                                            </p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_UP_NOTICE</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Flow is established.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_DOWN_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Flow was established and then disconnected by the appliance, likely due to operator intervention.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_BIND_FAILED_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Flow attempted to connect but was unsuccessful.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_SESSION_DOWN</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
                                                                            <p>The Session for the Flow was disconnected.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_ACTIVE</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Flow has become active.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_INACTIVE</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>The Flow has become inactive.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_RECONNECTING</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p>When Flow Reconnect is enabled, instead of a DOWN_ERROR event, the API generates this event and attempts to rebind the Flow.</p>
                                                                            <p>If the Flow rebind fails, the API monitors the bind failure and terminates the reconnecting attempts with a DOWN_ERROR unless the failure reason  is one of the following:</p>
                                                                            <ul>
                                                                                <li>Queue Shutdown</li>
                                                                                <li>Topic Endpoint Shutdown</li>
                                                                                <li>Service Unavailable</li>
                                                                            </ul>
                                                                            <p>For more information about Flow Reconnect, refer to <a href="Creating-Flows.htm#Flow" class="MCXref xref">Flow Reconnect</a>.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1" data-mc-conditions="">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p>SOLCLIENT_FLOW_EVENT_RECONNECTED</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p>The Flow has been successfully reconnected.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="error-handling-functions"></a>Error Handling Functions</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To complete error handling, include calls to the functions listed below in your event handling code:</p>
                                                            <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Error Handling Functions</p>
                                                                </caption>
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Function</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">solClient_getLastErrorInfo()</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">Returns a pointer to a <code>solClient_errorInfo_t</code> structure. This data structure contains the last captured error information for the calling thread.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">solClient_resetLastErrorInfo()</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p class="Tbl_Body">Clears the last error information. Error information is recorded on a per-thread basis.</p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Subcodes-for-c"></a>Subcodes</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Subcodes provide more detailed error information. The basic subcodes that can result from any API call are listed in the table below.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Some API calls can also generate more specific error subcodes. For more information on these subcodes, refer to <a href="../../API-Developer-Online-Ref-Documentation/c/index.html" class="MCXref xref">Register Now for EDA Summit 2024 - Virtual Event Register for Free</a>.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The last generated subcode is stored on a per-thread basis and can be retrieved by an application thread. An application can call <code>solClient_subCodeToString()</code> to convert a subcode to a string.</p>
                                                            <table class="TableStyle-Table_Num" style="caption-side: top;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" cellspacing="0" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <caption valign="top" style="padding-bottom: 3pt;">
                                                                    <p class="TblCaption">Generic Subcodes</p>
                                                                </caption>
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <col class="TableStyle-Table_Num-Column-Column1" />
                                                                <thead>
                                                                    <tr class="TableStyle-Table_Num-Head-Header1">
                                                                        <td class="TableStyle-Table_Num-HeadE-Column1-Header1">Subcode</td>
                                                                        <td class="TableStyle-Table_Num-HeadD-Column1-Header1">Description</td>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SUBCODE_INIT_NOT_CALLED</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">An API call failed because <code>solClient_initialize(...) </code>was not called first.</p>
                                                                            <p class="Note">This subcode cannot occur for functions that are allowed to be called before <code>solClient_initialize</code>.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SUBCODE_PARAM_OUT_OF_RANGE</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">An API call was made with an out-of-range parameter. </p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SUBCODE_PARAM_NULL_PTR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">An API call was made with a null or invalid pointer parameter. </p>
                                                                            <p class="Note">This subcode only applies to functions that accept pointer parameters.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyE-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SUBCODE_PARAM_CONFLICT</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyD-Column1-Body1">
                                                                            <p class="Tbl_Body">An API call was made with an invalid parameter combination.</p>
                                                                            <p class="Note">This subcode only applies to functions that have interdependent parameters.</p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SUBCODE_INTERNAL_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">An API call had an internal error (not an application fault). </p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyH-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SUBCODE_OS_ERROR</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyG-Column1-Body1">
                                                                            <p class="Tbl_Body">An API call failed because of a failed operating system call. </p>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="TableStyle-Table_Num-Body-Body1">
                                                                        <td class="TableStyle-Table_Num-BodyB-Column1-Body1">
                                                                            <p class="Tbl_BodyCode">SOLCLIENT_SUBCODE_OUT_OF_MEMORY</p>
                                                                        </td>
                                                                        <td class="TableStyle-Table_Num-BodyA-Column1-Body1">
                                                                            <p class="Tbl_Body">An API call failed because memory could not be allocated. </p>
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="message-config-client-behavior"></a>Event Broker Configuration that Influences Client Application Behavior</h2>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="max-redelivery"></a>Max Redelivery</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>By default, messages are to be redelivered indefinitely from endpoints to clients.  Set the maximum redelivery option on endpoints at the event broker, when appropriate, to limit the maximum number of message redeliveries per message.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The maximum redelivery option can be set on an endpoint to control the number of deliveries per message on that endpoint.  After the maximum number of redeliveries by the endpoint is exceeded, messages are either discarded or moved to the Dead Message Queue (DMQ), if it's configured and the messages are set to DMQ eligible.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">There are benefits for client applications when the number of redeliveries on an endpoint is not infinite (by default the redelivery mode is set to redelivery forever). For instance, if a client application is unable to handle unexpected poison messages, the message will eventually be discarded or moved to DMQ where further examination can take place.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Reject"></a>Reject Message to Sender on Discard</h3>
                                                            <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Recommendation</h4>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li><code>reject-msg-to-sender-on-discard</code> on an endpoint should be enabled unless there are good reasons not to.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When publishing guaranteed messages to an event broker, messages can be discarded for reasons such as message-spool full, maximum message size exceeded, endpoint shutdown, and so on.  If the message discard option on the endpoint, that is, <code>reject-msg-to-sender-on-discard</code>, is enabled, then the client application will be able to detect that discarding is happening and take corrective action such as pausing publication. There is no explicit support at the API to pause publication; this should be carried out by the client application logic.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">One reason to consider disabling <code>reject-msg-to-send-on-discard</code> is the situation where there are multiple queues subscribing to the same topic that the Guaranteed messages are published to, and the intent is for other queues to continue receiving messages even if one of the queues is deemed unable to accept messages.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="no-print">
                                            <div><a href="#" id="docsFeedbackTrigger" class="docs-issue-collector">Provide feedback</a>
                                            </div>
                                        </div>
                                        <footer class="my-4 pt-4 text-center no-print">
                                            <div class="footer-txt text-center no-print">
                                                <ul class="list-inline ">
                                                    <li class="list-inline-item text-muted"><a href="../../Resources/Documentation-Set.htm" class="doc-set-footer-link MCXref xref xrefdoc-set-footer-link">Documentation Coverage</a>: <span class="mc-variable Variables.DocumentSetNumber variable">2024.09.16.0001</span></li>
                                                    <li class="list-inline-item text-muted">Last Updated: <span class="mc-variable Variables.MonthDayYear variable">September 16, 2024</span></li>
                                                    <li class="list-inline-item text-muted" style="font-size:13px;"> ©  <span class="mc-variable Variables.CompanyNameLegal variable">Solace Corporation</span></li>
                                                </ul>
                                            </div>
                                            <div class="footer-icons">
                                                <ul class="list-inline">
                                                    <li class="list-inline-item"><a href="https://facebook.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/facebook_22x21.png" class="Hyperlinked" alt="Facebook" title="Solace Facebook Page" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.linkedin.com/company/20219" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/LinkedIn_22x21.png" class="Hyperlinked" alt="LinkedIn" title="Solace LinkedIn Page" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://twitter.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/Twitter_22x21.png" class="Hyperlinked" alt="Twitter" title="Solace Twitter Feed" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.youtube.com/user/SolaceSystems" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/youtube_22x21.png" class="Hyperlinked" alt="YouTube" title="Solace YouTube Channel" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.instagram.com/solacedotcom/" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/instagram_22x21.png" class="Hyperlinked" alt="Instagram" title="Solace Instagram Feed" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://medium.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/medium_22x21.png" class="Hyperlinked" alt="Medium" title="Solace Medium Blog" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="footer_link_menu">
                                                <ul class="link_list">
                                                    <li class="link_list_item"><a href="https://solace.com/products/" target="_blank" class="footer-link">Products</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/company/" target="_blank" class="footer-link">Company</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://www.solace.dev/" target="_blank" class="footer-link">Developers</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/support/" target="_blank" class="footer-link">Support</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/contact/" target="_blank" class="footer-link">Contact Us</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </footer>
                                    </div>
                                    <!-- JIRA issue collector -->
                                    <script>/*<![CDATA[*/// Requires jQuery!
jQuery.ajax({
    url: "https://sol-jira.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e-T/o2joag/b/24/e73395c53c3b10fde2303f4bf74ffbf6/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-US&collectorId=076e0808",
    type: "get",
    cache: true,
    dataType: "script"
});
window.ATL_JQ_PAGE_PROPS = {
"triggerFunction": function(showCollectorDialog) {
//Requires that jQuery is available!
$("#docsFeedbackTrigger").click(function(e) {
e.preventDefault();
showCollectorDialog();
});
},
fieldValues: {
recordWebInfo: '1', // field Name
recordWebInfoConsent: ['1'] // field Id
}
};
/*]]>*/</script>
                                    <script src="../../Resources/Scripts/thumbnail.js">
                                    </script>
                                    <!-- Script for Launching offsite links in new tab -->
                                    <script type="text/javascript">/*<![CDATA[*/$("a[href^='http']").attr("target","_blank");/*]]>*/</script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
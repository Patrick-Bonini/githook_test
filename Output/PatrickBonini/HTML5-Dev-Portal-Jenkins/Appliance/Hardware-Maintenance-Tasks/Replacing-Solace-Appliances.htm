<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="PubSub+ Appliance|Hardware Maintenance" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta http-equiv="Cache-control" content="no-cache" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Replacing Solace PubSub+ Appliances</title>
        <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /> -->
        <!--style to display feedback button correctly in IE-->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- links to get the EDA styling to work -->
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../Resources/Stylesheets/MainStyles.min.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
        <style>@media screen and (min-width: 0\0)
{
	.feedback-button
	{
		margin-right: -40px;
		top: 50%;
		border-radius: 9px 9px 0px 0px;
	}

	#canvas
	{
		position: relative;
	}
}

@media print
{
	#plugin
	{
		overflow: visible !important;
	}
}

</style>
        <link href="../../Resources/Stylesheets/eda_styles.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css" />
        <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png" />
        <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script src="https://cmp.osano.com/AzZrhlTmT5f216Foa/84ba7dc4-a4e5-4b02-b120-977eb6f052d4/osano.js">
        </script>
        <script type="text/javascript">/*<![CDATA[*/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KLSDFH');
		/*]]>*/</script>
        <script type="text/javascript" src="../../Skins/Default/Scripts/TopicToolBar.js">
        </script>
    </head>
    <!-- Top Orange and Darkgrey header-->
    <!-- Div for EDA banner -->
    <div class="eda_banner">
        <p>Register Now for EDA Summit 2024 - Virtual Event <a href="https://edasummit.com/" target="_blank">Register for Free</a></p>
    </div>
    <!-- end Div for EDA banner -->
    <div class="top-nav">
        <div class="main_list">
            <ul class="top-navlinks">
                <li><a href="https://solace.com/support/" target="_blank">Support</a>
                </li>
                <li><a href="https://solace.com/contact/" target="_blank">Contact Us</a>
                </li>
            </ul>
        </div>
        <div class="container-fluid">
            <div class="src-li">
                <div id="srchWrapTwo">
                    <form class="search" action="#">
                        <div class="search-bar search-bar-container needs-pie">
                            <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs" />
                            <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                </div>
                                <div class="search-filter-content" id="sf-content">
                                    <ul>
                                        <li>
                                            <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="search-submit-wrapper" dir="ltr">
                                <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div><span class="tool-tip" tooltip-position="left" tooltip="To search for CLI commands, events, or APIs, navigate to the related sections.">i</span>
            <!-- Sept. 28, 2022 - This is being moved to under div class= top-nav
			<div class="main_list">
				<ul class="top-navlinks">
					<li><a href="https://solace.com/support/" target="_blank">Support</a></li>
					<li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li>
				</ul>
			</div> -->
        </div>
        <!-- Sept. 27, 2022 - The commented out content below used to provide the products, company, etc., links in the top header, next to the search field. -->
        <!-- <div class="main_list"><ul class="top-navlinks"><li><a href="https://solace.com/products/" target="_blank">Products</a></li><li><a href="https://solace.com/company/" target="_blank">Company</a></li><li><a href="https://www.solace.dev/" target="_blank">Developers</a></li><li><a href="https://solace.com/support/" target="_blank">Support</a></li><li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li></ul></div> -->
    </div>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1000px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../index.html" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic Print NextTopic;">
                                        <div class="button-group-container-left">
                                            <button class="button needs-pie print-button" title="Print">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Print">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie previous-topic-button" title="Navigate previous topic" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                            <button class="button needs-pie next-topic-button" title="Navigate next topic" disabled="true">
                                                <div>
                                                    <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                        <div class="button-icon"> </div>
                                                    </div>
                                                </div>
                                            </button>
                                        </div>
                                    </div>
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLSDFH" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div id="content">
                                        <div id="contentBody">
                                            <div class="row collapse">
                                                <div class="ContentRow" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                    <div>
                                                        <div class="nocontent" xmlns="">
                                                            <div class="MCBreadcrumbsBox_MCBreadcrumbsSelf_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="4" data-mc-toc="True"><span class="MCBreadcrumbsPrefix"> </span>
                                                            </div>
                                                        </div>
                                                        <div role="main" id="mc-main-content" xmlns="">
                                                            <h1 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="aanchor159" xmlns=""></a>
                                                                <MadCap:concept term="Appliance" />Replacing Solace PubSub+ Appliances</h1>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This section shows the steps required to replace operating Solace PubSub+ appliances with newer ones. Instructions are provided for standalone appliances and those operating in High Availability (HA) redundant pairs.</p>
                                                            <p class="Note" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">These procedures  apply only for like-for-like replacements. If you are replacing  different chassis models or NAB/ADB types, <a href="../../get-support.htm" class="link-internal">contact Solace</a> because  there could be scaling differences  and  a custom procedure may be required.</p>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Replacin"></a>Replacing Standalone Appliances </h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This procedure shows you how to replace a single standalone appliance.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Precondi"></a>Before you begin </h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The procedure shown in the <a href="#Steps" class="MCXref xref">Steps</a> section assumes that:</p>
                                                            <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li>The appliance doesn't belong to a redundant HA pair.</li>
                                                                <li>Neither Replication nor Guaranteed VPN Bridges nor both are configured.
				<p>If these features are in use, you'll need to consult one of the following prior to performing the instructions in the <a href="#Steps" class="MCXref xref">Steps</a> section:</p><ul><li>If only Replication is configured: refer to <a href="#Addition" class="MCXref xref">Additional steps when Replication is configured</a>. </li><li>If only Guaranteed VPN Bridges are configured: refer to <a href="#Addition2" class="MCXref xref">Additional steps when Guaranteed VPN Bridges are configured</a>.</li><li>When Replication and Guaranteed VPN Bridges are both configured: refer to <a href="#Addition3" class="MCXref xref">Additional steps when both Replication and Guaranteed VPN Bridges are configured</a>.</li></ul></li>
                                                                <li>If the appliance has an ADB installed, you have access from the appliance to an external file server capable of temporarily holding the configuration database and the contents of its ADB. </li>
                                                                <li>If the appliance contains an HBA,  you must register the new appliance's HBA&#160;with the external array. For details, refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-External-Disk-Arrays.htm" class="MCXref xref">Configuring an External Disk Array for Guaranteed Messaging</a>.</li>
                                                            </ul>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The procedure doesn't affect the external disk-array used for message spooling as the disk-array is reused with the new hardware.</p>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Steps"></a>Steps</h3>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">Prepare the old appliance.<ol style="list-style-type: lower-alpha;"><li value="1">Shutdown the message-backbone to ensure   the event broker is not providing any services. 
			
			
			<p>Enter the following commands in the Solace CLI:<br /><p class="Code">solace(configure)# service<br />solace(configure/service)# msg-backbone<br />solace(configure/service/msg-backbone)# shutdown<br />All clients will be disconnected.<br />Do you want to continue (y/n)? y</p></p></li><li value="2">If the appliance uses an ADB, its contents must be backed up it can be restored later on the new hardware.
				
				
				<p>Enter the following commands:</p><p class="Code">solace(configure)# hardware message-spool<br />solace(configure/hardware/message-spool)# shutdown<br />All message spooling will be stopped.<br />Do you want to continue (y/n)? y<br />solace(configure/hardware/message-spool)# end<br />solace# admin<br />solace(admin)# system message-spool<br />solace(admin/system/message-spool)# backup-adb-to-disk<br />On the next system startup, the backed-up ADB state on disk will overwrite the current ADB state.<br />Do you want to continue (y/n)? y</p><p>This creates a directory <code>/usr/sw/adb</code>, which needs to be moved to an external file server. </p><p>To move the directory, enter the following commands:</p><p class="Code" xml:space="preserve">solace# shell "Backup adb to external file server"<br />login: support<br />Password: &lt;password&gt;<br />[support@solace ~]$ sudo su -
[sudo] password for root: &lt;password&gt;
[root@solace ~]# cd /usr/sw<br />[root@solace sw]# tar zcf /tmp/adb.&lt;hostname&gt;.tar.gz adb<br />[root@solace sw]# scp /tmp/adb.&lt;hostname&gt;.tar.gz &lt;username&gt;@&lt;hostname&gt;:/&lt;path-to-remote-dir&gt;
[root@solace sw]# exit
logout
[support@solace ~]$ exit
logout</p></li><li value="3">Backup the current configuration database to an external file server.<p><u>Example</u>:</p><p class="Code">copy current-config sftp://&lt;username&gt;@&lt;hostname&gt;/&lt;path-to-remote-dir&gt;/config_&lt;date&gt;.tar.gz</p><p class="Note">For information on how to back up a current configuration to a remote destination, refer to <a href="../../Admin/Managing-Event-Broker-Configurations.htm" class="MCXref xref">Backing Up and Restoring Event Broker Configurations</a>. Pay particular attention to the need to capture product-keys and certificate files, which are not automatically included in the backup.</p></li><li value="4">If the event broker hosts Solace Geneos Agent, its Solace Geneos Agent properties file (<code>solgeneos/config/solgeneosagent.properties</code>) must be copied to an external file server.</li></ol></li>
                                                                <li value="2">Swap the appliances.<ol style="list-style-type: lower-alpha;"><li value="1">Power-down the old appliance.
			
			<p>Enter the following commands:</p><p class="Code">solace# power-down<br />				This command powers off the appliance and does not restart it afterwards<br />				Do you want to continue (y/n)? y</p></li><li value="2">Label all cables and disconnect them from the appliance.</li><li value="3">Remove the appliance from the rack and replace it with the new one. For information on how to physically install appliances, refer to the help for the type of appliance being removed (refer to <a href="../Appliance-Set-Up/Hardware-Installation.htm" class="MCXref xref">Prerequisites &amp; Installation</a>).</li><li value="4">Reconnect all cables to the new appliance.</li><li value="5">Power up the new appliance, and through the management console, use the <code>setup</code> Config command to perform basic network parameters (refer to <a href="../Appliance-Set-Up/Initializing-Appliances.htm" class="MCXref xref">Initial Setup</a>).</li><li value="6">If the appliance has an HBA&#160;installed, register the HBA&#160;with the external array (refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-External-Disk-Arrays.htm" class="MCXref xref">Configuring an External Disk Array for Guaranteed Messaging</a>), then use the <code>reload</code> command to restart it.  </li></ol></li>
                                                                <li value="3">Prepare the new appliance.<ol style="list-style-type: lower-alpha;"><li value="1">Get the new appliance to run the same Solace PubSub+ version the old appliance ran. This may involve either an upgrade or a downgrade depending on what is shipped on the new hardware.<div class="Note"><ul><li>The tasks associated with upgrading the Solace PubSub+ software on an appliance are described in <a href="../Appliance-Upgrade/Appliance-Upgrade.htm" class="MCXref xref">Upgrade Procedures</a>.</li><li>For information on downgrading appliance versions, refer to <a href="../Changing-Software-Loads.htm#system_and_software_maintenance_tasks_3138406956_208346" class="MCXref xref">Downgrading Versions</a>.</li></ul></div></li><li value="2">Restore the old appliance's configuration database from the external file server to the new appliance.<p><u>Example</u>:</p><p class="Code">&lt;username&gt;@192.168.2.xx's password: &lt;password&gt;<br />solace# copy scp://&lt;username&gt;@&lt;host&gt;/&lt;path-to-remote-dir&gt;/config_&lt;date&gt;.tar.gz<br />solace# reload config config_&lt;date&gt;.tar.gz<br />This command causes a reload of the system<br />Do you want to continue (y/n)? <b>y</b></p><p class="Note">Restoring a configuration from a remote destination is discussed in <a href="../../Admin/Managing-Event-Broker-Configurations.htm" class="MCXref xref">Backing Up and Restoring Event Broker Configurations</a>. Pay particular attention to the need to restore product-keys and certificate files, which are not automatically included in the backup.</p></li><li value="3">If the appliance hosts Solace Geneos Agent, install Solace Geneos Agent and restore its properties file from the external file server. For information about installing and configuring Solace Geneos Agent, refer to <a href="../../Additional-Products/SolGeneos-Agent/SolGeneos-Overview.htm" class="MCXref xref">Solace Geneos Agent</a>.</li><li value="4">If the appliance has an ADB installed, its contents needs to be restored. Enter the following commands:
			
			<p class="Code" xml:space="preserve">solace# shell "Restore adb from external file server"<br />login: support<br />Password: &lt;password&gt;<br />[support@solace ~]$ sudo su -
[sudo] password for root: &lt;password
[root@solace ~]# cd /usr/sw
[root@solace sw]# tar xvfz /tmp/adb.&lt;hostname&gt;.tar.gz <br />[root@solace sw]# scp &lt;username&gt;@&lt;hostname&gt;:/&lt;path-to-remote-dir&gt;/adb-&lt;hostname&gt;.tar.gz /tmp<br />[root@solace sw]# exit
logout
[support@solace ~]$ exit
logout
</p><p>For the ADB contents to take effect, the appliance must be reloaded.</p><p> Enter the following commands:</p><p class="Code">solace# reload<br />This command causes a reload of the system<br />Do you want to continue (y/n)? y</p><p>After the appliance restarts, log back in and enable message spooling:</p><p class="Code">solace(configure)# hardware message-spool<br />solace(configure/hardware/message-spool)# no shutdown primary</p></li><li value="5">Re-enable message-backbone service:
				
				<p class="Code">solace(configure)# service<br />solace(configure/service)# msg-backbone<br />solace(configure/service/msg-backbone)# no shutdown</p></li></ol></li>
                                                            </ol>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Addition"></a>Additional steps when Replication is configured</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If Replication is configured, you must perform the following steps:</p>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">Shutdown Message VPN Replication on both sites.</li>
                                                                <li value="2">Shutdown Config-Sync on both sites.</li>
                                                                <li value="3">Perform the procedure shown in <a href="#Steps" class="MCXref xref">Steps</a>.</li>
                                                                <li value="4">Re-enable Config-Sync on both sites.</li>
                                                                <li value="5">Re-enable Message VPN Replication on both.</li>
                                                            </ol>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Addition2"></a>Additional steps when Guaranteed VPN Bridges are configured</h3>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">If Guaranteed VPN Bridges are configured, you must perform the following steps:</p>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">Identify the other appliances that connect to the appliance that is to be replaced.</li>
                                                                <li value="2">On each of those connected appliances reconfigure the remote Message VPN by removing the bridge queue.	</li>
                                                                <li value="3">Perform&#160;the <a href="#Steps" class="MCXref xref">Steps</a> on the appliance to be replaced.</li>
                                                                <li value="4">On each of the connected appliances add back the bridge queues.</li>
                                                            </ol>
                                                            <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Addition3"></a>Additional steps when both Replication and Guaranteed VPN Bridges are configured</h3>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">On both sites involved in the Replication configuration perform the following:
			<ul><li>Shutdown Message VPN Replication on both sites.</li><li>Shutdown Config-Sync on both sites.</li></ul></li>
                                                                <li value="2">Identify the other appliances that connect via Guaranteed VPN Bridges to the appliance that is to be replaced.
			<ul><li>On each of those connected appliances reconfigure the remote Message VPN by removing the bridge queue.</li></ul></li>
                                                                <li value="3">Perform the procedure shown in <a href="#Steps" class="MCXref xref">Steps</a> on the appliance to be replaced.</li>
                                                                <li value="4">On both sites involved in the Replication configuration perform the following:
			<ul><li>Re-enable Config-Sync on both sites.</li><li>Re-enable Message VPN Replication on both.</li></ul></li>
                                                                <li value="5">On each of the other appliances connected via Guaranteed VPN Bridges add back the bridge queues.</li>
                                                            </ol>
                                                            <h2 class="with-rule" xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Replacin2"></a>Replacing Both Appliances in an HA Pair</h2>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This procedure covers how to replace both appliances in an HA&#160;redundant pair. To perform this procedure, you must have access from the appliances to an external file server capable of temporarily holding the appliances' configuration databases and the contents of their ADBs (if installed). This procedure does not affect the external disk array used for message spooling—the disk-array is reused with the new hardware.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Be aware that if the appliances contain HBAs, you must register the new appliances' HBAs&#160;with the external array. For details, refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-External-Disk-Arrays.htm" class="MCXref xref">Configuring an External Disk Array for Guaranteed Messaging</a>.</p>
                                                            <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Certain steps are to be applied to one appliance or to both appliances in the pair.</p>
                                                            <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                                                <li value="1">Prepare the old appliances:<ol style="list-style-type: lower-alpha;"><li style="font-weight: normal;" value="1">Verify Config-Sync is operationally "up" (that is, the appliances are in-sync). Use the following Solace CLI command to verify this on both event brokers:
			<p class="Code">solace1# show config-sync<br />Admin Status                      : Enabled<br />Oper Status                       : Up</p><p class="Note">If the operational status is other than "Up" then this should be corrected before proceeding. Using ConfigSync to keep event broker configuration synchronized is fully described in <a href="../../Features/Config-Sync/Config-Sync-Overview.htm" class="MCXref xref">Config-Sync</a>.</p></li><li style="font-weight: normal;" value="2">Shutdown the message backbone to ensure that the appliances  do not provide any services. Enter the following commands for both event brokers:
				
				<p class="Code">solace1(configure)# service<br />solace1(configure/service)# msg-backbone<br />solace1(configure/service/msg-backbone)# shutdown<br />All clients will be disconnected.<br />Do you want to continue (y/n)? y</p></li><li value="3">Force the primary event broker to have activity. Enter the following commands in the CLI of the backup appliance:
				
				<p class="Code">solace2(configure)# redundancy<br />solace2(configure/redundancy)# release-activity</p></li><li value="4">If the appliances use ADBs, their contents must be backed up so they can be restored later on the new hardware.<p>Enter the following commands in the CLI of both appliances: </p><p class="Code">solace1(configure)# hardware message-spool<br />solace1(configure/hardware/message-spool)# shutdown<br />All message spooling will be stopped.<br />Do you want to continue (y/n)? y</p><p>Then enter the following commands only in the CLI of the primary appliance:</p><p class="Code">solace1(configure/hardware/message-spool)# end<br />solace1# admin<br />solace1(admin)# system message-spool<br />solace1(admin/system/message-spool)# backup-adb-to-disk<br />On the next system startup, the backed-up ADB state on disk will overwrite the current ADB state.<br />Do you want to continue (y/n)? y</p><p>This creates a directory <code>/usr/sw/adb</code>, which needs to be moved to an external file server. </p><p>To move the directory, enter the following commands in a support shell on the primary appliance:</p><p class="Code" xml:space="preserve">solace1# shell "Backup adb to external file server"<br />login: support<br />Password: &lt;password&gt;<br />[support@solace ~]$ sudo su -
[sudo] password for root: &lt;password&gt;
[root@solace ~]# cd /usr/sw<br />[root@solace sw]# tar zcf /tmp/adb.&lt;hostname&gt;.tar.gz adb<br />[root@solace sw]# scp /tmp/adb.&lt;hostname&gt;.tar.gz &lt;username&gt;@&lt;hostname&gt;/&lt;path-to-remote-dir&gt;
[root@solace sw]# exit
logout<br />[support@solace ~]$ exit
logout
</p></li></ol><ol style="list-style-type: lower-alpha;" data-mc-continue="true"><li value="5">Backup the current configuration database of both appliances to an external file server.<p><u>Example</u>:</p><p class="Code">solace1# copy current-config sftp://&lt;username&gt;@&lt;hostname&gt;/&lt;path-to-remote-dir&gt;/config_&lt;date&gt;.tar.gz</p><p class="Note">For information on how to back up a current configuration to a remote destination, refer to <a href="../../Admin/Managing-Event-Broker-Configurations.htm" class="MCXref xref">Backing Up and Restoring Event Broker Configurations</a>. Pay particular attention to the need to capture product-keys and certificate files, which are not automatically included in the backup.</p></li></ol><ol style="list-style-type: lower-alpha;" data-mc-continue="true"><li value="6"> If the event broker hosts Solace Geneos, its Solace Geneos properties file (<code>solgeneos/config/solgeneosagent.properties</code>) must be copied to an external file server.</li></ol></li>
                                                                <li value="2">Swap out the old appliances.<ol style="list-style-type: lower-alpha;"><li value="1">Power-down the old appliances.<p>Enter the following commands in the CLI of both appliances:</p><p class="Code">solace1# power-down<br />This command powers off the appliance and does not restart it afterwards<br />Do you want to continue (y/n)? <b>y</b></p></li><li value="2">Label all cables and disconnect them from the appliances.</li><li value="3">Remove the old appliances from the rack and replace them with the new ones.</li><li value="4">Reconnect all cables to the new appliances.</li><li value="5">Power up the new appliances, and through the management console, use the <code>setup</code> Config command to perform basic network initialization (refer to <a href="../Appliance-Set-Up/Initializing-Appliances.htm" class="MCXref xref">Initial Setup</a>).</li><li value="6">If the appliances have HBAs&#160;installed, register the HBAs&#160;with the external array (refer to <a href="../../Messaging/Guaranteed-Msg/Configuring-External-Disk-Arrays.htm" class="MCXref xref">Configuring an External Disk Array for Guaranteed Messaging</a>), then use the <code>reload</code> command to restart them.</li></ol></li>
                                                                <li value="3">Prepare the new appliances.<ol style="list-style-type: lower-alpha;"><li value="1">Get the new appliance to run the same Solace PubSub+ version the old appliance ran. This may involve either an upgrade or a downgrade depending on what is shipped on the new hardware.<div class="Note"><ul><li>The tasks associated with upgrading the Solace PubSub+ software on an appliance are described in <a href="../Appliance-Upgrade/Appliance-Upgrade.htm" class="MCXref xref">Upgrade Procedures</a>.</li><li>For information on downgrading appliance versions, refer to <a href="../Changing-Software-Loads.htm#system_and_software_maintenance_tasks_3138406956_208346" class="MCXref xref">Downgrading Versions</a>.</li></ul></div></li><li value="2">Restore the old appliances' configuration databases from the external file server.
			
			<p class="Code">&lt;username&gt;@192.168.2.xx's password: &lt;password&gt;<br />solace# copy scp://&lt;username&gt;@&lt;hostname&gt;/&lt;path-to-remote-directoryy&gt;/config_&lt;date&gt;.tar.gz<br />solace# reload config config_&lt;date&gt;.tar.gz<br />This command causes a reload of the system<br />Do you want to continue (y/n)? <b>y</b></p><div class="Note"><ul><li>Restoring a configuration from a remote destination is discussed in <a href="../../Admin/Managing-Event-Broker-Configurations.htm" class="MCXref xref">Backing Up and Restoring Event Broker Configurations</a>. Pay particular attention to the need to restore product-keys and certificate files, which are not automatically included in the backup.</li><li>If replay logs are included in the configuration and the appliances are set up in the active-active redundancy model, you must do a second restart of the backup appliance after reloading its configuration. Set the active-standby redundancy role of the backup appliance to <code>backup</code> prior to the restart. After the restart, set the active-standby role back to <code>none</code>.</li></ul></div></li><li value="3">If the appliance hosts Solace Geneos Agent, install Solace Geneos Agent and restore its properties file from the external file server. For information about installing and configuring Solace Geneos Agent, refer to <a href="../../Additional-Products/SolGeneos-Agent/SolGeneos-Overview.htm" class="MCXref xref">Solace Geneos Agent</a>.</li><li value="4">If the appliances use ADBs, theirs contents need to be restored. Enter the following commands in the CLI of the primary appliance:
				
				<p class="Code" xml:space="preserve">solace1# shell "Restore adb from external file server"<br />login: support<br />Password: &lt;password&gt;<br />[support@solace ~]$ sudo su -
[sudo] password for root: &lt;password&gt;
[root@solace ~]# cd /usr/sw<br />[root@solace sw]# tar xvfz /tmp/adb.&lt;hostname&gt;.tar.gz<br />[root@solace sw]# scp &lt;username&gt;@&lt;hostname&gt;:/&lt;path-to-remote-dir&gt;/adb-&lt;hostname&gt;.tar.gz /tmp<br />[root@solace sw]# exit
logout
[support@solace ~]$ exit
logout</p><p>For the ADB contents to take effect, the primary appliance must be reloaded. Enter the following commands:</p><p class="Code">solace1# reload<br />This command causes a reload of the system<br />Do you want to continue (y/n)? y</p><p>Log back into the primary appliance and enable message spooling:</p><p class="Code">solace1(configure)# hardware message-spool<br />solace1(configure/hardware/message-spool)# no shutdown primary</p><p>Then, on the backup appliance, enter the following CLI commands:</p><p class="Code">solace2(configure)# hardware message-spool<br />solace2(configure/hardware/message-spool)# no shutdown backup</p></li><li value="5">Re-enable message-backbone service. Enter the following commands in the CLI of both appliances:
				
				<p class="Code">solace1(configure)# service<br />solace1(configure/service)# msg-backbone<br />solace1(configure/service/msg-backbone)# no shutdown</p></li></ol></li>
                                                                <li style="font-weight: normal;" value="4">Verify Config-Sync is operationally "up" (that is, the event brokers are in-sync).<p> Enter the following commands in the CLI of both appliances:</p><p class="Code">dev2-22# show config-sync<br />Admin Status                      : Enabled<br />Oper Status                       : Up</p><p class="Note">If the operational status is other than "Up", then this should be corrected before proceeding. For information on how to use Config-Sync to keep event broker configurations synchronized, refer to <a href="../../Features/Config-Sync/Config-Sync-Overview.htm" class="MCXref xref">Config-Sync</a>.</p></li>
                                                            </ol>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="no-print">
                                            <div><a href="#" id="docsFeedbackTrigger" class="docs-issue-collector">Provide feedback</a>
                                            </div>
                                        </div>
                                        <footer class="my-4 pt-4 text-center no-print">
                                            <div class="footer-txt text-center no-print">
                                                <ul class="list-inline ">
                                                    <li class="list-inline-item text-muted"><a href="../../Resources/Documentation-Set.htm" class="doc-set-footer-link MCXref xref xrefdoc-set-footer-link">Documentation Coverage</a>: <span class="mc-variable Variables.DocumentSetNumber variable">2024.09.16.0001</span></li>
                                                    <li class="list-inline-item text-muted">Last Updated: <span class="mc-variable Variables.MonthDayYear variable">September 16, 2024</span></li>
                                                    <li class="list-inline-item text-muted" style="font-size:13px;"> ©  <span class="mc-variable Variables.CompanyNameLegal variable">Solace Corporation</span></li>
                                                </ul>
                                            </div>
                                            <div class="footer-icons">
                                                <ul class="list-inline">
                                                    <li class="list-inline-item"><a href="https://facebook.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/facebook_22x21.png" class="Hyperlinked" alt="Facebook" title="Solace Facebook Page" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.linkedin.com/company/20219" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/LinkedIn_22x21.png" class="Hyperlinked" alt="LinkedIn" title="Solace LinkedIn Page" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://twitter.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/Twitter_22x21.png" class="Hyperlinked" alt="Twitter" title="Solace Twitter Feed" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.youtube.com/user/SolaceSystems" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/youtube_22x21.png" class="Hyperlinked" alt="YouTube" title="Solace YouTube Channel" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://www.instagram.com/solacedotcom/" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/instagram_22x21.png" class="Hyperlinked" alt="Instagram" title="Solace Instagram Feed" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                    <li class="list-inline-item"><a href="https://medium.com/solacedotcom" target="_blank" class="social-media-icon"><img src="../../Resources/Images/Social-Media/medium_22x21.png" class="Hyperlinked" alt="Medium" title="Solace Medium Blog" style="width: 22;height: 21;" /></a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <div class="footer_link_menu">
                                                <ul class="link_list">
                                                    <li class="link_list_item"><a href="https://solace.com/products/" target="_blank" class="footer-link">Products</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/company/" target="_blank" class="footer-link">Company</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://www.solace.dev/" target="_blank" class="footer-link">Developers</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/support/" target="_blank" class="footer-link">Support</a>
                                                    </li>
                                                    <li class="link_list_item"><a href="https://solace.com/contact/" target="_blank" class="footer-link">Contact Us</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </footer>
                                    </div>
                                    <!-- JIRA issue collector -->
                                    <script>/*<![CDATA[*/// Requires jQuery!
jQuery.ajax({
    url: "https://sol-jira.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e-T/o2joag/b/24/e73395c53c3b10fde2303f4bf74ffbf6/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-US&collectorId=076e0808",
    type: "get",
    cache: true,
    dataType: "script"
});
window.ATL_JQ_PAGE_PROPS = {
"triggerFunction": function(showCollectorDialog) {
//Requires that jQuery is available!
$("#docsFeedbackTrigger").click(function(e) {
e.preventDefault();
showCollectorDialog();
});
},
fieldValues: {
recordWebInfo: '1', // field Name
recordWebInfoConsent: ['1'] // field Id
}
};
/*]]>*/</script>
                                    <script src="../../Resources/Scripts/thumbnail.js">
                                    </script>
                                    <!-- Script for Launching offsite links in new tab -->
                                    <script type="text/javascript">/*<![CDATA[*/$("a[href^='http']").attr("target","_blank");/*]]>*/</script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
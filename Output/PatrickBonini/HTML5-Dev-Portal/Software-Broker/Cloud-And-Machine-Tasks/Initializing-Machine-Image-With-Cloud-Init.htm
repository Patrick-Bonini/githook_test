<?xml version="1.0"?>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-searchable="False" data-mc-toc-path="PubSub+ Software Event Broker|Other Deployment Options|Virtual Machine Images|[%=System.LinkedHeader%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="robots" content="noindex, nofollow"/>
    <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png"/>
    <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png"/>
    <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png"/>
    <meta charset="utf-8"/>
    <meta http-equiv="Cache-control" content="no-cache"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Initializing a Machine Image using cloud-init</title>
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /> -->
    <!--style to display feedback button correctly in IE-->
    <!-- Google Tag Manager -->
    <!-- End Google Tag Manager -->
    <!-- links to get the EDA styling to work -->
    <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Resources/Stylesheets/MainStyles.min.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <style>@media screen and (min-width: 0\0)
{
	.feedback-button
	{
		margin-right: -40px;
		top: 50%;
		border-radius: 9px 9px 0px 0px;
	}

	#canvas
	{
		position: relative;
	}
}

@media print
{
	#plugin
	{
		overflow: visible !important;
	}
}

</style>
    <link href="../../Resources/Stylesheets/eda_styles.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
    <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
    <link href="../../Resources/TableStyles/Table_Num.css" rel="stylesheet" data-mc-stylesheet-type="table"/>
    <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png"/>
    <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png"/>
    <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png"/>
    <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
    <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    <script src="https://cmp.osano.com/AzZrhlTmT5f216Foa/84ba7dc4-a4e5-4b02-b120-977eb6f052d4/osano.js">
        </script>
    <script type="text/javascript">/*<![CDATA[*/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KLSDFH');
		/*]]>*/</script>
    <script type="text/javascript" src="../../Skins/Default/Scripts/TopicToolBar.js">
        </script>
  </head>
  <!-- Top Orange and Darkgrey header-->
  <!-- Div for EDA banner -->
  <div class="eda_banner">
    <p>Register Now for EDA Summit 2024 - Virtual Event <a href="https://edasummit.com/" target="_blank">Register for Free</a></p>
  </div>
  <!-- end Div for EDA banner -->
  <div class="top-nav">
    <div class="main_list">
      <ul class="top-navlinks">
        <li>
          <a href="https://solace.com/support/" target="_blank">Support</a>
        </li>
        <li>
          <a href="https://solace.com/contact/" target="_blank">Contact Us</a>
        </li>
      </ul>
    </div>
    <div class="container-fluid">
      <div class="src-li">
        <div id="srchWrapTwo">
          <form class="search" action="#">
            <div class="search-bar search-bar-container needs-pie">
              <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs"/>
              <div class="search-filter-wrapper">
                <span class="invisible-label" id="search-filters-label">Filter: </span>
                <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                </div>
                <div class="search-filter-content" id="sf-content">
                  <ul>
                    <li>
                      <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001">
                        <span id="filterSelectorLabel-00001">All Files</span>
                      </button>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="search-submit-wrapper" dir="ltr">
                <div class="search-submit" title="Search" role="button" tabindex="0">
                  <span class="invisible-label">Submit Search</span>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
      <span class="tool-tip" tooltip-position="left" tooltip="To search for CLI commands, events, or APIs, navigate to the related sections.">i</span>
      <!-- Sept. 28, 2022 - This is being moved to under div class= top-nav
			<div class="main_list">
				<ul class="top-navlinks">
					<li><a href="https://solace.com/support/" target="_blank">Support</a></li>
					<li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li>
				</ul>
			</div> -->
    </div>
    <!-- Sept. 27, 2022 - The commented out content below used to provide the products, company, etc., links in the top header, next to the search field. -->
    <!-- <div class="main_list"><ul class="top-navlinks"><li><a href="https://solace.com/products/" target="_blank">Products</a></li><li><a href="https://solace.com/company/" target="_blank">Company</a></li><li><a href="https://www.solace.dev/" target="_blank">Developers</a></li><li><a href="https://solace.com/support/" target="_blank">Support</a></li><li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li></ul></div> -->
  </div>
  <body>
    <div class="foundation-wrap off-canvas-wrapper">
      <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
        <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
          <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
        </aside>
        <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
          <div data-sticky-container="" class="title-bar-container">
            <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1000px)" data-mc-ignore="true">
              <a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
              <div class="middle title-bar-section outer-row clearfix">
                <div class="menu-icon-container relative clearfix">
                  <div class="central-account-wrapper">
                    <div class="central-dropdown">
                      <a class="central-account-drop">
                        <span class="central-account-image"/>
                        <span class="central-account-text">Account</span>
                      </a>
                      <div class="central-dropdown-content">
                        <a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                        <hr class="central-separator"/>
                        <a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                      </div>
                    </div>
                  </div>
                  <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas">
                    <span/>
                  </button>
                </div>
              </div>
              <div class="title-bar-layout outer-row">
                <div class="logo-wrapper">
                  <a class="logo" href="../../index.html" alt="Logo"/>
                </div>
                <div class="navigation-wrapper nocontent">
                  <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                    <li class="placeholder" style="visibility:hidden">
                      <a>placeholder</a>
                    </li>
                  </ul>
                </div>
                <div class="central-account-wrapper">
                  <div class="central-dropdown">
                    <a class="central-account-drop">
                      <span class="central-account-image"/>
                      <span class="central-account-text">Account</span>
                    </a>
                    <div class="central-dropdown-content">
                      <a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                      <hr class="central-separator"/>
                      <a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                    </div>
                  </div>
                </div>
                <div class="nav-search-wrapper">
                  <div class="nav-search row">
                    <form class="search" action="#">
                      <div class="search-bar search-bar-container needs-pie">
                        <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs"/>
                        <div class="search-filter-wrapper">
                          <span class="invisible-label" id="search-filters-label">Filter: </span>
                          <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                          <div class="search-filter-content" id="sf-content">
                            <ul>
                              <li>
                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001">
                                  <span id="filterSelectorLabel-00001">All Files</span>
                                </button>
                              </li>
                            </ul>
                          </div>
                        </div>
                        <div class="search-submit-wrapper" dir="ltr">
                          <div class="search-submit" title="Search" role="button" tabindex="0">
                            <span class="invisible-label">Submit Search</span>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </nav>
          </div>
          <div class="main-section">
            <div class="row outer-row sidenav-layout">
              <nav class="sidenav-wrapper">
                <div class="sidenav-container">
                  <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                </div>
              </nav>
              <div class="body-container">
                <div data-mc-content-body="True">
                  <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic Print NextTopic;">
                    <div class="button-group-container-left">
                      <button class="button needs-pie print-button" title="Print">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Print">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                      <button class="button needs-pie previous-topic-button" title="Navigate previous topic" disabled="true">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                      <button class="button needs-pie next-topic-button" title="Navigate next topic" disabled="true">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                    </div>
                  </div>
                  <!-- Google Tag Manager (noscript) -->
                  <noscript>
                    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLSDFH" height="0" width="0" style="display:none;visibility:hidden"/>
                  </noscript>
                  <!-- End Google Tag Manager (noscript) -->
                  <div id="content">
                    <div id="contentBody">
                      <div class="row collapse">
                        <div xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="ContentRow">
                          <div>
                            <div xmlns="" class="nocontent">
                              <div class="MCBreadcrumbsBox_MCBreadcrumbsSelf_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="4" data-mc-toc="True">
                                <span class="MCBreadcrumbsPrefix"> </span>
                              </div>
                            </div>
                            <div xmlns="" role="main" id="mc-main-content">
                              <h1 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a xmlns="" name="aanchor408"/><MadCap:concept term="Software"/>Initializing a Machine Image using <code>cloud-init</code></h1>
                              <div xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Caution">
                                <p>Distribution of PubSub+ packaged as a virtual machine broker image will cease as of release 10.8.1 (June 2024). For more details, see the <a href="https://solace.com/support/deprecated-features/">Deprecated Features</a>&#xA0;list.</p>
                                <p>Solace recommends that you transition to an alternate method of deploying PubSub+ prior to June 2024.&#xA0; Containers offer a flexible way to deploy PubSub+ in a number of environments, virtual machines,&#xA0; and other container platforms. For information about:</p>
                                <ul>
                                  <li>
                                    <p>Setting up containers, see <a href="../SW-Broker-Set-Up/Containers/Set-Up-Container-Image.htm" class="MCXref xref">Setting Up Container Images</a>.</p>
                                  </li>
                                  <li>
                                    <p>Deploying PubSub+ container images in production environments, see <a href="../SW-Broker-Set-Up/Containers/Deploying-Container-in-Production.htm" class="MCXref xref">Deploying PubSub+ Software Event Brokers in a Production Environment</a>.</p>
                                  </li>
                                </ul>
                              </div>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can initialize a software event broker cloud or machine image  with the <a href="https://cloudinit.readthedocs.io/en/latest/" target="_blank" class="link-offsite">cloud-init</a> utility. At start-up, <code>cloud-init</code> iterates through a list of provisioned datasources looking for valid <code>meta-data</code> and <code>user-data</code>.</p>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li><code>meta-data</code> is supplied as key value pairs, and can be used to configure instance specific parameters such as <code>instance-id</code>, <code>hostname</code>, and local IP addresses.</li>
                                <li><code>user-data</code> can be provided in many forms including files, scripts, and <code>#cloud-config</code>, which provides YAML-formatted <code>cloud-init</code> specific instructions. It can be used to update instance software packages, execute first-boot scripts, install certificates and configure users, groups, and authentication keys.</li>
                              </ul>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Note">The software event broker doesn't prevent the processing of any <code>user-data</code> (including <code>#cloud-config</code> commands) that are not applicable, or possibly harmful to system stability. Also, the software event broker neither prevents <code>user-data</code> from including scripts, nor does it selectively execute script content.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following table lists the valid datasources for the various software event brokers.</p>
                              <table xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="width: 65%;mc-table-style: url('../../Resources/TableStyles/Table_Num.css');" class="TableStyle-Table_Num" cellspacing="0">
                                <col class="TableStyle-Table_Num-Column-Column1"/>
                                <col class="TableStyle-Table_Num-Column-Column1"/>
                                <thead>
                                  <tr class="TableStyle-Table_Num-Head-Header1">
                                    <th class="TableStyle-Table_Num-HeadE-Column1-Header1">Solace PubSub+ software event broker </th>
                                    <th class="TableStyle-Table_Num-HeadD-Column1-Header1">Datasources</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr class="TableStyle-Table_Num-Body-Body1">
                                    <td class="TableStyle-Table_Num-BodyH-Column1-Body1">Standard, all VM Images</td>
                                    <td class="TableStyle-Table_Num-BodyG-Column1-Body1">NoCloud</td>
                                  </tr>
                                  <tr class="TableStyle-Table_Num-Body-Body1">
                                    <td class="TableStyle-Table_Num-BodyH-Column1-Body1">Standard, AMI for Amazon Web Services</td>
                                    <td class="TableStyle-Table_Num-BodyG-Column1-Body1">EC2</td>
                                  </tr>
                                  <tr class="TableStyle-Table_Num-Body-Body1">
                                    <td class="TableStyle-Table_Num-BodyH-Column1-Body1">Standard, OpenStack</td>
                                    <td class="TableStyle-Table_Num-BodyG-Column1-Body1">OpenStack</td>
                                  </tr>
                                  <tr class="TableStyle-Table_Num-Body-Body1">
                                    <td class="TableStyle-Table_Num-BodyE-Column1-Body1">Enterprise, all VM Images</td>
                                    <td class="TableStyle-Table_Num-BodyD-Column1-Body1">NoCloud</td>
                                  </tr>
                                  <tr class="TableStyle-Table_Num-Body-Body1">
                                    <td class="TableStyle-Table_Num-BodyH-Column1-Body1">Enterprise, AMI for Amazon Web Services</td>
                                    <td class="TableStyle-Table_Num-BodyG-Column1-Body1">EC2</td>
                                  </tr>
                                  <tr class="TableStyle-Table_Num-Body-Body1">
                                    <td class="TableStyle-Table_Num-BodyB-Column1-Body1">Enterprise, Open Stack</td>
                                    <td class="TableStyle-Table_Num-BodyA-Column1-Body1">OpenStack</td>
                                  </tr>
                                </tbody>
                              </table>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Note">The <code>NoCloud</code> datasource can load user provided initial configuration in <code>user-data</code> and <code>meta-data</code> from an ISO loaded in the Virtual Machine Guest CDROM drive.
For instructions on how to create the ISO, see <a href="#Create_Nocloud_Datasource" class="MCXref xref">Creating NoCloud Datasources</a>.</p>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="set-config-keys"/>Setting Configuration Keys</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can use a <code>cloud-init</code> module called <code>solace</code> to define configuration keys as environment variables for the software event broker's  container. Configuration via environment variables is supported where the variable name consists of the configuration key hierarchy concatenated with the underscore character. Environment variables are specified in <code>/etc/solace/solace-container.env.conf</code>, and configuration keys set by the <code>solace</code> module&#x2BC;s <code>configuration_keys</code> directive are written to <code>/etc/solace/solace-container.env.conf</code>.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The <code>solace</code> module, shown with its associated <code>configuration_keys</code> directive, has the following syntax within <code>#cloud-config</code>.</p>
                              <pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">#cloud-config
solace:
  configuration_keys:
    &lt;CONFIGURATION_KEY&gt;: &lt;VALUE&gt;
    &lt;CONFIGURATION_KEY&gt;: &lt;VALUE&gt;
</pre>
                              <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Configuration Keys for the Software Event Broker</h4>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To learn more about the configuration keys that you can use with the software event broker, see <a href="../Configuration-Keys-Reference.htm" class="MCXref xref">Configuration Keys</a>.</p>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="assign-volumes"/>Assigning Volumes to External Storage Devices</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can assign persistent storage volumes to external storage devices with <code>cloud-init</code> using the <code>solace</code> module&#x2BC;s <code>storage</code> directive. The <code>solace</code> module, shown with its associated <code>configuration_keys</code> and <code>storage</code> directives, has the following syntax within <code>#cloud-config</code>.</p>
                              <pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">#cloud-config
solace:
  configuration_keys:
    &lt;CONFIGURATION_KEY&gt;: &lt;VALUE&gt;
    &lt;CONFIGURATION_KEY&gt;: &lt;VALUE&gt;
  storage:
    &lt;VOLUME&gt;:
      device: &lt;DEVICE&gt;</pre>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">An example of the use of the <code>storage</code> directive is shown in <a href="#Config_AWS" class="MCXref xref">Initializing the Configuration for AWS</a>.</p>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="Config_Auth"/>Initializing User Authentication </h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">By default, the <code>sysadmin</code> user account is unlocked with an undefined password.  Remote login is explicitly blocked until the <code>sysadmin</code> user password has been defined.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">In cloud environments, the provider typically configures <code>sysadmin</code> users with a qualified <code>cloud-init</code> datasource, and usually <code>sysadmin</code> users are also assigned public/private SSH keys from <code>cloud-init user-data</code>. However, it is also possible for you to define the <code>sysadmin</code> password with <code>cloud-init user-data</code>, and you may also define additional host user accounts using <code>cloud-init user-data</code>.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">In enterprise environments, the system administrator is responsible for creating and configuring software event broker instances.  Typically, the <code>sysadmin</code> user is assigned a password on first login attempt at the Virtual Machine console. It is also possible to assign the password, or supply a public/private SSH key with <code>cloud-init user-data</code>, provided by an ISO image installed in the virtual machine CD-ROM drive. For example, text similar to the following <code>#cloud-config</code> snippet can be used to set the <code>sysadmin</code> password.</p>
                              <pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">#cloud-config

password: sysadmin
chpasswd: {expire: False}
</pre>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="Timezone"/>Initializing the Timezone </h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For software event broker 9.4.0 release onwards, you can set the timezone by adding the <code>timezone: &lt;timezone&gt;</code> in the <code>#cloud-config</code>. As shown in the example below, the following <code>#cloud-config</code> snippet sets the <code>timezone</code> to Canada/Eastern.</p>
                              <pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">#cloud-config

password: sysadmin
chpasswd: {expire: False}
timezone: Canada/Eastern
</pre>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="config-max-connections"/>Configuring the Maximum Number of Connections</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can configure the maximum number of client connections with the <code>system/scaling/maxconnectioncount</code> configuration key. For more information, see <a href="../System-Scaling-Parameters.htm" class="MCXref xref">Using System Scaling Parameters</a>.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following shows an example of a <code>user-data</code> text snippet that sets the maximum client connection value to 10,000.</p>
                              <pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">#cloud-config
solace:
  configuration_keys:
    system_scaling_maxconnectioncount: 10000</pre>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="Create_Nocloud_Datasource"/>Creating NoCloud Datasources</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">PubSub+ software event brokers that are configured to accept the NoCloud <code>cloud-init</code> datasource can load an initial configuration from an ISO loaded in the Virtual Machine Guest CDROM drive.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To create an ISO, perform the following steps:</p>
                              <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li value="1">Create a text file named <code>meta-data</code>. This file may be empty with a length of 0 bytes, or may contain any valid YAML for <code>cloud-init meta-data</code>.</li>
                                <li value="2">Create a text file named <code>user-data</code>. This file may be empty with a length 0 bytes, or may contain any valid YAML for <code>cloud-init user-data</code>.</li>
                                <li value="3">Generate the ISO using <code>genisoimage</code> or <code>mkisofs</code> on the Linux host.<pre>genisoimage -output docker_subnet.iso -volid cidata -joliet -rock user-data meta-data</pre><p>or</p><pre>mkisofs -output docker_subnet.iso -volid cidata -joliet -rock user-data meta-data</pre></li>
                              </ol>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="Config_AWS"/>Initializing the Configuration for AWS</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The <a href="../SW-Broker-Set-Up/Machine-Images/Set-Up-in-AWS.htm" class="MCXref xref">AWS</a> setup guide provides the steps required to get a software event broker cloud image running and ready for messaging in Amazon Web Services (AWS).  <a href="../SW-Broker-Set-Up/Machine-Images/Set-Up-in-AWS.htm#access-cli" class="MCXref xref">Step 3: Access the Solace CLI</a> , used for setting the admin user&#x2BC;s password, can be simplified through the use of the configuration keys <code>username/&lt;name&gt;/globalaccesslevel</code> and <code>username/&lt;name&gt;/password</code>. Setting up the admin user using configuration keys allows you to go directly to SolAdmin to manage the Solace PubSub+ software event broker, skipping additional configuration steps in Solace CLI.</p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Admin"/>Configuring the Admin User</h3>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure the admin user and assign a password during the initial setup of an PubSub+ software event broker image in AWS, you can enter configuration keys as <code>user-data</code> text, where the user-data consists of the configuration key hierarchy concatenated with the underscore character. Configuration keys as user-data text can be entered into the <code>User data</code> block in the <code>Advanced Details</code> section of the <code>Configure Instance Details</code> screen. In the example below, the password is <code>adminpwd</code>.</p>
                              <pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">#cloud-config

solace:
  configuration_keys:
     username_admin_globalaccesslevel: admin
     username_admin_password: adminpwd</pre>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="provision-storage"/>Provisioning Storage for the Software Event Broker </h3>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can also provision the software event broker <code>storage-group</code> at initial setup. You can perform the initialization with a two-step process. In this example the volume <code>storage-group</code> is assigned to a block device, and the <code>admin</code> user is configured and assigned a password. </p>
                              <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li value="1">On the <code>Configure Instance Details</code> screen, in the <code>Advanced Details</code> section, enter the following <code>user-data</code> text into the <code>User data</code> block:
<pre>#cloud-config
solace:
  configuration_keys:
     username_admin_globalaccesslevel: admin
     username_admin_password: adminpwd
     service_ssh_port: 22
     service_semp_port: 8080
  storage:
     storage-group:
         device: xvdb
</pre><p>The storage device appears in the software event broker host as <code>xvdb</code>.</p></li>
                                <li value="2">On AWS's <code>Add Storage</code> screen in the configuration process for the software event broker Cloud Image, add a new volume on which the <code>storage-group</code> will reside. In this example, a 30 GB device called <code>/dev/sdb</code> has been added.<p><img src="../../Resources/Images/SW-Broker-Setup/Machine/addExternalStorage.png" style="border-left-style: solid;border-left-width: 1px;border-right-style: solid;border-right-width: 1px;border-top-style: solid;border-top-width: 1px;border-bottom-style: solid;border-bottom-width: 1px;width: 100%;" alt=""/></p></li>
                                <li value="3">After you log into the software event broker's host, you can run the <code>solacectl storage</code> command  to view the new storage assignment.	
 <pre xml:space="preserve">&gt;sudo solacectl storage ls
Block Devices:
Name                                              Size      Note
xvda                                              30.0G     Main device
&#x2514;&#x2500;xvda1                                           0.2G
&#x2514;&#x2500;xvda2                                           29.8G
xvdb                                              30.0G
&#x2514;&#x2500;xvdb1                                           30.0G
Storage Volumes:
Name                                              Size      Used      Available Path
/dev/mapper/vg01-root                             9.8G      1.1G      8.8G      /
/dev/mapper/vg01-solace                           9.8G      67M       9.7G      /var/lib/docker/volumes

/dev/xvdb1                                        30G       1.3G      29G       /mnt/vmr
&#x251C;&#x2500;storage-group                                   30G       1.0G      29G       /mnt/vmr/storage-group/_data
Image Pool:
Name                                              Size      Used      Available
Image pool                                        8.905 GB  1.033 GB  7.872 GB</pre></li>
                              </ol>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="enable-cloudwatch"/>Enabling CloudWatch</h3>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The <code>docker-create-opt</code> directive is used to configure the Amazon CloudWatch Docker logging driver. For more information about that driver, refer to <a href="https://docs.docker.com/config/containers/logging/awslogs/" target="_blank" class="link-offsite">Amazon CloudWatch Logs logging driver</a> on Docker's documentation site.</p>
                              <pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">solace:
  docker-create-opt:
    log-driver:  awslogs
    log-opt:
      - awslogs-region=&lt;region&gt;
      - awslogs-group=&lt;LogGroup&gt;
      - awslogs-create-group=true</pre>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When configuring the Amazon CloudWatch log driver, you may want to use the logging configuration keys to output additional logs to <code>stdout</code> because anything sent to <code>stdout</code> will be sent to CloudWatch.</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="no-print">
                      <div>
                        <a href="#" id="docsFeedbackTrigger" class="docs-issue-collector">Provide feedback</a>
                      </div>
                    </div>
                    <footer class="my-4 pt-4 text-center no-print">
                      <div class="footer-txt text-center no-print">
                        <ul class="list-inline ">
                          <li class="list-inline-item text-muted"><a href="../../Resources/Documentation-Set.htm" class="doc-set-footer-link MCXref xref xrefdoc-set-footer-link">Documentation Coverage</a>: <span class="mc-variable Variables.DocumentSetNumber variable">2024.09.18.0001</span></li>
                          <li class="list-inline-item text-muted">Last Updated: <span class="mc-variable Variables.MonthDayYear variable">September 18, 2024</span></li>
                          <li class="list-inline-item text-muted" style="font-size:13px;"> &#xA9;  <span class="mc-variable Variables.CompanyNameLegal variable">Solace Corporation</span></li>
                        </ul>
                      </div>
                      <div class="footer-icons">
                        <ul class="list-inline">
                          <li class="list-inline-item">
                            <a href="https://facebook.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/facebook_22x21.png" class="Hyperlinked" alt="Facebook" title="Solace Facebook Page" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/20219" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/LinkedIn_22x21.png" class="Hyperlinked" alt="LinkedIn" title="Solace LinkedIn Page" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://twitter.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/Twitter_22x21.png" class="Hyperlinked" alt="Twitter" title="Solace Twitter Feed" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.youtube.com/user/SolaceSystems" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/youtube_22x21.png" class="Hyperlinked" alt="YouTube" title="Solace YouTube Channel" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.instagram.com/solacedotcom/" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/instagram_22x21.png" class="Hyperlinked" alt="Instagram" title="Solace Instagram Feed" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://medium.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/medium_22x21.png" class="Hyperlinked" alt="Medium" title="Solace Medium Blog" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                        </ul>
                      </div>
                      <div class="footer_link_menu">
                        <ul class="link_list">
                          <li class="link_list_item">
                            <a href="https://solace.com/products/" target="_blank" class="footer-link">Products</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/company/" target="_blank" class="footer-link">Company</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://www.solace.dev/" target="_blank" class="footer-link">Developers</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/support/" target="_blank" class="footer-link">Support</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/contact/" target="_blank" class="footer-link">Contact Us</a>
                          </li>
                        </ul>
                      </div>
                    </footer>
                  </div>
                  <!-- JIRA issue collector -->
                  <script>/*<![CDATA[*/// Requires jQuery!
jQuery.ajax({
    url: "https://sol-jira.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e-T/o2joag/b/24/e73395c53c3b10fde2303f4bf74ffbf6/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-US&collectorId=076e0808",
    type: "get",
    cache: true,
    dataType: "script"
});
window.ATL_JQ_PAGE_PROPS = {
"triggerFunction": function(showCollectorDialog) {
//Requires that jQuery is available!
$("#docsFeedbackTrigger").click(function(e) {
e.preventDefault();
showCollectorDialog();
});
},
fieldValues: {
recordWebInfo: '1', // field Name
recordWebInfoConsent: ['1'] // field Id
}
};
/*]]>*/</script>
                  <script src="../../Resources/Scripts/thumbnail.js">
                                    </script>
                  <!-- Script for Launching offsite links in new tab -->
                  <script type="text/javascript">/*<![CDATA[*/$("a[href^='http']").attr("target","_blank");/*]]>*/</script>
                </div>
              </div>
            </div>
          </div>
          <a data-close="true"/>
        </div>
      </div>
    </div>
  </body>
</html>

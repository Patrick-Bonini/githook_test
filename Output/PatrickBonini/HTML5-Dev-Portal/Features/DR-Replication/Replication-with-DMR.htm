<?xml version="1.0"?>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|Configuring Replication" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png"/>
    <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png"/>
    <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png"/>
    <meta charset="utf-8"/>
    <meta http-equiv="Cache-control" content="no-cache"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Configuring Replication with a DMR Network</title>
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /> -->
    <!--style to display feedback button correctly in IE-->
    <!-- Google Tag Manager -->
    <!-- End Google Tag Manager -->
    <!-- links to get the EDA styling to work -->
    <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Resources/Stylesheets/MainStyles.min.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <style>@media screen and (min-width: 0\0)
{
	.feedback-button
	{
		margin-right: -40px;
		top: 50%;
		border-radius: 9px 9px 0px 0px;
	}

	#canvas
	{
		position: relative;
	}
}

@media print
{
	#plugin
	{
		overflow: visible !important;
	}
}

</style>
    <link href="../../Resources/Stylesheets/eda_styles.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
    <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
    <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png"/>
    <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png"/>
    <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png"/>
    <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
    <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    <script src="https://cmp.osano.com/AzZrhlTmT5f216Foa/84ba7dc4-a4e5-4b02-b120-977eb6f052d4/osano.js">
        </script>
    <script type="text/javascript">/*<![CDATA[*/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KLSDFH');
		/*]]>*/</script>
    <script type="text/javascript" src="../../Skins/Default/Scripts/TopicToolBar.js">
        </script>
  </head>
  <!-- Top Orange and Darkgrey header-->
  <!-- Div for EDA banner -->
  <div class="eda_banner">
    <p>Register Now for EDA Summit 2024 - Virtual Event <a href="https://edasummit.com/" target="_blank">Register for Free</a></p>
  </div>
  <!-- end Div for EDA banner -->
  <div class="top-nav">
    <div class="main_list">
      <ul class="top-navlinks">
        <li>
          <a href="https://solace.com/support/" target="_blank">Support</a>
        </li>
        <li>
          <a href="https://solace.com/contact/" target="_blank">Contact Us</a>
        </li>
      </ul>
    </div>
    <div class="container-fluid">
      <div class="src-li">
        <div id="srchWrapTwo">
          <form class="search" action="#">
            <div class="search-bar search-bar-container needs-pie">
              <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs"/>
              <div class="search-filter-wrapper">
                <span class="invisible-label" id="search-filters-label">Filter: </span>
                <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                </div>
                <div class="search-filter-content" id="sf-content">
                  <ul>
                    <li>
                      <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001">
                        <span id="filterSelectorLabel-00001">All Files</span>
                      </button>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="search-submit-wrapper" dir="ltr">
                <div class="search-submit" title="Search" role="button" tabindex="0">
                  <span class="invisible-label">Submit Search</span>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
      <span class="tool-tip" tooltip-position="left" tooltip="To search for CLI commands, events, or APIs, navigate to the related sections.">i</span>
      <!-- Sept. 28, 2022 - This is being moved to under div class= top-nav
			<div class="main_list">
				<ul class="top-navlinks">
					<li><a href="https://solace.com/support/" target="_blank">Support</a></li>
					<li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li>
				</ul>
			</div> -->
    </div>
    <!-- Sept. 27, 2022 - The commented out content below used to provide the products, company, etc., links in the top header, next to the search field. -->
    <!-- <div class="main_list"><ul class="top-navlinks"><li><a href="https://solace.com/products/" target="_blank">Products</a></li><li><a href="https://solace.com/company/" target="_blank">Company</a></li><li><a href="https://www.solace.dev/" target="_blank">Developers</a></li><li><a href="https://solace.com/support/" target="_blank">Support</a></li><li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li></ul></div> -->
  </div>
  <body>
    <div class="foundation-wrap off-canvas-wrapper">
      <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
        <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
          <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
        </aside>
        <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
          <div data-sticky-container="" class="title-bar-container">
            <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1000px)" data-mc-ignore="true">
              <a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
              <div class="middle title-bar-section outer-row clearfix">
                <div class="menu-icon-container relative clearfix">
                  <div class="central-account-wrapper">
                    <div class="central-dropdown">
                      <a class="central-account-drop">
                        <span class="central-account-image"/>
                        <span class="central-account-text">Account</span>
                      </a>
                      <div class="central-dropdown-content">
                        <a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                        <hr class="central-separator"/>
                        <a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                      </div>
                    </div>
                  </div>
                  <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas">
                    <span/>
                  </button>
                </div>
              </div>
              <div class="title-bar-layout outer-row">
                <div class="logo-wrapper">
                  <a class="logo" href="../../index.html" alt="Logo"/>
                </div>
                <div class="navigation-wrapper nocontent">
                  <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                    <li class="placeholder" style="visibility:hidden">
                      <a>placeholder</a>
                    </li>
                  </ul>
                </div>
                <div class="central-account-wrapper">
                  <div class="central-dropdown">
                    <a class="central-account-drop">
                      <span class="central-account-image"/>
                      <span class="central-account-text">Account</span>
                    </a>
                    <div class="central-dropdown-content">
                      <a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                      <hr class="central-separator"/>
                      <a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                    </div>
                  </div>
                </div>
                <div class="nav-search-wrapper">
                  <div class="nav-search row">
                    <form class="search" action="#">
                      <div class="search-bar search-bar-container needs-pie">
                        <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs"/>
                        <div class="search-filter-wrapper">
                          <span class="invisible-label" id="search-filters-label">Filter: </span>
                          <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                          <div class="search-filter-content" id="sf-content">
                            <ul>
                              <li>
                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001">
                                  <span id="filterSelectorLabel-00001">All Files</span>
                                </button>
                              </li>
                            </ul>
                          </div>
                        </div>
                        <div class="search-submit-wrapper" dir="ltr">
                          <div class="search-submit" title="Search" role="button" tabindex="0">
                            <span class="invisible-label">Submit Search</span>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </nav>
          </div>
          <div class="main-section">
            <div class="row outer-row sidenav-layout">
              <nav class="sidenav-wrapper">
                <div class="sidenav-container">
                  <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                </div>
              </nav>
              <div class="body-container">
                <div data-mc-content-body="True">
                  <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic Print NextTopic;">
                    <div class="button-group-container-left">
                      <button class="button needs-pie print-button" title="Print">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Print">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                      <button class="button needs-pie previous-topic-button" title="Navigate previous topic" disabled="true">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                      <button class="button needs-pie next-topic-button" title="Navigate next topic" disabled="true">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                    </div>
                  </div>
                  <!-- Google Tag Manager (noscript) -->
                  <noscript>
                    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLSDFH" height="0" width="0" style="display:none;visibility:hidden"/>
                  </noscript>
                  <!-- End Google Tag Manager (noscript) -->
                  <div id="content">
                    <div id="contentBody">
                      <div class="row collapse">
                        <div xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="ContentRow">
                          <div>
                            <div xmlns="" class="nocontent">
                              <div class="MCBreadcrumbsBox_MCBreadcrumbsSelf_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="4" data-mc-toc="True">
                                <span class="MCBreadcrumbsPrefix"> </span>
                              </div>
                            </div>
                            <div xmlns="" role="main" id="mc-main-content">
                              <h1 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Configuring Replication with a DMR Network</h1>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can take advantage of disaster recovery (using replication and Config-Sync) while using Dynamic Message Routing (DMR) to dynamically route messages through your event mesh. DMR provides a means to interconnect instances of Solace PubSub+ event brokers so that messages published by clients hosted by one broker can be consumed by clients hosted on another. After the relationships between brokers are established, the broker automatically discovers how to route messages. Client applications don't need to take any action to publish or consume messages across the event mesh.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For more information, see the following:</p>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li>
                                  <a href="Replication-DMR-Overview.htm" class="MCXref xref">Using Replication with DMR</a>
                                </li>
                                <li>
                                  <a href="Data-Center-Replication-Overview.htm" class="MCXref xref">Data Center Replication for Disaster Recovery</a>
                                </li>
                                <li>
                                  <a href="../DMR/DMR-Overview.htm" class="MCXref xref">Dynamic Message Routing</a>
                                </li>
                                <li>
                                  <a href="../Config-Sync/Config-Sync-Overview.htm" class="MCXref xref">Config-Sync</a>
                                </li>
                              </ul>
                              <h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Using These Procedures</h4>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The instructions that follow are  applicable for both appliances and software event brokers, and for both single brokers and HA pairs.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Where a broker A (or B, etc.) is referenced, it may have an HA mate A' (or B', etc.). These procedures assume the following:</p>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li>broker A may have an HA mate A'</li>
                                <li>A is the primary broker, A' is the backup, and A is active</li>
                                <li>the redundancy status is UP</li>
                                <li>Config-Sync is enabled, and A and A' are currently synchronized</li>
                                <li>all nodes in the network are at the same software level</li>
                              </ul>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Note">In versions earlier than 10.0.1 replication was required to be enabled on all DMR-enabled Message VPNs. In versions 10.0.1 and later, replication may be enabled or disabled on all DMR-enabled Message VPNs. </p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">While Config-Sync is operational, you need to make configuration changes <b>only on the active broker</b>, which in this example is broker A of the A/A' pair. Any special considerations required are listed with each procedure.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Caution">Failing to follow these procedures, or using a procedure not listed here, may result in message loss.</p>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule" style="page-break-before: always;"><a name="Adding-replication-mate"/>Adding a Replication Mate to a Node in a DMR Network</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can add a replication mate to a node in a DMR network  without causing a service interruption to existing clients. During the procedure it is expected that the state of the cluster will be reported as DOWN and topology errors will be raised while links are being established between nodes. In spite of these errors, traffic will continue to flow through the network and no message loss is expected.</p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Assumptions</h3>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li>broker A in cluster C has existing DMR links (internal or external) to brokers X<sub>1</sub> through X<sub>n</sub></li>
                                <li>the state of the clusters on all of A and X<sub>1..n</sub> is UP</li>
                                <li>broker B is to be added as the replication mate of A</li>
                                <li>all brokers using HA or replication have Config-Sync enabled and UP</li>
                              </ul>
                              <div xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="thumbnail-container">
                                <a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-1.png" data-mc-popup-alt="">
                                  <img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1199" data-mc-height="474" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-1_thumb_500_0.png" alt="" tabindex=""/>
                                </a>
                              </div>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">High Availability Considerations</h3>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For software event brokers, you may have to provide a second connect-via address when you configure replication and links in the steps that follow. For example, when you configure the cluster link on A to B/B', you may have to provide the addresses for both B and B'.</p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Steps</h3>
                              <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li value="1">
                                  <p>Configure replication as normal between A and B, such that A is active and B standby:</p>
                                  <ol style="list-style-type: lower-alpha;">
                                    <li value="1">Set the global replication attributes on both A and B, such that A is the replication mate of B and vice-versa. See <a href="Replication-Sys-Level-Settings.htm" class="MCXref xref">Configuring System-Level Replication Settings</a>.</li>
                                    <li value="2">Create all Message VPNs on B that will be replicated from A. See <a href="../VPN/Configuring-VPNs.htm" class="MCXref xref">Configuring Message VPNs</a>.</li>
                                    <li value="3">Enable  replication for Message VPNs of A (active) and B (standby). See <a href="Replication-VPN-Level-Settings.htm#Enable-Replication" class="MCXref xref">Enabling Replication</a>.
					<p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-2.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1204" data-mc-height="494" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-2_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                  </ol>
                                </li>
                                <li value="2">Wait for Config-Sync on A and B to report all replicated Message VPNs as being <code>Ready-InSync</code>.</li>
                                <li value="3">Create cluster C on broker B, and configure its authentication and other attributes as needed. See <a href="../DMR/DMR-Mgmt-Cluster-Config.htm" class="MCXref xref">Configuring a DMR Cluster</a>.</li>
                                <li value="4">Create a new cluster link on A to B and on B to A (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes:<ul><li>span to be <code>internal</code></li><li>authentication settings</li><li>connect-via must NOT be set</li><li>enabled</li></ul></li>
                                <li value="5">
                                  <p>Verify that the link between A and B is UP. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Link" class="MCXref xref">Displaying Cluster Link Information</a>.</p>
                                  <p>
                                    <div class="thumbnail-container">
                                      <a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-3.png" data-mc-popup-alt="">
                                        <img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1204" data-mc-height="496" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-3_thumb_500_0.png" alt="" tabindex=""/>
                                      </a>
                                    </div>
                                  </p>
                                </li>
                                <li value="6">For each broker X<sub>1</sub> through X<sub>n</sub> do the following:<ol style="list-style-type: lower-alpha;"><li value="1">Wait for the cluster on X to report a missing link between X and B.</li><li value="2">Create a new cluster link on X to B and on B to X  (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). The new link attributes must match the existing ones to and from A, other than those that relate specifically to B: <ul><li>authentication settings</li><li>connect-via</li></ul></li><li value="3">If a new link has a span of <code>external</code>, on X, create the DMR bridges for each VPN between X and B, identical to those between X and A. See <a href="../DMR/DMR-Mgmt-Msg-Vpn.htm#Create-DMR-Bridge" class="MCXref xref">Configuring a DMR&#xA0;Bridge</a>.</li></ol></li>
                                <li value="7">
                                  <p>Verify that the links between X<sub>1</sub> through X<sub>n</sub> and B are UP. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Link" class="MCXref xref">Displaying Cluster Link Information</a>.</p>
                                  <p>
                                    <div class="thumbnail-container">
                                      <a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-4.png" data-mc-popup-alt="">
                                        <img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1208" data-mc-height="491" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-mate-4_thumb_500_0.png" alt="" tabindex=""/>
                                      </a>
                                    </div>
                                  </p>
                                </li>
                                <li value="8">Verify that the cluster is UP on all brokers. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Info" class="MCXref xref">Displaying Cluster Information</a>.</li>
                              </ol>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The new replication mate B is now fully integrated into the DMR network.</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Optional:&#xA0;You can now move selected replicated Message VPNs on A such that they are active on B.</p>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule" style="page-break-before: always;"><a name="Removing-replication-mate"/>Removing a Replication Mate from a Node in a DMR Network</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can remove a replication mate from a node in a DMR network  without causing a service interruption to existing clients if the node being removed is not hosting any clients (i.e. it is replication standby). During the procedure it is expected that the state of the cluster will be reported as DOWN and topology errors will be raised  while links are being removed between nodes.  In spite of these errors, traffic will continue to flow through the network and no message loss is expected.</p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Assumptions</h3>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li>broker A in cluster C has existing DMR links (internal or external) to brokers X<sub>1</sub> through X<sub>n</sub></li>
                                <li>the state of the cluster(s) on broker A and all brokers X<sub>1..n</sub> is UP</li>
                                <li>broker B (to be removed) is the replication mate of A</li>
                                <li>all Message VPNs have an active replication state on broker A and a standby replication state on broker B</li>
                                <li>all brokers using redundancy or replication have Config-Sync enabled and UP</li>
                              </ul>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <div class="thumbnail-container">
                                  <a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-1.png" data-mc-popup-alt="">
                                    <img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1205" data-mc-height="506" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-1_thumb_500_0.png" alt="" tabindex=""/>
                                  </a>
                                </div>
                              </p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Steps</h3>
                              <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li value="1">On each broker X<sub>1</sub> through X<sub>n</sub>, disable and remove the cluster link to B:<pre class="Code" xml:space="preserve">broker-X1(configure)# routing
broker-X1(configure/routing)# dynamic-message-routing
broker-X1(...igure/routing/dynamic-message-routing)# cluster cluster-C
broker-X1(...uting/dynamic-message-routing/cluster)# link broker-B
broker-X1(...uting/dynamic-message-routing/cluster)# shutdown
broker-X1(...uting/dynamic-message-routing/cluster)# exit
broker-X1(...uting/dynamic-message-routing/cluster)# no link broker-B
</pre><pre class="Code" xml:space="preserve">broker-X2(configure)# routing
broker-X2(configure/routing)# dynamic-message-routing
broker-X2(...igure/routing/dynamic-message-routing)# cluster cluster-C
broker-X2(...uting/dynamic-message-routing/cluster)# link broker-B
broker-X2(...uting/dynamic-message-routing/cluster)# shutdown
broker-X2(...uting/dynamic-message-routing/cluster)# exit
broker-X2(...uting/dynamic-message-routing/cluster)# no link broker-B
</pre><pre class="Code" xml:space="preserve">...</pre><p>The resulting cluster looks like the following:</p><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-2.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1206" data-mc-height="498" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-2_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="2">Disable and remove cluster C on B:
<pre xml:space="preserve" class="Code">broker-B(configure)# routing
broker-B(configure/routing)# dynamic-message-routing
broker-B(...igure/routing/dynamic-message-routing)# cluster cluster-C
broker-B(...igure/routing/dynamic-message-routing)# shutdown
broker-B(...igure/routing/dynamic-message-routing)# exit
broker-B(...igure/routing/dynamic-message-routing)# no cluster cluster-C
</pre></li>
                                <li value="3">Disable and remove the cluster link on A to B (as in step 1).<p>Node B is no longer part of the cluster, but remains the replication mate of A, as shown in the following diagram:</p><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-3.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1200" data-mc-height="495" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-3_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="4">If a topology issue <code>One-way link between B and A</code> is present on A, wait for it to clear. This may take several minutes. <p class="Note">Proceeding to the next step before this topology issue clears may result in loss of persistent messages. Note that the presence of topology issue <code>External link missing between B and X</code> is normal at this step.</p></li>
                                <li value="5">Disable and remove replication as normal between A and B. <ol style="list-style-type: lower-alpha;"><li value="1">Disable replication for all Message VPNs of both A and B:
<pre xml:space="preserve" class="Code">broker-A(configure)# message-vpn vpn-one
broker-A(configure/message-vpn)# replication shutdown
broker-A(configure/message-vpn)# exit
broker-A(configure)# message-vpn vpn-two
broker-A(configure/message-vpn)# replication shutdown
broker-A(configure/message-vpn)# exit
...</pre><pre xml:space="preserve" class="Code">broker-B(configure)# message-vpn vpn-one
broker-B(configure/message-vpn)# replication shutdown
broker-B(configure/message-vpn)# exit
broker-B(configure)# message-vpn vpn-two
broker-B(configure/message-vpn)# replication shutdown
broker-B(configure/message-vpn)# exit
...</pre></li><li value="2">Remove global replication attributes on both A and B: 
<pre xml:space="preserve" class="Code">broker-A(configure)# replication
broker-A(configure/replication)# no interface
broker-A(configure/replication)# no mate broker-B
broker-A(configure/replication)# no mate connect-via &lt;addr-port&gt;</pre><pre xml:space="preserve" class="Code">broker-B(configure)# replication
broker-B(configure/replication)# no interface
broker-B(configure/replication)# no mate broker-A
broker-B(configure/replication)# no mate connect-via &lt;addr-port&gt;
</pre><p>In the preceding code, <code>&lt;addr-port&gt;</code> is the IP address or hostname of the event broker in the form <code>IP-address:port</code> or <code>hostname:port</code>, where the IP address is specified in the dotted decimal notation form <code>nnn.nnn.nnn.nnn</code> and port is the port number on the replication mate virtual router (specified as a decimal value from 0 to 65535).</p></li></ol></li>
                                <li value="6">Verify that the cluster is UP on all brokers. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Info" class="MCXref xref">Displaying Cluster Information</a>.</li>
                              </ol>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">At this point B is fully removed from the DMR network and is no longer the replication mate of A, as shown below:</p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <div class="thumbnail-container">
                                  <a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-4.png" data-mc-popup-alt="">
                                    <img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1203" data-mc-height="511" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-remove-dr-mate-4_thumb_500_0.png" alt="" tabindex=""/>
                                  </a>
                                </div>
                              </p>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule" style="page-break-before: always;"><a name="replication-pairing-dmr-nodes"/>Pairing Two Nodes for Replication in a DMR Cluster</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">It is service interrupting to make two nodes already part of a DMR network into a replication group&#x2014;any clients that were hosted by one broker must be rehosted on the other. During the procedure it is expected that the state of the cluster will be reported as DOWN and topology errors will be raised for a period of time as links are being adjusted between nodes. Regardless of these errors, traffic will continue to flow through the network. </p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Caution">On one of the brokers to be paired (in this case, B), messages that are either destined for or currently enqueued on that broker will be lost.</p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Assumptions</h3>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li>brokers A and B are both in cluster C, joined by an internal link</li>
                                <li>brokers A and B have existing DMR links (internal or external) to brokers X<sub>1</sub> through X<sub>n</sub></li>
                                <li>the state of the clusters on all of A, B, and X<sub>1..n</sub> is UP</li>
                                <li>broker B is to become the replication mate of A</li>
                                <li>all brokers using HA or replication have Config-Sync enabled and UP (however, if B is a non-redundant broker Config-Sync is operationally DOWN on B until step 7, below)</li>
                                <li>clients of the replication group A/B have been configured to include the addresses of both A and B in their host lists</li>
                              </ul>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <div class="thumbnail-container">
                                  <a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-1.png" data-mc-popup-alt="">
                                    <img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1196" data-mc-height="496" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-1_thumb_500_0.png" alt="" tabindex=""/>
                                  </a>
                                </div>
                              </p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">High Availability Considerations</h3>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li>For software event brokers, you may have to provide a second connect-via address when you configure replication and links in the steps that follow. For example, when you configure the cluster link on A to B/B', you may have to provide the addresses for both B and B'.</li>
                                <li>Enabling/disabling of the msg-backbone must be done on both B and B'.</li>
                              </ul>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Steps</h3>
                              <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li value="1">Shut down the msg-backbone service on B. Any clients connected to B will move to A.
<pre class="Code">
broker-B(configure)# service msg-backbone shutdown</pre></li>
                                <li value="2">Shut down and remove all cluster links on B to brokers X<sub>1</sub> through X<sub>n</sub><pre class="Code" xml:space="preserve">broker-B(configure)# routing
broker-B(configure/routing)# dynamic-message-routing
broker-B(...igure/routing/dynamic-message-routing)# cluster cluster-C
broker-B(...uting/dynamic-message-routing/cluster)# link broker-X1
broker-B(...uting/dynamic-message-routing/cluster)# shutdown
broker-B(...uting/dynamic-message-routing/cluster)# exit
broker-B(...uting/dynamic-message-routing/cluster)# no link broker-X1
broker-B(...uting/dynamic-message-routing/cluster)# link broker-X2
broker-B(...uting/dynamic-message-routing/cluster)# shutdown
broker-B(...uting/dynamic-message-routing/cluster)# exit
broker-B(...uting/dynamic-message-routing/cluster)# no link broker-X2
...
broker-B(...uting/dynamic-message-routing/cluster)# link broker-Xn
broker-B(...uting/dynamic-message-routing/cluster)# shutdown
broker-B(...uting/dynamic-message-routing/cluster)# exit
broker-B(...uting/dynamic-message-routing/cluster)# no link broker-Xn</pre></li>
                                <li value="3">On each broker X<sub>1</sub> through X<sub>n</sub>, disable and remove the cluster link to B.
<pre class="Code" xml:space="preserve">broker-X1(configure)# routing
broker-X1(configure/routing)# dynamic-message-routing
broker-X1(...igure/routing/dynamic-message-routing)# cluster &lt;cluster-name&gt;
broker-X1(...uting/dynamic-message-routing/cluster)# link broker-B
broker-X1(...uting/dynamic-message-routing/cluster)# shutdown
broker-X1(...uting/dynamic-message-routing/cluster)# exit
broker-X1(...uting/dynamic-message-routing/cluster)# no link broker-B</pre><pre class="Code" xml:space="preserve">broker-X2(configure)# routing
broker-X2(configure/routing)# dynamic-message-routing
broker-X2(...igure/routing/dynamic-message-routing)# cluster &lt;cluster-name&gt;
broker-X2(...uting/dynamic-message-routing/cluster)# link broker-B
broker-X2(...uting/dynamic-message-routing/cluster)# shutdown
broker-X2(...uting/dynamic-message-routing/cluster)# exit
broker-X2(...uting/dynamic-message-routing/cluster)# no link broker-B</pre><pre class="Code" xml:space="preserve">...</pre><p>Node B is now connected only to Node A, as shown below:</p><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-2.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1197" data-mc-height="484" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-2_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="4">Configure replication as normal between A and B, such that A is active and B standby: <ol style="list-style-type: lower-alpha;"><li value="1">Set global replication attributes on both A and B, such that A is the replication mate of B and vice-versa. See <a href="Replication-Sys-Level-Settings.htm#Config-Replication-Mates" class="MCXref xref">Configuring Replication Mates</a>.</li><li value="2">Create all Message VPNs on B that will be replicated from A. See <a href="../VPN/Configuring-VPNs.htm" class="MCXref xref">Configuring Message VPNs</a>.</li><li value="3">Enable replication for Message VPNs of A (active) and B (standby). See <a href="Replication-VPN-Level-Settings.htm#Enable-Replication" class="MCXref xref">Enabling Replication</a>.</li></ol><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-3.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1204" data-mc-height="495" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-3_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="5">Remove the connect-via settings of the cluster link on A to B and on B to A.
<pre class="Code" xml:space="preserve">broker-A(configure)# routing
broker-A(configure/routing)# dynamic-message-routing
broker-A(...igure/routing/dynamic-message-routing)# cluster cluster-C
broker-A(...uting/dynamic-message-routing/cluster)# link broker-B
broker-A(.../dynamic-message-routing/cluster/link)# shutdown
broker-A(.../dynamic-message-routing/cluster/link)# no connect-via &lt;addr-port&gt;
&#x2026;
broker-A(...uting/dynamic-message-routing/cluster)# link broker-B
broker-A(.../dynamic-message-routing/cluster/link)# no shutdown</pre><pre class="Code" xml:space="preserve">broker-B(configure)# routing
broker-B(configure/routing)# dynamic-message-routing
broker-B(...igure/routing/dynamic-message-routing)# cluster cluster-C
broker-B(...uting/dynamic-message-routing/cluster)# link broker-A
broker-B(.../dynamic-message-routing/cluster/link)# shutdown
broker-B(.../dynamic-message-routing/cluster/link)# no connect-via &lt;addr-port&gt;
&#x2026;
broker-B(...uting/dynamic-message-routing/cluster)# link broker-A
broker-B(.../dynamic-message-routing/cluster/link)# no shutdown

</pre><p>In the preceding code, <code>&lt;addr-port&gt;</code> is the IP address or hostname of the event broker in the form <code>IP-address:port</code> or <code>hostname:port</code>, where the IP address is specified in the dotted decimal notation form <code>nnn.nnn.nnn.nnn</code> and port is the port number on the replication mate virtual router (specified as a decimal value from 0 to 65535).</p><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-4.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1200" data-mc-height="491" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-4_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="6">For each broker X<sub>1</sub> through X<sub>n</sub> do the following:<ol style="list-style-type: lower-alpha;"><li value="1">Wait for the cluster on X to report a missing link between X and B.</li><li value="2">Create a new link on B to X (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes: <ul><li>span to either <code>internal</code> or <code>external</code> as appropriate</li><li>authentication settings</li><li>connect-via</li><li>enabled</li></ul>If the span is external, create the corresponding DMR bridges on B (see <a href="../DMR/DMR-Mgmt-Msg-Vpn.htm#Create-DMR-Bridge" class="MCXref xref">Configuring a DMR&#xA0;Bridge</a>).</li></ol><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-5.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1199" data-mc-height="500" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-5_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="7">Enable the msg-backbone service on B.<pre class="Code" xml:space="preserve">
broker-B(configure)# no service msg-backbone shutdown</pre></li>
                                <li value="8">Wait for Config-Sync on A and B to report all replicated Message VPNs as being in-sync.</li>
                                <li value="9">Verify that the link between A and B is UP. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Link" class="MCXref xref">Displaying Cluster Link Information</a>.</li>
                                <li value="10">For each broker X<sub>1</sub> through X<sub>n</sub> do the following:<p>Create a new link on X to B  (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes: </p><ul><li>span to either <code>internal</code> or <code>external</code> as appropriate</li><li>authentication settings</li><li>connect-via</li><li>enabled</li></ul><p>If the span is external, create the corresponding DMR bridges on X (see <a href="../DMR/DMR-Mgmt-Msg-Vpn.htm#Create-DMR-Bridge" class="MCXref xref">Configuring a DMR&#xA0;Bridge</a>).</p><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-5.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1199" data-mc-height="500" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-pair-two-nodes-5_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="11">Verify that the links between X<sub>1</sub> through X<sub>n</sub> and B are UP. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Link" class="MCXref xref">Displaying Cluster Link Information</a>.</li>
                                <li value="12">Verify that the cluster is UP on all brokers. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Info" class="MCXref xref">Displaying Cluster Information</a>.</li>
                              </ol>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The new replication mate B is now fully integrated into the DMR network. </p>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Optional:&#xA0;You can now move selected replicated Message VPNs on A such that they are active on B.</p>
                              <h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule" style="page-break-before: always;"><a name="Adding-replication-pair"/>Adding a Replication Group to a DMR Cluster</h2>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can add an existing replication group as new nodes to a DMR network without causing a service interruption to existing clients. During the procedure it is expected that the state of the cluster will report as being DOWN and topology errors will be raised for a period of time as links are being added between nodes. Regardless of this, existing traffic flow through the network will continue, and no message loss is expected.</p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Assumptions</h3>
                              <ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li>brokers A and B are a replication group without a cluster configured</li>
                                <li>all replicated Message VPNs on A and B are <code>active</code> on A and <code>standby</code> on B</li>
                                <li>brokers X<sub>1</sub> through X<sub>n</sub> belong to cluster C</li>
                                <li>the state of the cluster on all of X<sub>1..n</sub> is UP</li>
                                <li>all brokers using HA or replication have Config-Sync enabled and UP</li>
                              </ul>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <div class="thumbnail-container">
                                  <a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-1.png" data-mc-popup-alt="">
                                    <img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1204" data-mc-height="484" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-1_thumb_500_0.png" alt="" tabindex=""/>
                                  </a>
                                </div>
                              </p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">High Availability Considerations</h3>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">For software event brokers, you may have to provide a second connect-via address when you configure replication and links in the steps that follow. For example, when you configure the cluster link on A to B/B', you may have to provide the addresses for both B and B'.</p>
                              <h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Steps</h3>
                              <ol xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
                                <li value="1">Create cluster C on brokers A and B, and configure its authentication and other attributes as needed. See <a href="../DMR/DMR-Mgmt-Cluster-Config.htm" class="MCXref xref">Configuring a DMR Cluster</a>.
				<p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-2.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1211" data-mc-height="498" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-2_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="2">On A, enable DMR for every Message VPN on X<sub>1</sub> through X<sub>n</sub> for which DMR is enabled.<pre xml:space="preserve" class="Code">broker-A(configure)# message-vpn vpn-one
broker-A(configure/message-vpn)# dynamic-message-routing
broker-A(...e/message-vpn/dynamic-message-routing)# no shutdown
broker-A(configure/message-vpn)# exit
broker-A(configure)# message-vpn vpn-two
broker-A(configure/message-vpn)# dynamic-message-routing
broker-A(...e/message-vpn/dynamic-message-routing)# no shutdown
broker-A(configure/message-vpn)# exit
...</pre></li>
                                <li value="3">Create new cluster links from A to B and from B to A (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes:<ul><li>span to be <code>internal</code></li><li>authentication settings</li><li>connect-via must NOT be set<br/></li><li>enabled</li></ul><p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-3.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1204" data-mc-height="504" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-3_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="4">Verify that the link between A and B is UP (see <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Link" class="MCXref xref">Displaying Cluster Link Information</a>), and that cluster C is UP on both A and B (see <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Info" class="MCXref xref">Displaying Cluster Information</a>.).</li>
                                <li value="5">Create a new cluster link on A to each broker X<sub>1</sub> through X<sub>n</sub> (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes: <ul><li>span to be <code>internal</code></li><li>authentication settings</li><li>connect-via</li><li>enabled</li></ul></li>
                                <li value="6">On each broker X<sub>1</sub> through X<sub>n</sub>, create a new link to A (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes: :<ul><li>span to be <code>internal</code></li><li>authentication settings</li><li>connect-via</li><li>enabled</li></ul></li>
                                <li value="7">Verify that the links between X<sub>1</sub> through X<sub>n</sub> and A are UP (see <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Link" class="MCXref xref">Displaying Cluster Link Information</a>).<p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-4.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1204" data-mc-height="505" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-4_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                                <li value="8">Configure a new link on B to each broker X<sub>1</sub> through X<sub>n</sub> (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes: <ul><li>span to be <code>internal</code></li><li>authentication settings</li><li>connect-via</li><li>enabled</li></ul></li>
                                <li value="9">For each broker X<sub>1</sub> through X<sub>n</sub> do the following:<ol><li value="1">Wait for the cluster on X to report a topology issue which can be either:<ul><li>a missing link between X and B</li><li>a one-way link between X and B</li></ul></li><li value="2">Create a new link on X to B (see <a href="../DMR/DMR-Mgmt-Cluster-Link-Config.htm" class="MCXref xref">Configuring Cluster Links</a>). At a minimum, configure these link attributes: <ul><li>span to be <code>internal</code></li><li>authentication settings</li><li>connect-via</li><li>enabled</li></ul></li></ol></li>
                                <li value="10">Verify that the cluster is UP on all brokers. See <a href="../DMR/DMR-Mgmt-Monitor.htm#Show-Cluster-Info" class="MCXref xref">Displaying Cluster Information</a>.<p><div class="thumbnail-container"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-5.png" data-mc-popup-alt=""><img class="MCPopupThumbnail img imgsolacethumbnail" data-mc-width="1203" data-mc-height="493" src="../../Resources/Images/DMR/DMR-DR/dmr-dr-add-dr-group-5_thumb_500_0.png" alt="" tabindex=""/></a></div></p></li>
                              </ol>
                              <p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">At this point, the new replication group A/B is fully integrated into the DMR network. If required, you can move the selected replicated Message VPNs on A so that they are active on B.</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="no-print">
                      <div>
                        <a href="#" id="docsFeedbackTrigger" class="docs-issue-collector">Provide feedback</a>
                      </div>
                    </div>
                    <footer class="my-4 pt-4 text-center no-print">
                      <div class="footer-txt text-center no-print">
                        <ul class="list-inline ">
                          <li class="list-inline-item text-muted"><a href="../../Resources/Documentation-Set.htm" class="doc-set-footer-link MCXref xref xrefdoc-set-footer-link">Documentation Coverage</a>: <span class="mc-variable Variables.DocumentSetNumber variable">2024.09.16.0001</span></li>
                          <li class="list-inline-item text-muted">Last Updated: <span class="mc-variable Variables.MonthDayYear variable">September 16, 2024</span></li>
                          <li class="list-inline-item text-muted" style="font-size:13px;"> &#xA9;  <span class="mc-variable Variables.CompanyNameLegal variable">Solace Corporation</span></li>
                        </ul>
                      </div>
                      <div class="footer-icons">
                        <ul class="list-inline">
                          <li class="list-inline-item">
                            <a href="https://facebook.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/facebook_22x21.png" class="Hyperlinked" alt="Facebook" title="Solace Facebook Page" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/20219" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/LinkedIn_22x21.png" class="Hyperlinked" alt="LinkedIn" title="Solace LinkedIn Page" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://twitter.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/Twitter_22x21.png" class="Hyperlinked" alt="Twitter" title="Solace Twitter Feed" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.youtube.com/user/SolaceSystems" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/youtube_22x21.png" class="Hyperlinked" alt="YouTube" title="Solace YouTube Channel" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.instagram.com/solacedotcom/" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/instagram_22x21.png" class="Hyperlinked" alt="Instagram" title="Solace Instagram Feed" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://medium.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/medium_22x21.png" class="Hyperlinked" alt="Medium" title="Solace Medium Blog" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                        </ul>
                      </div>
                      <div class="footer_link_menu">
                        <ul class="link_list">
                          <li class="link_list_item">
                            <a href="https://solace.com/products/" target="_blank" class="footer-link">Products</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/company/" target="_blank" class="footer-link">Company</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://www.solace.dev/" target="_blank" class="footer-link">Developers</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/support/" target="_blank" class="footer-link">Support</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/contact/" target="_blank" class="footer-link">Contact Us</a>
                          </li>
                        </ul>
                      </div>
                    </footer>
                  </div>
                  <!-- JIRA issue collector -->
                  <script>/*<![CDATA[*/// Requires jQuery!
jQuery.ajax({
    url: "https://sol-jira.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e-T/o2joag/b/24/e73395c53c3b10fde2303f4bf74ffbf6/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-US&collectorId=076e0808",
    type: "get",
    cache: true,
    dataType: "script"
});
window.ATL_JQ_PAGE_PROPS = {
"triggerFunction": function(showCollectorDialog) {
//Requires that jQuery is available!
$("#docsFeedbackTrigger").click(function(e) {
e.preventDefault();
showCollectorDialog();
});
},
fieldValues: {
recordWebInfo: '1', // field Name
recordWebInfoConsent: ['1'] // field Id
}
};
/*]]>*/</script>
                  <script src="../../Resources/Scripts/thumbnail.js">
                                    </script>
                  <!-- Script for Launching offsite links in new tab -->
                  <script type="text/javascript">/*<![CDATA[*/$("a[href^='http']").attr("target","_blank");/*]]>*/</script>
                </div>
              </div>
            </div>
          </div>
          <a data-close="true"/>
        </div>
      </div>
    </div>
  </body>
</html>

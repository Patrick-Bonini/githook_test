<?xml version="1.0"?>
<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Side_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="msapplication-config" content="../../Skins/Favicons/browserconfig.xml"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png"/>
    <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png"/>
    <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png"/>
    <meta charset="utf-8"/>
    <meta http-equiv="Cache-control" content="no-cache"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Configuring a DMR Cluster</title>
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" /> -->
    <!--style to display feedback button correctly in IE-->
    <!-- Google Tag Manager -->
    <!-- End Google Tag Manager -->
    <!-- links to get the EDA styling to work -->
    <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Skins/Fluid/Stylesheets/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True"/>
    <link href="../../Resources/Stylesheets/MainStyles.min.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
    <style>@media screen and (min-width: 0\0)
{
	.feedback-button
	{
		margin-right: -40px;
		top: 50%;
		border-radius: 9px 9px 0px 0px;
	}

	#canvas
	{
		position: relative;
	}
}

@media print
{
	#plugin
	{
		overflow: visible !important;
	}
}

</style>
    <link href="../../Resources/Stylesheets/eda_styles.css" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
    <style>/*&lt;meta /&gt;*/

.button.print-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, transparent);
}

.needs-pie
{
	behavior: url('../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
    <link rel="apple-touch-icon" sizes="180x180" href="../../Skins/Favicons/apple-touch-icon.png"/>
    <link rel="shortcut icon" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="96x96" href="../../Skins/Favicons/favicon-96x96.png"/>
    <link rel="icon" sizes="32x32" href="../../Skins/Favicons/favicon-32x32.png"/>
    <link rel="icon" sizes="16x16" href="../../Skins/Favicons/favicon-16x16.png"/>
    <script src="../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
    <script src="../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/require.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
    <script src="../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
    <script src="https://cmp.osano.com/AzZrhlTmT5f216Foa/84ba7dc4-a4e5-4b02-b120-977eb6f052d4/osano.js">
        </script>
    <script type="text/javascript">/*<![CDATA[*/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KLSDFH');
		/*]]>*/</script>
    <script type="text/javascript" src="../../Skins/Default/Scripts/TopicToolBar.js">
        </script>
  </head>
  <!-- Top Orange and Darkgrey header-->
  <!-- Div for EDA banner -->
  <div class="eda_banner">
    <p>Register Now for EDA Summit 2024 - Virtual Event <a href="https://edasummit.com/" target="_blank">Register for Free</a></p>
  </div>
  <!-- end Div for EDA banner -->
  <div class="top-nav">
    <div class="main_list">
      <ul class="top-navlinks">
        <li>
          <a href="https://solace.com/support/" target="_blank">Support</a>
        </li>
        <li>
          <a href="https://solace.com/contact/" target="_blank">Contact Us</a>
        </li>
      </ul>
    </div>
    <div class="container-fluid">
      <div class="src-li">
        <div id="srchWrapTwo">
          <form class="search" action="#">
            <div class="search-bar search-bar-container needs-pie">
              <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs"/>
              <div class="search-filter-wrapper">
                <span class="invisible-label" id="search-filters-label">Filter: </span>
                <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                </div>
                <div class="search-filter-content" id="sf-content">
                  <ul>
                    <li>
                      <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001">
                        <span id="filterSelectorLabel-00001">All Files</span>
                      </button>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="search-submit-wrapper" dir="ltr">
                <div class="search-submit" title="Search" role="button" tabindex="0">
                  <span class="invisible-label">Submit Search</span>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
      <span class="tool-tip" tooltip-position="left" tooltip="To search for CLI commands, events, or APIs, navigate to the related sections.">i</span>
      <!-- Sept. 28, 2022 - This is being moved to under div class= top-nav
			<div class="main_list">
				<ul class="top-navlinks">
					<li><a href="https://solace.com/support/" target="_blank">Support</a></li>
					<li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li>
				</ul>
			</div> -->
    </div>
    <!-- Sept. 27, 2022 - The commented out content below used to provide the products, company, etc., links in the top header, next to the search field. -->
    <!-- <div class="main_list"><ul class="top-navlinks"><li><a href="https://solace.com/products/" target="_blank">Products</a></li><li><a href="https://solace.com/company/" target="_blank">Company</a></li><li><a href="https://www.solace.dev/" target="_blank">Developers</a></li><li><a href="https://solace.com/support/" target="_blank">Support</a></li><li><a href="https://solace.com/contact/" target="_blank">Contact Us</a></li></ul></div> -->
  </div>
  <body>
    <div class="foundation-wrap off-canvas-wrapper">
      <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
        <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
          <ul class="off-canvas-accordion vertical menu off-canvas-list" data-accordion-menu="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True">
                    </ul>
        </aside>
        <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
          <div data-sticky-container="" class="title-bar-container">
            <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1000px)" data-mc-ignore="true">
              <a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
              <div class="middle title-bar-section outer-row clearfix">
                <div class="menu-icon-container relative clearfix">
                  <div class="central-account-wrapper">
                    <div class="central-dropdown">
                      <a class="central-account-drop">
                        <span class="central-account-image"/>
                        <span class="central-account-text">Account</span>
                      </a>
                      <div class="central-dropdown-content">
                        <a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                        <hr class="central-separator"/>
                        <a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                      </div>
                    </div>
                  </div>
                  <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas">
                    <span/>
                  </button>
                </div>
              </div>
              <div class="title-bar-layout outer-row">
                <div class="logo-wrapper">
                  <a class="logo" href="../../index.html" alt="Logo"/>
                </div>
                <div class="navigation-wrapper nocontent">
                  <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                    <li class="placeholder" style="visibility:hidden">
                      <a>placeholder</a>
                    </li>
                  </ul>
                </div>
                <div class="central-account-wrapper">
                  <div class="central-dropdown">
                    <a class="central-account-drop">
                      <span class="central-account-image"/>
                      <span class="central-account-text">Account</span>
                    </a>
                    <div class="central-dropdown-content">
                      <a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                      <hr class="central-separator"/>
                      <a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                    </div>
                  </div>
                </div>
                <div class="nav-search-wrapper">
                  <div class="nav-search row">
                    <form class="search" action="#">
                      <div class="search-bar search-bar-container needs-pie">
                        <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search the docs"/>
                        <div class="search-filter-wrapper">
                          <span class="invisible-label" id="search-filters-label">Filter: </span>
                          <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                          <div class="search-filter-content" id="sf-content">
                            <ul>
                              <li>
                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001">
                                  <span id="filterSelectorLabel-00001">All Files</span>
                                </button>
                              </li>
                            </ul>
                          </div>
                        </div>
                        <div class="search-submit-wrapper" dir="ltr">
                          <div class="search-submit" title="Search" role="button" tabindex="0">
                            <span class="invisible-label">Submit Search</span>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </nav>
          </div>
          <div class="main-section">
            <div class="row outer-row sidenav-layout">
              <nav class="sidenav-wrapper">
                <div class="sidenav-container">
                  <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                </div>
              </nav>
              <div class="body-container">
                <div data-mc-content-body="True">
                  <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic Print NextTopic;">
                    <div class="button-group-container-left">
                      <button class="button needs-pie print-button" title="Print">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Print">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                      <button class="button needs-pie previous-topic-button" title="Navigate previous topic" disabled="true">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                      <button class="button needs-pie next-topic-button" title="Navigate next topic" disabled="true">
                        <div>
                          <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                            <div class="button-icon"> </div>
                          </div>
                        </div>
                      </button>
                    </div>
                  </div>
                  <!-- Google Tag Manager (noscript) -->
                  <noscript>
                    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLSDFH" height="0" width="0" style="display:none;visibility:hidden"/>
                  </noscript>
                  <!-- End Google Tag Manager (noscript) -->
                  <div id="content">
                    <div id="contentBody">
                      <div class="row collapse">
                        <div xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="ContentRow">
                          <div>
                            <div xmlns="" class="nocontent">
                              <div class="MCBreadcrumbsBox_MCBreadcrumbsSelf_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider=" / " data-mc-breadcrumbs-count="4" data-mc-toc="True">
                                <span class="MCBreadcrumbsPrefix"> </span>
                              </div>
                            </div>
                            <div xmlns="" role="main" id="mc-main-content"><h1 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Configuring a DMR Cluster</h1><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">A&#xA0;cluster is a provisioned object on an event broker that contains global DMR&#xA0;configuration parameters.  There can be only one cluster for each node. Parameters configured at the cluster level apply to all links in the cluster, unless you override each setting by providing equivalent cluster link-level configuration.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To create a cluster, enter the following commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(configure)# routing
solace(configure/routing)# dynamic-message-routing
solace(...igure/routing/dynamic-message-routing)# create cluster &lt;cluster-name&gt;</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure an existing cluster, enter the following command:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">
solace(...igure/routing/dynamic-message-routing)# cluster &lt;cluster-name&gt;</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">To enable the cluster, enter the following command:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...uting/dynamic-message-routing/cluster)# no shutdown</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><u>Where</u>:</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>&lt;cluster-name&gt;</code> is the name of the cluster you want this node to belong to. </p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"> The configuration tasks that you can perform for an existing cluster include:</p><ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><li><a href="#Cluster-Auth" class="MCXref xref">Configuring Authentication on a Cluster</a></li><li><a href="#Enabling-TLS" class="MCXref xref">Enabling TLS/SSL Encryption</a></li></ul><h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="Cluster-Auth"/>Configuring Authentication on a Cluster</h2><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When you configure cluster-level authentication, each setting applies for all links in the cluster. If you want to provide per-link authentication, refer to <a href="DMR-Mgmt-Cluster-Link-Config.htm#Link-Auth-Config" class="MCXref xref">Configuring Authentication on the Link</a>.</p><h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Basic-Auth"/>Configuring Basic Authentication</h3><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Basic authentication is the default client authentication scheme used by <MadCap:conditionalText data-mc-conditions="SAP.SapHideFromOutput"><span class="mc-variable Product-Names.pubsub_brand_only variable">PubSub+</span></MadCap:conditionalText> event brokers. This authentication scheme allows cluster links to connect to a remote node  and authenticate with that node using a  password.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Note">Basic authentication is compatible with both plain-text and encrypted connections. For more information about configuring encrypted connections, see <a href="#Enabling-TLS" class="MCXref xref">Enabling TLS/SSL Encryption</a>.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure basic authentication for all links in the cluster, enter the following commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">
solace(...igure/routing/dynamic-message-routing)# cluster &lt;cluster-name&gt;
solace(...uting/dynamic-message-routing/cluster)# authentication
solace(...essage-routing/cluster/authentication)# basic
</pre><h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Auth-Type"/>Configuring the Authentication Type</h4><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure the type of basic authentication to use for cluster link connections, enter the following command:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...-routing/cluster/authentication/basic)# auth-type {internal | none}</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><u>Where</u>:</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>internal</code> specifies to authenticate cluster link connections against a locally-configured  password.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>none</code> specifies that no authentication is required (in other words, an anonymous login is allowed).</p><h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Cluster-Password"/>Configuring a Password for Basic Internal Authentication</h4><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure a password for basic internal authentication of cluster link connections, enter the following command:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...-routing/cluster/authentication/basic)# password &lt;password&gt;</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" style="text-decoration: underline;">Where:</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>&lt;password&gt;</code> is the password you want to use to authenticate incoming cluster links (both control and data channels). This password is also used for all outgoing links if each link does not have a per-link password.</p><h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Client-Cert-Auth"/>Configuring Authentication Using Client Certificates</h3><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Client-certificate authentication requires  a cluster link to prove its identity to a remote node through an X509v3 client certificate from a recognized Certification Authority (CA).</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To use client-certificate authentication, you must configure the client certificate that cluster links present to the remote node when initiating the connection. Each node can be configured with a per-cluster client certificate, which is used as the offered credentials for outgoing links. Only one client certificate can be configured per cluster; it can't be overridden on a per-link basis. In addition, you must configure at least one client certificate matching rule condition when using client certificate authentication for cluster links (see <a href="#Configur" class="MCXref xref">Configuring Client Certificate Matching Rules</a>).</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Note">Client-certificate authentication is compatible with encrypted connections only. For more information about configuring encrypted connections, see <a href="#Enabling-TLS" class="MCXref xref">Enabling TLS/SSL Encryption</a>.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure client-certificate authentication for all links in the cluster, enter the following commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...igure/routing/dynamic-message-routing)# cluster &lt;cluster-name&gt;
solace(...uting/dynamic-message-routing/cluster)# authentication
solace(...essage-routing/cluster/authentication)# client-certificate 
</pre><h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Client-Cert-File"/>Configuring the Client Certificate File to Present to Remote Nodes</h4><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure the certificate file to use, enter the following command:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...ter/authentication/client-certificate)# certificate-file &lt;file&gt;</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><u>Where</u>:</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>&lt;file&gt;</code> specifies the certificate file used to authenticate all cluster links (both control and data channels). This certificate is presented to the remote node for authentication when the link is established. The certificate file must be in the <code>certs</code> directory in the jail directory (refer to <a href="../../Admin/Managing-Event-Broker-Files.htm#Manage_Router_Files_Copy" class="MCXref xref">Copying Files</a>). Once installed, you may remove the file in the <code>certs</code> directory.</p><h4 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Configur"/>Configuring Client Certificate Matching Rules</h4><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">When you configure client certificate matching, you create a set of matching rules per cluster. For a client certificate to be accepted as a valid credential, the certificate must match at least one rule. Each rule contains  a set of one or more conditions, all of which must be satisfied for a certificate to match the rule. Each condition compares a certificate field with an  attribute associated with the cluster link  or a fixed glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can also create attribute filters to  ensure that the matching rule applies only  to cluster links with certain attribute values. For example, you could mark certain cluster links with a <code>span</code> attribute  and then create a rule that contains both an attribute filter which checks that the value of the <code>span</code> attribute is set to <code>internal</code>, and a simple condition that allows those links to authenticate with remote nodes.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Note">You must configure at least one client certificate matching rule condition when using client certificate authentication for cluster links.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure a client certificate matching rule, enter the following commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">solace(...ter/authentication/client-certificate)# matching rules
solace(...ion/client-certificate/matching-rules)# create rule &lt;name&gt;</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure a client certificate matching rule condition, enter the following comands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">
solace(...lient-certificate/matching-rules/rule)# create condition {certificate-thumbprint | common-name | common-name-last | subject-alternate-name-msupn | uid | uid-last | org-unit | org-unit-last | issuer | subject | serial-number | dns-name | ip-address} {{matches-attribute &lt;attribute&gt;} | {matches-expression &lt;expression&gt;}}</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure a client certificate matching rule attribute filter, enter the following commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">
solace(...lient-certificate/matching-rules/rule)# create attribute-filter &lt;name&gt;
solace(.../matching-rules/rule/attribute-filter)# name &lt;value&gt;
solace(.../matching-rules/rule/attribute-filter)# value &lt;value&gt; </pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To enable a certificate matching rule, enter the following CONFIG commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">solace(...lient-certificate/matching-rules/rule)# no shutdown</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">By default, client certificate matching is disabled and any otherwise valid certificate is accepted. To enable client certificate matching, enter the following CONFIG&#xA0;commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">solace(...ion/client-certificate/matching-rules)# no shutdown</pre><u xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Where</u>:<p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>rule &lt;name&gt;</code> specifies the name of the certificate matching rule. </p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>certificate-thumbprint</code> compares the  certificate thumbprint with the specified  attribute or glob expression. The certificate thumbprint is a SHA-1 hash of the entire DER-encoded certificate calculated by the broker after it receives the client certificate.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>common-name</code> compares  the first instance of the CN  in the client certificate with the specified  attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>common-name-last</code> compares  the last instance of the CN&#xA0;in the client certificate with the specified  attribute or glob expression. </p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>subject-alternative-name-msupn</code> compares the   msUPN   (in the otherName field) in the SAN extension of the client certificate with the specified  attribute or glob experssion.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>uid</code> compares the  first instance of the user identifier (UID) attribute in the client certificate with the specified  attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>uid-last</code> compares the last instance of the UID attribute in the client certificate with the specified  attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>org-unit</code> compares the  first instance of the Org Unit attribute in the client certificate with the specified  attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>org-unit-last</code> compares the  last instance of the Org Unit attribute in the  client certificate with the specified attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>issuer</code> compares the Issuer attribute in the client certificate with the specified  attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>subject</code> compares the Subject attribute in the client certificate with the specified  attribute or glob expression. </p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>serial-number</code> compares the client certificate serial number with the specified  attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>dns-name</code> compares the DNS name in the SAN extension of the client certificate with the specified attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>ip-address</code> compares IP address in the SAN extension of the client certificate with the specified attribute or glob expression.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>matches-attribute &lt;attribute&gt;</code> specifies the  attribute used in the comparison.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>matches-expression &lt;expression&gt;</code> specifies the glob expression used in the comparison. The expression is compared directly to the field extracted from the certificate and may contain wildcards.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>attribute-filter &lt;name&gt;</code> specifies the name of the attribute filter.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>attribute &lt;value&gt;</code> specifies the name of the attribute to be tested.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>value &lt;value&gt;</code> specifies the expected value of the attribute in order to apply the certificate matching rule. </p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Note">Certificate matching rules have no effect unless the links or cluster is restarted.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><u>Examples</u></p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><b>Internal Links</b></p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">Internal links are likely to have a uniform set of rules, or most likely a single rule that extracts the node name from a client certificate and compares it to a link attribute carrying the node name. A typical rule for internal links might look like this:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">
solace(...ion/client-certificate/matching-rules)# create rule internal
solace(...lient-certificate/matching-rules/rule)# create condition common-name matches-attribute nodeName
solace(...lient-certificate/matching-rules/rule)# no shutdown</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This requires that you also create the <code>nodeName</code> attribute on the cluster link, for more  information, see <a href="DMR-Mgmt-Cluster-Link-Config.htm#Setting" class="MCXref xref">Setting Cluster Link Attributes</a>. </p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><b>External Links</b></p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">External links are likely to connect to a cluster managed by a different organization with different certificate styles, so more configuration is likely to be required, for example:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">
solace(...ion/client-certificate/matching-rules)# create rule external
solace(...lient-certificate/matching-rules/rule)# create condition issuer matches-attribute issuer
solace(...lient-certificate/matching-rules/rule)# create condition subject matches-attribute subject
solace(...lient-certificate/matching-rules/rule)# no shutdown</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This requires that you also create the <code>issuer</code> and <code>subject</code> attributes on the cluster link, for more  information, see <a href="DMR-Mgmt-Cluster-Link-Config.htm#Setting" class="MCXref xref">Setting Cluster Link Attributes</a>. </p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><b>Differentiating the Rules for Internal and External Links</b></p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To apply different rules for internal and external links, you can create attribute filters that ensure the rule only applies to links with certain attribute values. This allows you to create a unique rule for each external link, that only applies when the <code>nodeName</code> attribute has a certain value.</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:space="preserve">
solace(...ion/client-certificate/matching-rules)# create rule internal
solace(...lient-certificate/matching-rules/rule)# create attribute-filter spanInternal
solace(.../matching-rules/rule/attribute-filter)# attribute span
solace(...rules/rule/attribute-filter/attribute)# value internal
solace(...rules/rule/attribute-filter/attribute)# exit
solace(.../matching-rules/rule/attribute-filter)# exit
solace(...lient-certificate/matching-rules/rule)# create condition common-name matches-attribute nodeName
solace(...lient-certificate/matching-rules/rule)# no shutdown
solace(...lient-certificate/matching-rules/rule)# exit
solace(...ion/client-certificate/matching-rules)# create rule external1
solace(...lient-certificate/matching-rules/rule)# create attribute-filter nodeName
solace(.../matching-rules/rule/attribute-filter)# attribute nodeName
solace(...rules/rule/attribute-filter/attribute)# value external-node-1
solace(...rules/rule/attribute-filter/attribute)# exit
solace(.../matching-rules/rule/attribute-filter)# exit
solace(...lient-certificate/matching-rules/rule)# create condition issuer matches-expression "CN=CA1, O=org1, ..."
solace(...lient-certificate/matching-rules/rule)# create condition subject matches-expression "CN=external-node-1, O=org1, ..."
solace(...lient-certificate/matching-rules/rule)# no shutdown</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This requires that you also create the <code>span</code> and <code>nodeName</code> attributes on the internal cluster links, and the <code>nodeName</code> attribute on external cluster links. For more  information, see <a href="DMR-Mgmt-Cluster-Link-Config.htm#Setting" class="MCXref xref">Setting Cluster Link Attributes</a>. </p><h2 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="with-rule"><a name="Enabling-TLS"/>Enabling TLS/SSL Encryption</h2><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">The following is required before you can enable TLS/SSL encryption for  links in the cluster: </p><ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><li><p>TLS/SSL service must be configured and enabled  on both nodes on each cluster link. This requires the TLS/SSL server-certificate to be configured on the node which receives the encrypted connection. See <a href="../../Security/Managing-Server-Certs.htm" class="MCXref xref">Managing Server Certificates</a>.</p></li><li><p>With client-certificate authentication configured, the client-certificate file that identifies the node  initiating the encrypted connection must be loaded onto the node. See <a href="#Client-Cert-File" class="MCXref xref">Configuring the Client Certificate File to Present to Remote Nodes</a>.</p></li></ul><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure TLS/SSL encryption, enter the following commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...uting/dynamic-message-routing/cluster)# ssl
solace(...g/dynamic-message-routing/cluster/ssl)# server-certificate-validation
</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"> The TLS/SSL configuration tasks that you can perform include:</p><ul xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><li><a href="#Server-Name-Validation" class="MCXref xref">Enabling the Validation of the Server Name</a></li><li><a href="#Max-Chain-Depth" class="MCXref xref">Configuring the Maximum Certificate Chain Depth</a></li><li><a href="#Cert-Date-Validation" class="MCXref xref">Enabling the Validation of the Certificate  Date</a></li></ul><div xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Caution"><p>When you make a change to the server certificate validation settings for a DMR cluster, the PubSub+ broker automatically disconnects and then reconnects all TLS-enabled links in the cluster to enable the change. </p></div><h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Server-Name-Validation"/>Enabling the Validation of the Server Name</h3><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can enable or disable the TLS authentication mechanism to verify the name used to connect to the remote broker. If enabled, the Server Name Indication (SNI) extension is sent on outgoing TLS connections and the server name used for that connection is verified against the server names in the Subject Alternative Name (SAN) extension in the certificate returned from the remote broker.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">This parameter is  enabled by default.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To enable the validation of server names:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...g/dynamic-message-routing/cluster/ssl)# server-certificate-validation
solace(...ter/ssl/server-certificate-validation)# validate-server-name</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To disable server name validation:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">
solace(...ter/ssl/server-certificate-validation)# no validate-server-name</pre><h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Max-Chain-Depth"/>Configuring the Maximum Certificate Chain Depth</h3><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can configure the maximum allowed depth of a server-certificate chain. The depth of a chain is defined as the number of signing CA certificates that are present in the chain back to a trusted self-signed root CA certificate.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To configure the maximum allowed depth of a certificate chain, enter the following commands:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...g/dynamic-message-routing/cluster/ssl)# server-certificate-validation
solace(...ter/ssl/server-certificate-validation)# max-certificate-chain-depth &lt;max-depth&gt;</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><u>Where</u>:</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><code>&lt;max-depth&gt;</code> specifies the maximum allowed depth of a certificate chain.</p><h3 xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd"><a name="Cert-Date-Validation"/>Enabling the Validation of the Certificate  Date</h3><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">You can enable or disable  the validation of the <code>Not Before</code> and <code>Not After</code> validity dates in the server-certificate. When disabled, the certificate is accepted even if the certificate is not valid based on these dates.</p><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To enable certificate date validation:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">solace(...g/dynamic-message-routing/cluster/ssl)# server-certificate-validation
solace(...ter/ssl/server-certificate-validation)# validate-certificate-date</pre><p xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd">To disable certificate date validation:</p><pre xmlns="http://www.madcapsoftware.com/Schemas/MadCap.xsd" class="Code" xml:space="preserve">
solace(...ter/ssl/server-certificate-validation)# no validate-certificate-date</pre></div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="no-print">
                      <div>
                        <a href="#" id="docsFeedbackTrigger" class="docs-issue-collector">Provide feedback</a>
                      </div>
                    </div>
                    <footer class="my-4 pt-4 text-center no-print">
                      <div class="footer-txt text-center no-print">
                        <ul class="list-inline ">
                          <li class="list-inline-item text-muted"><a href="../../Resources/Documentation-Set.htm" class="doc-set-footer-link MCXref xref xrefdoc-set-footer-link">Documentation Coverage</a>: <span class="mc-variable Variables.DocumentSetNumber variable">2024.09.16.0001</span></li>
                          <li class="list-inline-item text-muted">Last Updated: <span class="mc-variable Variables.MonthDayYear variable">September 16, 2024</span></li>
                          <li class="list-inline-item text-muted" style="font-size:13px;"> &#xA9;  <span class="mc-variable Variables.CompanyNameLegal variable">Solace Corporation</span></li>
                        </ul>
                      </div>
                      <div class="footer-icons">
                        <ul class="list-inline">
                          <li class="list-inline-item">
                            <a href="https://facebook.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/facebook_22x21.png" class="Hyperlinked" alt="Facebook" title="Solace Facebook Page" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.linkedin.com/company/20219" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/LinkedIn_22x21.png" class="Hyperlinked" alt="LinkedIn" title="Solace LinkedIn Page" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://twitter.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/Twitter_22x21.png" class="Hyperlinked" alt="Twitter" title="Solace Twitter Feed" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.youtube.com/user/SolaceSystems" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/youtube_22x21.png" class="Hyperlinked" alt="YouTube" title="Solace YouTube Channel" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://www.instagram.com/solacedotcom/" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/instagram_22x21.png" class="Hyperlinked" alt="Instagram" title="Solace Instagram Feed" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                          <li class="list-inline-item">
                            <a href="https://medium.com/solacedotcom" target="_blank" class="social-media-icon">
                              <img src="../../Resources/Images/Social-Media/medium_22x21.png" class="Hyperlinked" alt="Medium" title="Solace Medium Blog" style="width: 22;height: 21;"/>
                            </a>
                          </li>
                        </ul>
                      </div>
                      <div class="footer_link_menu">
                        <ul class="link_list">
                          <li class="link_list_item">
                            <a href="https://solace.com/products/" target="_blank" class="footer-link">Products</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/company/" target="_blank" class="footer-link">Company</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://www.solace.dev/" target="_blank" class="footer-link">Developers</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/support/" target="_blank" class="footer-link">Support</a>
                          </li>
                          <li class="link_list_item">
                            <a href="https://solace.com/contact/" target="_blank" class="footer-link">Contact Us</a>
                          </li>
                        </ul>
                      </div>
                    </footer>
                  </div>
                  <!-- JIRA issue collector -->
                  <script>/*<![CDATA[*/// Requires jQuery!
jQuery.ajax({
    url: "https://sol-jira.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e-T/o2joag/b/24/e73395c53c3b10fde2303f4bf74ffbf6/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-US&collectorId=076e0808",
    type: "get",
    cache: true,
    dataType: "script"
});
window.ATL_JQ_PAGE_PROPS = {
"triggerFunction": function(showCollectorDialog) {
//Requires that jQuery is available!
$("#docsFeedbackTrigger").click(function(e) {
e.preventDefault();
showCollectorDialog();
});
},
fieldValues: {
recordWebInfo: '1', // field Name
recordWebInfoConsent: ['1'] // field Id
}
};
/*]]>*/</script>
                  <script src="../../Resources/Scripts/thumbnail.js">
                                    </script>
                  <!-- Script for Launching offsite links in new tab -->
                  <script type="text/javascript">/*<![CDATA[*/$("a[href^='http']").attr("target","_blank");/*]]>*/</script>
                </div>
              </div>
            </div>
          </div>
          <a data-close="true"/>
        </div>
      </div>
    </div>
  </body>
</html>
